{
    "Slug": "advancing-global-network-reliability-through-intelligent-software-part-1-of-2",
    "Title": "インテリジェント ソフトウェアによるグローバル ネットワークの信頼性の向上(パート 1/2)",
    "Summary": "In our two-part series on advancing global network reliability through intelligent software, we explain how we’ve approached our network design, and how we’re constantly working to improve both reliability and performance.",
    "Content": "<p style=\"margin-left: 40px;\"><em>&ldquo;Microsofts&rsquo; グローバル ネットワークは、60 以上の Azure リージョン、220 を超える Azure データ センター、170 以上のエッジ サイトに接続し、地球全体に 165,000 マイル以上の陸生および海底ファイバーを備えています。グローバル ネットワークは、世界中の戦略的に配置されたエッジ ポイント (POP) でピアリングを介してインターネットの残りの部分に接続します。毎日、世界中の何百万人ものユーザーがMicrosoft Azure、Office 365、Dynamics 365、Xbox、Bing、その他多くの Microsoft クラウド サービスにアクセスしています。これは、1 日あたり数兆件の要求と、グローバル ネットワーク上で毎秒転送される数テラバイトのデータに変換されます。このグローバルネットワークの信頼性が重要なのは言うまでもありません。そのため、Ive&rsquo;はプリンシパルプログラムマネージャー<strong>のマヘシュ・ナヤク</strong>とプリンシパルソフトウェアエンジニア<strong>のウメッシュ・クリシュナスワミー</strong>に、この2部構成の投稿<a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">を『進む信頼性』シリーズ</a>に投稿するよう依頼しました。Weve がネットワーク設計にどのように&rsquo;アプローチしたか、および信頼性とパフォーマンスの両方を向上させるために常に取り組んでいる方法&rsquo;について説明します。&rdquo;&mdash;</em>Mark Russinovich、CTO、Azure</p>\n\n<hr>\n<p><em><a href=\"https://azure.microsoft.com/en-us/blog/advancing-global-network-reliability-through-intelligent-software-part-2-of-2/\">インテリジェントなソフトウェアを通じてグローバルネットワークの信頼性を向上させるパート2</a>を読む。</em></p>\n\n<p>Microsofts&rsquo; のグローバル ネットワークは、高速道路システムに似ています。 高速道路は主要都市を結び、道路は小さな都市と大都市を結びます。 この例では、Azure リージョンにグループ化されたデータ センターが主要都市であり、エッジ POP が小さな都市です。 データセンター、エッジ、およびグローバル ネットワーク全体のネットワーク資産は、すべて 1 つのプールで共有されます。 すべての車両が使用できる複数の車線を持つ一般的な高速道路と考えてください。 これにより、リソースを共有し、変更に適応し、すべての顧客に利益をもたらす機能を開発できます。 インターネット サービス プロバイダー、クラウド プロバイダー、コンテンツ配信ネットワークは、グローバルネットワークとローカルネットワークが似ている&mdash;ため、エッジ POP のネットワークとリンクしています。 データ センター間を移動するトラフィックと、1 つのデータ センターとエッジ間のトラフィックはすべて、Microsofts&rsquo; の高速道路システム上にとどまります。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/30da6c42-c33b-4ebb-9289-c4c35876aef9.png\"><img alt=\"Azure Global Network map.\" border=\"0\" height=\"525\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5f1b2ac0-1d6e-4331-86e4-748ec2a7a13f.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Azure グローバル ネットワーク マップ。\" width=\"1024\"></a></p>\n\n<p>ネットワークシステムの信頼性は当社にとって最優先事項であり、システムの改善を継続的に行っています。 ハイパースケールでのネットワーク インシデントは避けられませんが、これらの機会を利用してさまざまな要因から学習し、可用性設計の原則を再考して、サービスの信頼性をさらに高めます。 2020 年 10 月初旬、一部のルートで短時間ネットワークの輻輳を引き起こしたまれなサービス インシデントが発生し、他の Microsoft クラウド サービスに影響を与えました。 この特定の問題から大きな学びがあり、これらの学習をソフトウェアとプロセス&mdash;に組み込み、以下で呼び出しました。</p>\n\n<h2>主要な設計原則</h2>\n\n<p>高速かつ信頼性の高い輸送を乗客に提供する高速道路システムと同様に、当社は以下のガイドラインを使用して最大の信頼性とパフォーマンスを提供するようにグローバルネットワークを設計しました。</p>\n\n<ul>\n    <li><strong>冗長トポロジを備えた適切にプロビジョニングされたネットワーク:</strong> 複数の同時障害を処理し、単一障害点を排除するために、冗長性を備えたハードウェアとソフトウェアの障害ドメインを設計します。 需要が高い時期や危機時にサービス レベルの目標を満たすのに十分な容量を備えたネットワークを設計します。</li>\n    <li><strong>リスクの変更の解除:</strong> 変更は大規模なネットワークで一定です。 ただし、小さな変更は、予期しない大きな反風を招く可能性があります。 安全なデプロイプラクティスに従って、ブラスト半径を減らし、自動ロールバックを行い、デプロイフェーズ間に十分なベイク時間を確保し、手動によるタッチを排除します。</li>\n    <li><strong>ネットワークの管理、監視、運用を行うインテリジェントなソフトウェア システム:</strong> 物理インフラストラクチャでは、ファイバーカット、ハードウェア障害、需要急増、破壊的気象イベント、破壊活動などのリスクが常に発生しやすくなります。 トポロジ、需要、トラフィック ルーティング、障害、パフォーマンスのリアルタイム ビューを維持し、ネットワーク イベントから自動的に復旧するソフトウェア システムを構築します。</li>\n    <li><strong>近接：</strong> お客様のトラフィックは、ネットワーク パフォーマンスを制御できるように、その体験の大部分に対してグローバル ネットワーク上でフローする必要があります。 すべてのリージョン間トラフィックは、ネットワーク内に完全に留まります。</li>\n    <li><strong>フィードバック ループと AI を使用した改善:</strong> 継続的な学習は、信頼性のミッションに不可欠です。 すべてのインシデントを徹底的に分析して、根本原因と要因を特定します。何が間違っていたかを理解することは重要な学習機会です。 テレメトリ データと共に自己学習を使用して、より迅速なトリアージ、より詳細な分析、および人間のオペレーターの関与を行います。</li>\n</ul>\n\n<h2>リスクの高い変更</h2>\n\n<p>サービスの更新と改善を展開し、脆弱性やインシデントに迅速に対応する必要がある場合、変更は避けられず、有益です。 変更は、統合環境、カナリアリージョン、および一括ロールアウトにまで構築することで徐々にロールアウトされます。変更プロセスは、ゼロ タッチ操作システムを通じて宣言型です。 検証サイクルでは、グローバル ネットワークの完全なエミュレーションに Open Network Emulatorが使用され、リアルタイム操作チェッカーによって、ネットワークに対する各変更のリスクが検証されます。</p>\n\n<h2>Open Network Emulator (ONE)&mdash; ネットワークのソフトウェア エミュレーション</h2>\n\n<p>宇宙飛行士が宇宙ミッションの準備をするとき、彼らはそれぞれの動きを練習し、忠実度の高いエミュレーターですべての手順をテストします。 同様に、ネットワークに変更を加えた場合は、高忠実度のネットワーク エミュレーターで検証します。 グローバル ネットワーク全体は、One Network Emulator (ONE) と呼ばれるソフトウェア エミュレーション環境でインスタンス化できます。 ネットワーク デバイスは、Azure のコンテナーと仮想マシンで実行されているソフトウェアのイメージでエミュレートされます。 1 つのホストで複数のネットワーク デバイスがエミュレートされるため、大規模なテストのためにネットワーク全体をインスタンス化できます。 ネットワーク リンクは、仮想拡張可能 LAN (VXLAN) トンネルでエミュレートされます。 ネットワーク トポロジとデバイス構成は、実稼働構成システムからダウンロードされます。 ソフトウェア コントローラーは ONE と対話します。エミュレートされたデバイスとやり取りすることは気づかないです。 ONE を使用すると、運用環境に入る前に大規模なテストを行うことができます。 すべてのチームには、継続的インテグレーションのための独立した ONE 環境があります。 また、ONE は実際のデバイスと相互運用でき、実際のハードウェアのテストに使用できます。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/daf3df45-6fdf-4dca-b741-d5a6c0f7779a.png\"><img alt=\"Azure Global Network emulator.\" border=\"0\" height=\"437\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/546a3434-ce05-4117-8a79-a21e144686c7.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Azure グローバル ネットワーク エミュレーター。\" width=\"1024\"></a></p>\n\n<p>&nbsp;</p>\n\n<p>ネットワーク デバイス ソフトウェアのアップグレード、パッチの展開、新しい構成の変更、または新しいコントローラー ソフトウェアの展開をチームが望むImagine。 変更を実行し、変更をロールバックする手順のメソッド全体が ONE でテストされます。 ONE では、構成、デバイス ソフトウェア、デバイス間の操作性、スケーリングの問題に関するバグが発生しました。 ONE での検証は、安全なデプロイ フレームワークに統合されています。</p>\n\n<p>概要で説明した最近のサービス インシデント (<a href=\"https://status.azure.com/en-us/status/history\" target=\"_blank\">Microsoft と Azure サービスへのアクセスに関する 10/7 の問題</a>) を参照すると、このインシデントは、Azure リージョン間のネットワーク トラフィック ルーティングを制御するコンポーネントのバージョン更新におけるコードの欠陥によって引き起こされましたが、運用環境の規模とスコープでのみ発生しました。 このようなまれな問題をキャッチするために、実稼働前の検証プロセスを使用して、カオス テストを実行して仮想化環境で同様の問題が頻繁に発生するように強制します。 カオス テストでは、ランダムな障害のバーストが発生して、ネットワークが正常な状態に回復するかどうかを確認します。 このインシデント以降、トラフィック エンジニアリング コントローラーの回復性を向上させるために、テスト カバレッジとベイク時間を ONE で増やしました。</p>\n\n<h2>リアルタイム操作チェッカー (ROC)&mdash; ネットワーク シミュレーター</h2>\n\n<p>リアルタイム操作チェッカー (ROC) は、計画された変更または計画外のダウンタイムがリアルタイム ネットワークに及ぼす影響を検証します。 たとえば、ROC は、次の 2 時間はノードまたはリンクをオフラインにしても安全かどうかという質問 &ldquo;に答えます。&rdquo; 答えは、ネットワークの現在の状態、続行が許可されているその他の変更、次の 2 時間のネットワーク需要、および分離または輻輳を引き起こす新しい障害のリスクによって異なります。 ONE がエミュレートしている間、ROC はシミュレートします。</p>\n\n<p>ROC は、ライブ トポロジと需要フィードを使用し、デバイスの転送とキューイング、および障害および負荷シナリオでのソフトウェア コントローラーの動作をシミュレートします。 これらのシミュレーションは、Azure Batchを使用して並列化され、結果は数分で使用できます。 ROC トークンは、人間が開始した変更とサービスによって開始された変更に対して付与され、ROC トークンなしでネットワーク変更を続行することはできません。 また、当社のファイバープロバイダーパートナーによるメンテナンスは、リスクを測定し、日々の運用で是正措置を講じるためにROCでシミュレートされています。</p>\n\n<h2>ゼロタッチ操作</h2>\n\n<p>サイズのネットワークを操作する場合は、手動で構成を変更しないようにする必要があります。 ネットワークが大きすぎて、人間がすべての正常性信号を監視して反応し、構成の変更が意図した結果を得たかどうかを判断するには大きすぎます。 自動変更はソフトウェア システムによってネットワークに配信され、変更前後の安全性と正常性を分析するための事前チェックと事後チェックにラップされます。 変更はすぐにロールバックされるか、正常性シグナルが失敗した場合はブロックされます。</p>\n\n<p>自動変更は、Fuse、Clockwerk、WARP という名前の 3 つのサービス&mdash;を使用して適用されます。 Fuse&#39;の強みは、ネットワーク デバイス ソフトウェアのアップグレードなどの繰り返し可能なタスクを実行することです。 より安全であることに加えて、Fuseはより速く、エンジニアを解放します。 Clockwerk と WARP は、人間中心またはアドホックの変更に特化しています。 エンジニアはステートフル ワークフローを記述して、自動チェックとロールバックにラップされた一連の変更を実行します。 ユーザーは最新の Web インターフェイスを介してワークフローと対話し、ワークフロー内で人間の入力を提供します。 このようなワークフローの例として、技術者がハードウェアを交換する前にデバイスからトラフィックをドレインする必要があるネットワーク デバイス内のハードウェアを交換し、安全な方法でデバイスに戻すトラフィックが挙げられます。 対話型修復操作に変更が必要な場合、エンジニアは仮想コンソールにコマンドを入力します。このコマンドは、デバイスに送信する前に再びピア レビューされ、安全チェック内にラップされます。 これらのシステムはすべて連携して、手動変更を行う必要がなくなります。</p>\n\n<p>すべての自動化された変更は、ROC フレームワークだけでなく、無数のカナリア、モニター、およびその他の正常性シグナルを利用して変更を絶えず分析し、影響のわずかなヒントでロールバックを行うお客様&mdash;に悪影響を与えることなく意図が提供されたことを確認します。</p>\n\n<h2>キャパシティ プランニング</h2>\n\n<p>容量の予測とデプロイ速度は、最大の信頼性とパフォーマンスを提供するために不可欠です。 高速道路システムの例では、容量計画は、レーンまたは新しい高速道路を追加する場所、追加する数、トラフィックの準備が整うタイミング、閉じる場所を決定することです。</p>\n\n<p>容量計画プロセスは、まずネットワークのトポロジを設定することから始まります。 トポロジ分析システムは、ネットワークと外部ソースからの可用性メトリック、新しい Azure リージョンのビルドアウト、および外部待機時間の測定値を使用して、将来のトポロジを生成します。 需要予測プラットフォームは、異なるアルゴリズムを使用して複数の月のトラフィック マトリックスを生成し、実績に対してスコアを付け、ブレンドされた予測を作成します。 拡張サポート用に最適化された反復可能コンパイラ (ORCAS) は、将来の需要とトポロジに対して大規模なネットワーク シミュレーションを実行します。 ORCAS は、信頼性、使用率、効率性をプログラムで評価し、120,000 を超えるバックボーン ルートと 6,000 個の <a href=\"https://en.wikipedia.org/wiki/Shared_Risk_Resource_Group\" target=\"_blank\">共有リスク リンク グループ</a> (SRLG) でネットワークを進化させる方法を提案します。</p>\n\n<p>複数の障害が発生したエンティティを含む何千もの障害シナリオが、トラフィック管理コントローラーの反応と共にシミュレートされ、最悪の場合の障害に必要な容量が決定されます。 平均故障間 (MTBF) や平均修復時間 (MTTR) などの履歴パフォーマンス データは、短期と長期の両方で容量要件を最適化するために使用されます。 このシグナルは、タイムリーに容量の配信を完了するために、容量ワークフロー自動化エンジンに送られます。 このエンドツーエンドシステムは <a href=\"https://azure.microsoft.com/en-us/blog/azure-responds-to-covid19/\" target=\"_blank\">、COVID-19からの需要急増</a> に対応するために広く使用され、2か月以内に110 Tbpsの追加バックボーン容量を提供しました。</p>\n\n<p>光ファイバパスの多様性は、信頼性の高い容量を確保するために非常に重要です。 ファイバーパスは道路を支える舗装のようなものです。浸水した舗装は、それを使用するすべての道路に影響を与えます。 ファイバー パスに関する地理空間情報と、ファイバークロスポイント、電力、および導管に関するその他のメタデータは、共有リスクを計算するために使用されます。 私たちは、このデータのカバレッジを積極的に追跡し、繊維パートナーと協力して新鮮さを維持します。</p>\n\n<h2>まとめ</h2>\n\n<p>信頼性の高いネットワーク接続は、シームレスで常時オンのクラウド サービス エクスペリエンスに不可欠です。 当社は、急速な成長と絶えず進化するクラウド需要の性質をサポートする柔軟性と制御を提供する、ソフトウェア駆動型のクラウドスケールネットワークを構築しました。</p>\n\n<p>パート 2 では、&rsquo;ソフトウェアで管理されたトラフィック管理、最後のマイルの回復性の最適化、ルート異常検出の検出と修復、帯域幅ブローカーのサービス品質 (QoS)、継続的な監視について詳しく説明します。</p>\n\n<p><em><a href=\"https://azure.microsoft.com/en-us/blog/advancing-global-network-reliability-through-intelligent-software-part-2-of-2/\">インテリジェントなソフトウェアを通じてグローバルネットワークの信頼性を向上させるパート2</a>を読む。</em></p>\n"
}