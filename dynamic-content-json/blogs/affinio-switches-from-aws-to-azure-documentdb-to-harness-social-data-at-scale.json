{
    "Slug": "affinio-switches-from-aws-to-azure-documentdb-to-harness-social-data-at-scale",
    "Title": "Azure DocumentDB は、最新のマーケティング インテリジェンス プラットフォームを活用します",
    "Summary": "Affinio is an advanced marketing intelligence platform that enables brands to deeply understand their users in a deeper level. Affinio’s business model centers on extracting marketing insights for its clients—from billions of points of social media data to more narrowly focused marketing efforts. In order to store and process billions of social network connections without the overhead of database management, data partitioning, and data indexing, they chose Azure DocumentDB. You can read more about Affinio’s usage of DocumentDB in this new case study.",
    "Content": "<p><a href=\"https://affinio.com/\">Affinio</a> は、ブランドがより深く、より豊かなレベルでユーザーを理解することを可能にする高度なマーケティングインテリジェンスプラットフォームです。 Affinios&rsquo; 学習エンジンは、数十億ポイントのソーシャル メディア データをマイニングから顧客のマーケティング分析情報を抽出します。 データベース管理、パーティション分割、インデックス作成のオーバーヘッドなしで数十億のソーシャル ネットワーク接続を格納および処理するために、Affinio エンジニアリング チームは Azure DocumentDB を選択しました。</p>\n\n<p>Affinios&rsquo; 体験の詳細については、 <a href=\"https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=29764\">この新しく公開されたケース スタディ</a>を参照してください。&nbsp; このブログの投稿では、ケース スタディの抜粋を提供し、ソーシャル ネットワーク データを格納および処理するための効果的なパターンについて説明します。</p>\n\n<p>&nbsp;</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/42321ba4-42ef-4bc5-bf8d-224bce3af16a.png\"><img alt=\"image\" border=\"0\" height=\"311\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a715a1af-51ae-48e8-8e56-c480dba7edaa.png\" style=\"border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px\" title=\"イメージ\" width=\"793\"></a></p>\n\n<h2><strong>NoSQL データベースがソーシャル データに適している理由</strong></h2>\n\n<p>Affinios&rsquo;マーケティングプラットフォームは、Twitterや他の大規模なソーシャルネットワーク&nbsp;などのソーシャルネットワークプラットフォームからデータを抽出して、その学習エンジンにフィードし、ユーザーとその興味に関する洞察を学びます。&nbsp;最大の&nbsp;datasetconsistedofapproximatelyone&nbsp;&nbsp;&nbsp;&nbsp; 10億のソーシャルメディアプロファイルは、毎月1000万で成長しています。&nbsp;また、Affinio では、Twitter ツイート (ステータス メッセージ)、<a href=\"https://azure.microsoft.com/documentation/articles/documentdb-geospatial/\">位置情報データ</a>、機械学習の結果を含む他&nbsp;のフィードを格納して処理する必要があります。どのトピックがどのユーザーに関心を持つ可能性が高い場合もあります。</p>\n\n<p>NoSQL データベース&nbsp;は、 <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-nosql-vs-sql/\">さまざまな理由でこれらのデータ フィード</a>&nbsp;に対して自然に選択されます。</p>\n\n<ul>\n <li>一般的なソーシャル ネットワーク&nbsp;の API は、JSON 形式でデータを&nbsp;生成します。</li>\n <li>DB&nbsp; 内の datavolumeis&nbsp;&nbsp;、および頻繁に更新する必要があります (ボリュームと頻度&nbsp;の両方が時間の経過と共に迅速に&nbsp;増加します)。</li>\n <li>複数のソーシャル メディア プロデューサーからのデータはダウンストリームで処理され、各ソーシャル メディア チャネルには独立して進化する独自のスキーマがあります。</li>\n <li>また、重要なのは、小規模な開発チームが新機能を迅速に反復処理できるようにする必要があります。つまり、データベースのセットアップ、管理、スケーリングが簡単である必要があります。</li>\n</ul>\n\n<h2><strong>Aws DynamoDB と Elasticsearch を介して DocumentDB を Affiniouse&nbsp; する理由</strong></h2>\n\n<p style=\"text-align:justify\">Affinio エンジニアリング チームは当初、AWS EC2 仮想マシン上の Elasticsearch の上にストレージ ソリューションを構築しました。 Elasticsearch はスケーラブルな JSON ストレージの必要性に対処しましたが、独自の Elasticsearch サーバーを設定して管理すると、開発チームから貴重な時間が奪われたことに気付きました。 その後、完全に管理された Amazons&rsquo; DynamoDB サービスを評価しましたが、Affinio に必要なクエリ機能はありませんでした。</p>\n\n<p style=\"text-align:justify\">その後、Affinio は DocumentDB、Microsofts&rsquo; の惑星規模の NoSQL データベース サービスMicrosoft Azure試みました。 DocumentDBis&nbsp; は、 <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-indexing\">JSON ドキュメントの自動インデックス作成</a>、スループットとストレージのエラスティック スケーリング、および機能とパフォーマンスに関するすべての要件を満たす <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-sql-query/\">豊富なクエリ機能</a> を備えた、フル マネージドの NoSQL データベースです。 その結果、Affinio は AWS からスタック全体をMicrosoft Azureに移行することにしました。</p>\n\n<p><em>&ldquo;DocumentDB に移行する前に、開発者は、Elasticsearch デプロイでデータがサポートされることを確認するか、処理するためにスケーリングする必要があるかどうかを確認する必要があります。DocumentDBはボトルネックとして私を取り除き、私と彼らにとって素晴らしいことです。&rdquo; </em></p>\n\n<p><em>-Stephen Hankinson、CTO、Affinio</em></p>\n\n<h2><strong>DocumentDB &ndash; での Twitter データのモデリングの例</strong></h2>\n\n<p>たとえば、Affinio が DocumentDB の Twitter ステータス メッセージからデータを格納した方法を見てみましょう。 たとえば、JSON 状態メッセージの例を示&rsquo;します (可視性のために切り捨てられます)。&nbsp;</p>\n\n<pre class=\"prettyprint\">\n{  \n   &quot;created_at&quot;:&quot;Fri Sep 02 06:43:15 +0000 2016&quot;,\n   &quot;id&quot;:771599352141721600,\n   &quot;id_str&quot;:&quot;771599352141721600&quot;,\n   &quot;text&quot;:&quot;RT @DocumentDB: Fresh SDK! #DocumentDB #dotnet SDK v1.9.4 just released!&quot;,\n   &quot;user&quot;:{  \n      &quot;id&quot;:2557284469,\n      &quot;id_str&quot;:&quot;2557284469&quot;,\n      &quot;name&quot;:&quot;Azure DocumentDB&quot;,\n      &quot;screen_name&quot;:&quot;DocumentDB&quot;,\n      &quot;location&quot;:&quot;&quot;,\n      &quot;description&quot;:&quot;A blazing fast, planet scale NoSQL service delivered by Microsoft.&quot;,\n      &quot;url&quot;:&quot;https://t.co/30Tvk3gdN0&quot;\n   }\n}</pre>\n\n<p>このデータを DocumentDB に格納するのは簡単です。 DocumentDB は、スキーマレスの NoSQL データベースとして、スキーマまたはインデックス定義を必要とせずに <a href=\"https://dev.twitter.com/rest/public\">、Twitter API</a> から JSON データを直接使用します。 開発者として、DocumentDB にこのデータを格納する際の主な考慮事項は、パーティション キーの選択と、一意のクエリ パターン (この場合はテキスト メッセージでの検索) に対処することです。 &#39;、Affinio がこれら 2 つにどのように対処するかを見ていきます。</p>\n\n<p><strong>適切なパーティション キーを選択する:</strong>&nbsp; DocumentDB パーティション分割コレクションでは、JSON ドキュメント内のプロパティをパーティション キーとして指定する必要があります。 このパーティション キー値を使用すると、DocumentDB は複数の物理サーバーにデータと要求を自動的に分散します。 適切なパーティション キーには多数の異なる値があり、DocumentDB は複数のパーティションにデータと要求を分散できます。 Twitter ステータス メッセージなどのソーシャル データに適したパーティション キーの候補をいくつか見てみましょう&rsquo;。</p>\n\n<ul>\n <li>&quot;&quot; &ndash; created_atには多数の個別の値があり、特定の時間範囲のデータにアクセスする場合に便利です。 ただし、作成された時刻に基づいて新しいステータス メッセージが挿入されるため、現在の時刻のような特定の時間値のホット スポットが発生する可能性があります</li>\n <li>&quot;id&quot; &ndash; このプロパティは、Twitter ステータス メッセージの ID に対応します。 多数の一意のユーザーが存在し、任意の数のパーティション/サーバーに均等に分散できるため、パーティション キーの候補として適しています。</li>\n <li>&quot;このプロパティ user.id&quot; &ndash; Twitter ユーザーの ID に対応します。 これは最終的にパーティション キーに最適な選択肢でした。これは、書き込みを分散できるだけでなく、特定のユーザー&rsquo;の状態メッセージの読み取りを 1 つのパーティションからのクエリを介して効率的に処理できるためです。</li>\n</ul>\n\n<p>パーティション キーとして user.id&quot; を使用して&quot;、Affinio は 1 <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-request-units/\">秒あたり</a> 200,000 要求ユニット (インジェストと学習エンジンによるクエリの両方) でプロビジョニングされた 1 つの <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-partition-data\">DocumentDB パーティション コレクション</a>を作成しました。</p>\n\n<p><strong>テキスト メッセージ内での検索: </strong>Affinio はステータス メッセージ内の単語を検索できる必要があり、ランク付けなどの高度なテキスト分析を実行する必要はありませんでした&rsquo;。 Affinio は、用語を検索する必要がある場合に、関連するフィールドで Lucene トークナイザーを実行し、DocumentDB の JSON ドキュメント内に用語を配列として格納します。 たとえば、テキストは、&quot;ステータス メッセージ内のトークン/単語を&quot;含むtext_terms&quot;配列としてトークン化&quot;できます。 この&rsquo;例を次に示します。</p>\n\n<pre class=\"prettyprint\">\n{  \n   &quot;text&quot;:&quot;RT @DocumentDB: Fresh SDK! #DocumentDB #dotnet SDK v1.9.4 just released!&quot;,\n   &quot;text_terms&quot;:[  \n      &quot;rt&quot;,\n      &quot;documentdb&quot;,\n      &quot;dotnet&quot;,\n      &quot;sdk&quot;,\n      &quot;v1.9.4&quot;,\n      &quot;just&quot;,\n      &quot;released&quot;\n   ]\n}</pre>\n\n<p>DocumentDB では、配列や入れ子になったプロパティを含む <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-indexing/\">JSON 内のすべてのパスのインデックスが自動的に</a>作成されるため、documentdb&rdquo; や &ldquo;dotnet&rdquo; などの&ldquo;特定の単語を含むステータス メッセージを照会し、インデックスからこれらのパスを処理できるようになりました。 たとえば、これは次のように<a href=\"https://azure.microsoft.com/documentation/articles/documentdb-sql-query/#built-in-functions\">SQLで表されます</a>。</p>\n\n<pre class=\"prettyprint\">\nSELECT * FROM status_messages s WHERE ARRAY_CONTAINS(s.text_terms, &quot;documentdb&quot;)\n</pre>\n\n<h2><strong>次の手順 </strong></h2>\n\n<p>このブログの投稿では、Affinio が市場インテリジェンス プラットフォームに Azure DocumentDB を選択した理由と、大量のソーシャル データを DocumentDB に格納するための効果的なパターンについて説明しました。</p>\n\n<ul>\n <li><a href=\"https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=29764\">Affinio のケース スタディ</a>を参照して、Affinio が DocumentDB を利用して数テラバイトのソーシャル ネットワーク データを処理する方法と、Amazon DynamoDB と Elasticsearch よりも DocumentDB を選択した理由について学習します。</li>\n <li>Affinio の詳細については <a href=\"https://www.affinio.com/\">、Web サイトをご覧ください</a>。</li>\n <li>最新のマーケティング、広告テクノロジ、リアルタイム分析アプリケーションの要求を処理する NoSQL データベースを探している場合&rsquo;は、 <a href=\"https://azure.microsoft.com/pricing/free-trial/\" ms.cmpgrp=\"body\" ms.cmpnm=\"DocumentDB using your free trial\" ms.cmptyp=\"link\" ms.interactiontype=\"1\" ms.pgarea=\"content\" ms.title=\"\" target=\"_blank\"><u>無料試用版を使用して DocumentDB</u></a> を試すか、 <a href=\"https://azure.microsoft.com/documentation/articles/documentdb-community/#contact-the-team\" ms.cmpgrp=\"body\" ms.cmpnm=\"1:1 chat with the DocumentDB engineering team\" ms.cmptyp=\"link\" ms.interactiontype=\"1\" ms.pgarea=\"content\" ms.title=\"\" target=\"_blank\"><u>DocumentDB エンジニアリング チームと 1 対 1 のチャットを</u></a>スケジュールします。&nbsp;&nbsp;</li>\n <li>Twitter <a href=\"https://twitter.com/DocumentDB\"><u>@DocumentDB</u></a>でフォローすることで、DocumentDB の最新のニュースや機能を最新の状態に保つことができます。</li>\n</ul>\n"
}