{
    "Slug": "advancing-noimpact-and-lowimpact-maintenance-technologies",
    "Title": "影響のない、影響の少ないメンテナンス テクノロジの推進",
    "Summary": "This post continues our reliability series kicked off by my July blog post highlighting several initiatives underway to keep improving platform availability, as part of our commitment to provide a trusted set of cloud services.",
    "Content": "<p>&ldquo;この投稿は、信頼できる一連のクラウド サービスを提供するというコミットメントの一環として、プラットフォームの可用性を向上させ続けるために進行中のいくつかの取り組みを取り上げ、<a href=\"https://azure.microsoft.com/en-us/blog/advancing-microsoft-azure-reliability/\" target=\"_blank\">7 月のブログ投稿</a>で開始された<a href=\"https://azure.microsoft.com/en-us/blog/tag/advancing-reliability/\" target=\"_blank\">信頼性シリーズ</a>を続けています。 今日は、ホットパッチ適用、メモリ保持メンテナンス、ライブマイグレーションなど、影響のない低影響の更新テクノロジで行われた投資&rsquo;をダブルクリックしたいと思いました。 Weve&rsquo; は、過去 1 年間にインフラストラクチャをホストするために多数のセキュリティと信頼性のパッチをデプロイしました。その多くは、顧客への影響やダウンタイムなしで実装されました。 次の投稿は、以下で説明するいくつかの更新テクノロジのプログラム マネージャーである、Microsoft のコア オペレーティング システム チームの John Slack によって作成されました。&rdquo; - Mark Russinovich、CTO、Azure</p>\n\n<hr>\n<p><em>この投稿は、これらのテクノロジを担当するエンジニアリング チームの Apurva Thanky、クリスティナ デル アモ カサド、シャンタヌ Srivastava によって共同で作成されました。</em></p>\n\n<p>&nbsp;</p>\n\n<p>プラットフォームの信頼性、パフォーマンス、セキュリティを向上させるために、Azure ホスト インフラストラクチャを定期的に更新しています。 これらの &lsquo;メンテナンス&rsquo; 更新プログラムの目的はさまざまですが、通常は、ホスティング環境でのソフトウェア コンポーネントの更新やハードウェアの使用停止が含まれます。 5 年前に戻った場合、これらの更新プログラムの一部を適用する唯一の方法は、ホスト全体を完全に再起動することでした。 このアプローチでは、顧客の仮想マシン (VM) が一度に数分ダウンしました。 それ以来、当社は、フリートを更新する際の顧客の影響を最小限に抑えるために、さまざまなテクノロジに投資してきました。 現在、ホスト オペレーティング システムの更新プログラムの大部分は、ホット パッチ適用を使用して、絶対的な透明性と顧客への影響をゼロにしてデプロイされています。 更新プログラムをホット パッチ適用できない場合は、通常、影響の少ないメモリ保持更新テクノロジを使用して更新プログラムをロールアウトします。</p>\n\n<p>これらのテクノロジでも、より影響の大きいメンテナンス (障害のあるハードウェアの避難や古いハードウェアの使用停止など) を行う必要がある他のまれなケースがまだあります。 このような場合は、ライブ マイグレーション、VM 内通知、計画メンテナンスの組み合わせを使用して、お客様の制御を提供します。</p>\n\n<p>この領域への継続的な投資のおかげで、ホスト メンテナンス アクティビティの大部分が影響を受けるインフラストラクチャでホストされている VM に影響を与えない場所にあります。 この&rsquo;投稿は、Azure の更新プログラムが最小限の影響を受けないようにするために使用するさまざまな手法について透過的に記述します。</p>\n\n<h2>プラン A: ホット パッチ適用</h2>\n\n<p>関数レベル &ldquo;のホット&rdquo; パッチ適用では、お客様の VM のダウンタイムを発生させずに、実行中のコードに対してターゲットを変更できます。 これは、ホスト上の関数のすべての新しい呼び出しをその関数の更新バージョンにリダイレクトすることで行われます。そのため、更新テクノロジには影響&rsquo;がないと見な&lsquo;されます。 可能な限り、ホット パッチ適用を使用してホスト更新プログラムを適用し、そのホストで実行されている VM への影響を完全に回避します。 2017 年から Azure でホット パッチ適用を使用しています。 それ以来、ホットパッチを適用できる範囲を広げるための取り組みも行っています。 たとえば、2018 年にハイパーバイザーにホット パッチを適用できるように、ホスト オペレーティング システムを更新しました。 今後は、ファームウェアのホット パッチを検討しています。 これは、業界が一般的に焦点を当て&#39;していない場所です。 ファームウェアは常にそれを更新し、サーバーを再起動する必要があるかのように見 &lsquo;てきましたが、&rsquo; それは恐ろしいカスタマーエクスペリエンスになります。 私たちは&#39;ハードウェアメーカーと協力して、独自のファームウェアを検討し、ホットパッチを適用して段階的に更新できるようにします。</p>\n\n<p>一部の大規模なホスト更新プログラムには、関数レベルのホット パッチ適用を使用して適用できない変更が含まれています。 これらの更新プログラムでは、メモリ保持メンテナンスの使用に努めています。</p>\n\n<h2>プラン B: メモリ保持メンテナンス</h2>\n\n<p>メモリ保持メンテナンスには &lsquo;、ゲスト VM の一時停止&rsquo; (RAM でのメモリの保持中)、ホスト サーバーの更新、VM の再開、クロックの自動同期が含まれます。 最初に、2018 年に Azure のメモリ保持メンテナンスを使用しました。 それ以来、私たちは3つの重要な方法で技術を改善しました。 まず、ホストの再起動なしで処理できるホスト コンポーネントを対象とした、メモリ保持メンテナンスの影響の少ないバリアントを開発しました。 2 つ目は、カスタマー エクスペリエンスの一時停止期間を短縮したことです。 3 つ目は、メモリ保持メンテナンスで更新できる VM の種類の数を増やしました。 引き続きこの領域で作業を続けますが、メモリ保持メンテナンスの一部のバリエーションは、さまざまな技術的な理由から、M、N、H シリーズの VM などの一部の特殊な VM オファリングと互換性がありません。</p>\n\n<p>まれに、より影響の大きいメンテナンス (ホストの再起動、VM の再デプロイを含む) を行う必要があります。お客様は事前に通知を受け取り、ワークロードに適したタイミングでメンテナンスを実行する機会が与えられます。</p>\n\n<h2>プラン C: セルフサービス メンテナンス</h2>\n\n<p>セルフサービス メンテナンスでは、お客様とパートナーに時間を提供し、その中で VM に対して影響を与えるメンテナンスを開始するタイミングを選択できます。 通常、この初期セルフサービス フェーズは約 1 か月続き、組織は独自のスケジュールでメンテナンスを実行し、ユーザーに中断が発生しないようにすることができます。 このセルフサービス期間の最後に、スケジュールされたメンテナンス フェーズが開始されます&mdash;。ここで、Azure は自動的にメンテナンスを実行します。 どちらのフェーズでも、お客様は、Azure Service Health で、または PowerShell/CLI でクエリを実行することで、どの VM が更新&mdash;されているか、更新されていないかを完全に把握できます。 Azure では、2018 年にセルフサービス メンテナンスが初めて提供されました。 通常、管理者は、Azure が VM のメンテナンスを自動的に実行するのを待つのではなく、セルフサービス フェーズを利用していることがわかります。</p>\n\n<p>これに加えて、お客様が <a href=\"https://azure.microsoft.com/en-us/services/virtual-machines/dedicated-host/\" target=\"_blank\">Azure Dedicated Hosts</a> または <a href=\"https://docs.microsoft.com/en-us/azure/security/fundamentals/isolation-choices#isolated-virtual-machine-sizes\" target=\"_blank\">Isolated 仮想マシン</a>を使用して完全なホスト マシンを所有している場合は、最近、影響のないプラットフォーム更新プログラムすべてに対するメンテナンス制御を提供し始めました。 これには、数秒の一時停止のみを引き起こす再起動なしの更新が含まれます。 これは、数秒間しか続かなくても中断を持続できない&rsquo;、超機密性の高いワークロードを実行する VM に役立ちます。 お客様は、35 日間のローリング ウィンドウで、これらの 0 以外の影響更新プログラムを適用するタイミングを選択できます。 この機能はパブリック プレビュー段階であり、詳細については、この専用 <a href=\"https://azure.microsoft.com/en-us/blog/maintenance-control-for-platform-updates/\" target=\"_blank\">のブログ投稿</a>を参照してください。</p>\n\n<p>ホストがハードウェアの劣化の兆候を示している場合など、インプレース更新テクノロジ&rsquo;が実行できない場合があります。 このような場合、最適なオプションは、計画メンテナンスまたはライブ マイグレーションを通じて、顧客管理を通じて VM を別のホストに移動することです。</p>\n\n<h2>プラン D: ライブ マイグレーション</h2>\n\n<p>ライブ マイグレーションでは、実行中の顧客 VM を 1 つの &ldquo;ソース&rdquo; ホストから別 &ldquo;の移行先ホストに移動します&rdquo; 。 ライブ マイグレーションは、仮想マシンがまだ実行されている間に、VM&rsquo; のローカル状態 (RAM とローカル ストレージを含む) をソースから移行先に移動することから始めます。 ローカル状態の大部分が移動されると、ゲスト VM では通常 5 秒以下の短い一時停止が発生します。 その一時停止後、VM は移行先ホストで実行を再開します。 Azure は、2018 年にライブ マイグレーションのメンテナンスの使用を初めて開始しました。 現在、Azure Machine Learning アルゴリズムでハードウェア障害が迫っていることを予測すると、ライブ マイグレーションを使用してゲスト VM を事前に別のホスト<a href=\"https://azure.microsoft.com/blog/improving-azure-virtual-machine-resiliency-with-predictive-ml-and-live-migration/\" target=\"_blank\">に</a>移動できます。</p>\n\n<p>その他のトピックの中でも、計画メンテナンスと AI 運用については、Igal Figlins&rsquo; の最近の Ignite 2019 セッション &ldquo;「Azure での回復性のあるアプリケーションの構築」で取り上げられました。&rdquo; これらの追加のコンテキストについては、 <a href=\"https://myignite.techcommunity.microsoft.com/sessions/82913?source=sessions\" target=\"_blank\">ここで</a> の記録をご覧ください。また、Azure が提供するさまざまな回復性のあるサービスを利用して、本質的に回復性のあるアプリケーションを構築する方法について詳しく説明します。</p>\n\n<h2>Azure メンテナンスの将来</h2>\n\n<p><embed https:=\"\" myignite.techcommunity.microsoft.com=\"\" sessions=\"\" source=\"sessions\" video=\"\">まとめると、Azure がメンテナンスを実行する方法は、適用される更新プログラムの種類によって大きく異なります。 詳細に関係なく、Azure は常にメンテナンスにアプローチし、お客様のワークロードに対する可能な限り小さい影響を確実にすることを視野に入れます。 この投稿では、これを実現するために使用するいくつかのテクノロジの概要を説明し、カスタマー エクスペリエンスの向上を続けるために熱心に取り組んでいます。 将来に向けて、可用性と信頼性を維持するために、機械学習ベースの分析情報と自動化に多額の投資を行っています。 最終的には、この &ldquo;AI 運用&rdquo; モデルは予防メンテナンスを実行し、自動化された軽減策を開始し、インシデントの間に発生する要因と依存関係を人間のエンジニアよりも効果的に特定します。 私たちは、学習と進化を続ける中で、これらのトピックの詳細を共有することを楽しみにしています。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n"
}