{
    "Slug": "advancing-global-network-reliability-through-intelligent-software-part-2-of-2",
    "Title": "インテリジェント ソフトウェアによるグローバル ネットワークの信頼性の向上(パート 2/2)",
    "Summary": "In our two-part series on advancing global network reliability through intelligent software, we explain how we’ve approached our network design, and how we’re constantly working to improve both reliability and performance.",
    "Content": "<p><i>&ldquo;Microsofts&rsquo; グローバル ネットワークは、60 以上の Azure リージョン、220 を超える Azure データ センター、170 以上のエッジ サイトに接続し、地球全体に 165,000 マイル以上の陸生および海底ファイバーを備えています。グローバル ネットワークは、世界中の戦略的に配置されたエッジ ポイント (POP) でピアリングを介してインターネットの残りの部分に接続します。世界中の何百万人もの人々が毎日、Microsoft Azure、Office 365、Dynamics 365、Xbox、Bing、その他多くの Microsoft クラウド サービスにアクセスしています。これは、1 日あたり数兆件の要求と、グローバル ネットワーク上で毎秒転送される数テラバイトのデータに変換されます。このグローバルネットワークの信頼性が重要なのは言うまでもありません。そのため、Ive&rsquo;はプリンシパルプログラムマネージャー<b>のマヘシュ・ナヤク</b>とプリンシパルソフトウェアエンジニア<b>のウメッシュ</b><b>・クリシュナスワミー</b>に、この2部構成の投稿<a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">を『進む信頼性』シリーズ</a>に投稿するよう依頼しました。Weve がネットワーク設計にどのように&rsquo;アプローチしたか、および信頼性とパフォーマンスの両方を向上させるために常に取り組んでいる方法&rsquo;について説明します。&rdquo;&mdash;</i>Mark Russinovich、CTO、Azure</p>\n\n<hr>\n<p><i><a href=\"https://azure.microsoft.com/en-us/blog/advancing-global-network-reliability-through-intelligent-software-part-1-of-2/\" target=\"_blank\">インテリジェントなソフトウェアパート1を通じてグローバルネットワークの信頼性を向上</a>させる。</i></p>\n\n<p>このネットワーク投稿のパート 1 では、グローバル ネットワークの主要な設計原則を紹介し、変更、ゼロ タッチ操作と変更自動化、容量計画をエミュレートする方法について説明しました。 パート 2 では、トラフィック管理から始めます。 当社のような大規模なネットワークの場合、従来のハードウェアマネージドトラフィックルーティングを使用することは効率的ではありません。 代わりに、グローバル ネットワークでトラフィック エンジニアリングをインテリジェントに管理するためのソフトウェア ベースのソリューションをいくつか開発しました。</p>\n\n<h4>&nbsp;</h4>\n\n<h2>SDN ベースのインターネット トラフィック エンジニアリング (ITE)</h2>\n\n<p>エッジは、ユーザーが Microsofts&rsquo; サービスに接続する方法であるため、グローバル ネットワーク&mdash;の最も動的な部分です。 Microsoft は、顧客/ネットワーク待機時間を改善し、Microsoft クラウド サービスの範囲を拡張するために、エッジ POP をユーザーの近くに戦略的にデプロイしました。</p>\n\n<p>たとえば、シドニーのユーザーがシカゴでホストされている Azure リソースにアクセスした場合、米国のトラフィックはシドニーのエッジ PoP にある Microsoft ネットワークに入り、シカゴでホストされているサービスにネットワーク上を移動します。 シカゴの Azure からのリターン トラフィックは、Microsoft ネットワーク上のシドニーに戻ります。 ユーザーに最も近いポイントにトラフィックを受け入れて配信することで、パフォーマンスをより適切に制御できます。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0d0fe7d2-f92c-4707-b19b-36f9cc81236f.jpg\"><img alt=\"Azure Edge premium routing.\" border=\"0\" height=\"258\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f6a8b6c5-2f2b-4482-a686-128067a19cd5.jpg\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Azure Edge Premium ルーティング。\" width=\"1248\"></a></p>\n\n<p>各エッジ PoP は、数十または数百のピアリング ネットワークに接続されます。 ネットワークとプロバイダー ネットワーク間の&rsquo; ルートは、Border Gateway Protocol (BGP) を使用して交換されます。 BGP ベスト パスの選択には、輻輳の固有の概念はなく、BGP 容量に対応したパフォーマンス&mdash;もありません。 そこで、エッジでトラフィックを誘導する SDN ベースのインターネット トラフィック エンジニアリング (ITE) システムを開発しました。 エントリ ポイントと終了ポイントは、エッジのトラフィック負荷、インターネット パートナー&rsquo; の容量制約、容量の削減または拡張、分散型サービス拒否攻撃によって発生する需要の急増、およびインターネット パートナーの待機時間のパフォーマンスに基づいて動的に変更されます。 ITE コントローラーは常にこれらのシグナルを監視し、Microsoft のインターネット パートナーや Microsoft ネットワーク内でアドバタイズされたルートにアドバタイズするルートを変更して、最適なピア エッジを選択します。</p>\n\n<h2>Azure Peering Service を使用した最後のマイルの回復性の最適化</h2>\n\n<p><a href=\"https://docs.microsoft.com/en-us/azure/peering-service/about\" target=\"_blank\">Azure Peering Service</a> は、グローバル ネットワーク内のルートを最適化するだけでなく、最適化された接続をインターネット サービス プロバイダー (ISP) のネットワークの最後の 1 マイルまで拡張します。 Azure Peering Service は、プロバイダーとのコラボレーション プラットフォームであり、ユーザーから Microsoft ネットワークへの信頼性の高い高パフォーマンスの接続を可能にします。 このパートナーシップにより、ローカルと地域の冗長性とエンド ユーザーとの近接性が確保されます。 ピアリングの各場所は、冗長なさまざまなピアリング リンクを使用してプロビジョニングされます。 また、プロバイダーは複数の Microsoft PoP の場所で相互接続するため、エッジ ノードの 1 つがパフォーマンスを低下させた場合、代替サイト経由で Microsoft との間でトラフィックがルーティングされます。 Map of Internet (MOI) からのインターネット パフォーマンス テレメトリは、最後のマイルのパフォーマンスを最適化するためにトラフィック ステアリングを促進します。</p>\n\n<h2>ルート異常の検出と修復 (RADAR)</h2>\n\n<p>インターネットは BGP で実行されます。 ネットワークまたは自律システムは、その証明に疑問を持たずに、ピアによってアドバタイズされたルートを信頼、受け入れ、伝達する必要があります。 これが BGP の強みであり、インターネットを迅速に更新して障害を修復できるようにします。 しかし、ネットワークが所有するプレフィックスへのパスは&mdash;、誤って、または悪意のある意図によって、リダイレクト、インターセプト、またはブラックホール トラフィックに変更される可能性もあります。 すべての主要なプロバイダーに発生するいくつかのインシデントがあり、一部はフロント ページのニュースを作成します。 グローバル ネットワークを保護するために、グローバル ルート異常検出および修復 (RADAR) システムを開発しました。</p>\n\n<p>RADAR は、インターネット上の Microsoft ルート ハイジャックを検出して軽減します。 BGP ルート リークは、ルーティングアナウンスが目的のスコープを超えて伝達される場合です。 RADAR は、Azure とインターネットのルート リークを検出します。 ルートの安定したバージョンと不安定なバージョンを特定し、新しいお知らせを検証できます。 RADAR と ITE コントローラーを使用して、Microsoft プレフィックスのリアルタイム保護を構築しました。 Peering Service プラットフォームは、過去 1 マイルの間に、ハイジャック、リーク、その他の BGP 構成の誤り (意図したかどうか) に対するルートの監視と保護を顧客の場所まで拡張します。</p>\n\n<h2>ソフトウェア駆動のワイド エリア ネットワーク (SWAN)</h2>\n\n<p>グローバルネットワークのバックボーンは、主要都市を結ぶ高速道路システムに似ています。 スワンコントローラーは、各車両のルートを割り当てるナビゲーションシステムであり、各車両ができるだけ早く目的地に到達し、高速道路に渋滞を引き起こさずに到着します。 このシステムは、トポロジ検出、需要予測、パス計算、最適化、ルート プログラミングで構成されます。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b8a68c48-2ec6-4645-97ca-c867e6812731.png\"><img alt=\"Optimized risk diverse path computation.\" border=\"0\" height=\"312\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5ed23a83-6aa9-4f9b-8af7-1fc0743f8b7b.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"最適化されたリスクの多様なパスの計算。\" width=\"624\"></a></p>\n\n<p>過去 12 か月間、ネットワークをプログラミングするコントローラーの速度が桁違いに向上し、ルート検索機能が 2 倍向上しました。 リンクエラーはレーンクロージャのようなものであるため、コントローラーは輻輳を減らすためにルートを再計算する必要があります。 コントローラーは、プライマリ ルートの障害が発生した場合に備えて、同じ共有リスク リンク グループ (SRLG) を使用してバックアップ ルートを計算します。 バックアップ ルートは障害が発生するとすぐにアクティブになり、コントローラーはトラフィックの配置を再最適化する際に動作します。 連続して上下に移動するリンクは、安定するまでサービスから保留されます。</p>\n\n<p>信頼性の測定の 1 つは、要求されたバイトに正常に送信されたバイトの割合で、1 時間にわたって測定され、その日の平均です。 お客様のワークロードに対して 99.999% 以上です。 Microsoft サービス間のすべての通信は、専用のグローバル ネットワークを通じて行われます。 <a href=\"https://marketo-web.thousandeyes.com/rs/thousandeyes/images/ThousandEyes-Cloud-Performance-Benchmark-2019-2020-Edition.pdf\" target=\"_blank\">Thousand Eyes Cloud Performance Benchmark</a> は、Azure リージョン間待機時間の 99% 以上がパフォーマンス ベースラインよりも速く、リージョン ペアの 60% 以上が少なくとも 10% 高速であると報告しています。 これは、この記事で説明されている容量拡張とソフトウェア システムの結果です。</p>\n\n<h2>帯域幅 Brokersoftware&mdash; 主導のネットワークサービス品質 (QoS)</h2>\n\n<p>グローバル ネットワークが高速道路システムの場合、帯域幅ブローカーは高速道路のオンランプで測定ライトを制御するシステムです。 お客様の車両ごとに、複数の Microsoft 車両が高速道路を横断しています。 Microsoft の一部の車両は随意であり、お客様の車両の混雑を避けるために延期することができます。 お客様の車両は常に高速道路に入るフリーパスを持っています。 測定ライトは通常の動作では緑色ですが、障害や需要の急増が発生した場合、帯域幅ブローカーは制御された方法で測定ライトをオンにします。 Microsoft 内部ワークロードはトラフィック層に分割され、それぞれ優先度が異なります。 優先度の高いワークロードは、優先順位の低いワークロードよりも優先して許可されます。</p>\n\n<p>ブローカーは、送信側ホストで行われます。 ホストは、ホストで実行されているアプリケーションの代わりに帯域幅を定期的に要求します。 要求はコントローラーによって集計され、帯域幅は予約され、許可は各ホストに配布されます。 帯域幅ブローカーと SWAN 座標を使用して、ルートと一致するようにトラフィック ボリュームを調整し、トラフィック ルートをボリュームと一致させます。</p>\n\n<p>ネットワーク容量を突然削減する複数のファイバーカットや障害が発生する可能性があります。 回復性を高めるための geo レプリケーション操作は、ネットワーク トラフィックの急増を引き起こす可能性があります。 帯域幅ブローカーでは、通常、輻輳が迫っていたときに随意の内部ワークロードを流すことで、これらの条件の間にカスタマー エクスペリエンスを維持できます。</p>\n\n<h2>継続的な監視</h2>\n\n<p>堅牢な監視ソリューションは、より高いネットワーク信頼性を実現するための基盤です。 検出時間と修復時間の両方を短縮します。 監視パイプラインでは、トラフィック統計、正常性信号、ログ、デバイス構成など、複数のテレメトリ ストリームが常に分析されます。 パイプラインは、異常が検出されたとき、または一般的なエラーを診断して修復すると、より多くのデータを自動的に収集します。 これらの自動化された介入は、安全チェックシステムによっても保護されます。</p>\n\n<p>監視への主な投資は次のとおりです。</p>\n\n<ul>\n    <li>1 分未満の速度でのメトリック データのポーリングとインジェスト。 トランジェントをフィルター処理するにはいくつかのサンプルが必要であり、強い信号を生成するにはさらにいくつかのサンプルが必要です。 これにより、検出時間が短縮されます。</li>\n    <li>パケット損失または待機時間のアラートによってトリガーされる拡張診断システムは、特定のリンクまたはデバイスへの問題を三角形化して特定するために役立つ追加情報を収集するように、異なる視点のエージェントに指示します。</li>\n    <li>強化された診断は、Clockwerk とリアルタイム操作チェッカー (ROC) を使用して、最も一般的なインシデントの自動軽減と修復アクションをトリガーします。 これにより、修復時間が短縮され、エンジニアがより複雑なインシデントに集中し続ける波及効果があります。</li>\n</ul>\n\n<p>他のパイプラインでは、ノードの分離のためにネットワーク グラフを継続的に監視し、前述のように ROC を使用して what-if&rdquo; 意図で&ldquo;リスクを定期的に評価します。 ネットワーク全体に複数のカナリア エージェントがデプロイされており、リージョン全体の到達可能性、待機時間、パケット損失を確認しています。 これには、Azure 内のエージェントとネットワークの外部のエージェントが含まれます。外部での監視を有効にします。 また、Map of Internet (MOI) テレメトリを定期的に分析して、お客様から Azure へのエンド ツー エンドのパフォーマンスを測定します。 最後に、BGP ルート ハイジャックや分散型サービス拒否 (DDoS) などのセキュリティ攻撃からネットワークを保護するための堅牢な監視が実施されています。</p>\n\n<h2>まとめ</h2>\n\n<p>これらの SDN テクノロジの一部 ( <u><a href=\"https://github.com/Azure/SONiC/wiki\" target=\"_blank\">SONIC</a></u> など) をオープンソース化しています。 SONICとそのハードウェアおよびソフトウェアパートナーの急速に成長するエコシステムは、ネットワークを運用および管理するためのインテリジェントな新しい方法と、ネットワーク自体の迅速な進化を可能にします。 また、<u><a href=\"https://docs.microsoft.com/en-us/azure/expressroute/expressroute-global-reach\" target=\"_blank\">ExpressRoute Global Reach</a>、</u><u><a href=\"https://azure.microsoft.com/en-us/services/virtual-wan/\" target=\"_blank\">Azure Virtual WAN</a>、</u><u><a href=\"https://azure.microsoft.com/en-us/updates/global-vnet-peering-general-availability/\" target=\"_blank\">グローバル VNET ピアリング</a></u>、<u><a href=\"https://docs.microsoft.com/en-us/azure/peering-service/about\" target=\"_blank\">Azure Peering Service</a></u> などのサービスを構築し、Microsoft グローバル ネットワークの上に独自のオーバーレイを構築できるようにします。</p>\n\n<p>私たちは、ソフトウェアとハードウェアのイノベーションを使用して、グローバルネットワークの回復性に継続的に投資し、強化しています。 当社の光ファイバー投資により、大陸内外の回復性、パフォーマンス、信頼性が向上しました。 <a href=\"https://news.microsoft.com/marea/\" target=\"_blank\">MAREA</a>海底ケーブルシステムは、業界&rsquo;初の海底オープンラインシステム(OLS)です。 これは、OLSコンストラクトに従っている後続のすべてのサブマリンケーブルビルドのブループリントとなっています。 これらのシステムをより簡単にアップグレードし、ネットワークのすべての部分で同種のプラットフォームを維持する機能により、Microsoft は需要の増加にシームレスに対応できます。</p>\n\n<p><i><a href=\"https://azure.microsoft.com/en-us/blog/advancing-global-network-reliability-through-intelligent-software-part-1-of-2/\" target=\"_blank\">インテリジェントなソフトウェアパート1を通じてグローバルネットワークの信頼性を向上</a>させる。</i></p>\n"
}