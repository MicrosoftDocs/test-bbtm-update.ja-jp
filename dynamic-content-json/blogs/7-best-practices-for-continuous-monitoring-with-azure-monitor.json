{
    "Slug": "7-best-practices-for-continuous-monitoring-with-azure-monitor",
    "Title": "Azure Monitor を使用した継続的監視の 7 つのベスト プラクティス",
    "Summary": "Whether you are a developer, SRE, IT Ops specialist, PM or a DevOps practitioner, monitoring is something you definitely care about! Azure Monitor is Microsoft’s unified monitoring solution that provides full-stack observability across applications and infrastructure. Learn about some best practices for a successful monitoring strategy on hybrid/public cloud!",
    "Content": "<p>開発者、サイト信頼性エンジニア、IT Ops スペシャリスト、プログラム マネージャー、DevOpsプラクティショナーの監視は、間違いなく気になるものです。 最新のアプリケーションがオンプレミスの世界からハイブリッドまたはマイクロサービス ベースに進化するにつれて、スキル セットを進化させ、ハイブリッド/パブリック クラウドで監視戦略を成功させるためにいくつかのベスト プラクティスを採用する必要もあります。</p>\n\n<p><a href=\"https://azure.microsoft.com/services/monitor/\">Azure Monitor</a> は、アプリケーションとインフラストラクチャ全体でフルスタックの可観測性を提供する Microsoft の&rsquo;統合監視ソリューションです。 現時点で身に着けている帽子に応じて、リソースの正常性全体をエンドツーエンドで可視化し、問題の最も可能性の高い根本原因にドリルダウンし、実際のコード行にまでドリルダウンし、アプリまたはインフラストラクチャの問題を修正し、数分で再デプロイすることができます。 堅牢な監視パイプラインのセットアップがある場合は、顧客に影響を与え始める前に、問題を見つけて修正できる必要があります。</p>\n\n<h2>継続的な監視</h2>\n\n<p>多くのお客様は、DevOpsの概念として継続的インテグレーションと継続的配置 (CI/CD) が、ソフトウェアをより迅速かつ確実に提供し、ユーザーに継続的な価値を提供するのにどのように役立つかを既に知っています。 継続的監視 (CM) は、DevOpsおよび IT Ops サイクルの各フェーズに監視を組み込むことができる新しいフォローアップ概念です。 これにより、開発者、運用、顧客を通じてアプリとインフラストラクチャの正常性、パフォーマンス、信頼性が継続的に確保されます。</p>\n\n<p><img alt=\"Continuous Monitoring with Azure Monitor and Azure DevOps\" border=\"0\" height=\"308\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4775d0d3-aad0-4c19-9274-d9a21fa7b5e3.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"DevOpsの継続的な監視\" width=\"610\"></p>\n\n<p>Azure Monitor は、ワークフロー全体で継続的監視を実際に有効にできるそのようなツールの 1 つです。 開発およびテスト中に<a href=\"https://visualstudio.microsoft.com/\">Visual StudioとVisual Studio Code</a>とシームレスに連携しながら、展開および運用中のリリース管理と作業項目管理の<a href=\"https://azure.microsoft.com/services/devops/\">Azure DevOps</a>との統合も行います。 さらに、お客様の既存の IT プロセスにおける問題とインシデントを追跡するのに役立つ任意の ITSM ツールや SIEM ツールとも統合されます。</p>\n\n<h2>継続的監視の 7 つのベスト プラクティス</h2>\n\n<h3><em>すべての</em>アプリの監視を有効にする</h3>\n\n<p>完全な監視の最初の手順は、すべての Web アプリとサービスの監視を有効にすることです。 コードで作業している場合は、.NET、Java、Node.js、またはその他のプログラミング言語で記述されたアプリに <a href=\"https://docs.microsoft.com/azure/azure-monitor/\">Azure Monitor アプリケーション インサイト SDK を追加</a>する必要があります。 これは、アプリやビジネスに関連するカスタム イベント、メトリック、またはページ ビューを指定できるため、推奨される方法です。</p>\n\n<p>コードへのアクセス権がない&rsquo;場合は、監視、<a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-vsts-continuous-monitoring\">Azure Pipelinesのリリース テンプレート</a>、<a href=\"https://azure.microsoft.com/features/devops-projects/\">Azure DevOps プロジェクト、Windows</a> <a href=\"https://docs.microsoft.com/en-us/azure/application-insights/app-insights-monitor-performance-live-website-now?toc=/azure/azure-monitor/toc.json\">サーバー上の .NET アプリの状態モニター</a>、Azure VM または Azure アプリ Services の拡張機能などを有効にする他の多くのメカニズムがあります。 すべてのアプリで監視を有効にすると、すべてのコンポーネント間のエンド ツー エンドのトランザクションと接続を簡単に視覚化できます。</p>\n\n<h3>インフラストラクチャ <em>のすべての </em>関連コンポーネントの監視を有効にする</h3>\n\n<p>通常、アプリケーション スタックのコンポーネントに問題がある可能性があるものを予測することは困難であるため、 <em>関連するすべての</em> コンポーネントを監視することが重要です。 Azure Monitor は、VM、コンテナー、Storage、ネットワーク、その他の Azure サービスなど、ハイブリッド インフラストラクチャ全体の正常性とパフォーマンスを追跡するのに役立ちます。 ほとんどの Azure リソースからプラットフォーム <a href=\"https://docs.microsoft.com/azure/monitoring/monitoring-data-collection?toc=/azure/azure-monitor/toc.json\">メトリック、アクティビティ ログ、診断ログ</a> を自動的に取得し、Azure Portal をクリックするか、サーバーにエージェントをインストールすることで <a href=\"https://docs.microsoft.com/azure/monitoring/monitoring-vminsights-overview?toc=/azure/azure-monitor/toc.json\">、仮想マシン</a> または <a href=\"https://docs.microsoft.com/azure/monitoring/monitoring-container-insights-overview?toc=/azure/azure-monitor/toc.json\">AKS クラスター</a> をより詳細に監視できます。</p>\n\n<p>コードとしてのスケーラビリティとインフラストラクチャの場合は、DevOps プロジェクト、<a href=\"https://docs.microsoft.com/azure/monitoring/monitoring-vminsights-onboard?toc=/azure/azure-monitor/toc.json\">Azure ポリシー、PowerShell、または ARM テンプレート</a>を利用して、大規模なリソースセットに対するアラートの監視と<a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-create-metric-alerts-with-templates?toc=/azure/azure-monitor/toc.json\">構成</a>を有効にすることをお勧めします。 お客様のインフラストラクチャ全体に対して監視を有効にすることは、完全な観測性を実現するのに役立つほか、何らかの障害が発生した際に考え得る根本的原因を検出しやすくするのに役立ちます。</p>\n\n<h3>リソース グループ内のバケット関連リソース</h3>\n\n<p>現在の Azure の一般的なアプリケーションは、VM/App Services にデプロイされたモノリシック アプリ、または Cloud Services、AKS クラスター、ACS、またはService Fabricでホストされるマイクロサービスで構成されています。 これらのアプリは、多くの場合、Event Hubs、Storage、SQL、Service Busなどの依存関係を利用してタスクを完了します。 多くのお客様は、 <a href=\"https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview\">リソース グループ</a> を使用して、アプリケーションを構成するすべてのリソースをバケット化します。また、同じリソース グループを使用する場合、 <a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/resource-group-insights\">Azure Monitor for resource groups</a> では、フル スタック アプリケーション全体の正常性とパフォーマンスを簡単に追跡できる一方で、調査やデバッグのために各コンポーネントをドリルダウンできます。</p>\n\n<h3>継続的デプロイによって品質を確保する</h3>\n\n<p><a href=\"https://azure.microsoft.com/services/devops/pipelines/\">Azure Pipelines</a>は継続的配置を設定する優れた方法であり、CI/CD テストが成功した場合にコード コミットから運用環境へのプロセス全体を自動化できます。 デプロイ前またはデプロイ後の <a href=\"https://docs.microsoft.com/azure/devops/pipelines/release/approvals/gates?view=vsts\">Quality Gates</a> の一部として監視を統合することで、アプリが開発者から運用環境に移行するにつれて、主要な正常性とパフォーマンスのメトリック (KPI) を追跡し続け、インフラストラクチャ環境やスケールの違いが KPI に悪影響を与えないことを確認できます。</p>\n\n<p>また、開発、テスト、カナリア、運用など、さまざまなデプロイ環境間で <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-separate-resources\">個別の監視インスタンス</a> を維持することをお勧めします。 そのため、データは関連するアプリとインフラストラクチャ全体に関連し続けられます。 関連付ける必要がある場合は、 <a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-metric-charts?toc=/azure/azure-monitor/toc.json\">メトリックス エクスプローラー</a> で常にマルチリソース グラフを設計するか、 <a href=\"https://docs.microsoft.com/azure/log-analytics/log-analytics-cross-workspace-search\">Log Analytics</a> でリソース間クエリを実行できます。</p>\n\n<h3>通知や修復を使用してアクション可能なアラートを設定する</h3>\n\n<p>堅牢なアラート パイプラインを使用することは、すべての監視戦略に不可欠であり、予測可能なすべての障害状態に対して実用的な <a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-alerts?toc=/azure/azure-monitor/toc.json\">アラート</a> を設定することをお勧めします。 静的または <a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-alerts-dynamic-thresholds?toc=/azure/azure-monitor/toc.json\">動的なしきい値</a> に基づいてアラートを構成し、その上にアクションを設定できます。 これらの <a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-action-groups?toc=/azure/azure-monitor/toc.json\">アクション</a> は、SMS、電子メール、プッシュ通知、または簡単な通知の音声通話と同じくらい簡単です。 Webhook を使用して、既存の ITSM ツールやその他のアラート管理システムに接続することもできます。 可能な場合は、エラスティック ワークロードの場合に、Azure Automation Runbook または<a href=\"https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitor-tutorial-autoscale-performance-schedule?toc=/azure/azure-monitor/toc.json\">自動スケーリング</a>と同様に修復を設計する方法があります。</p>\n\n<h3>レポート用にロールベースのダッシュボードとブックを準備する</h3>\n\n<p>会議のプレゼンテーションで多数のユーザーに質問すると、自社の開発とオペレーション全体で同じ監視ソリューションが既に使用されているかどうかに関しては、その答えは圧倒的に否定的です。 継続的な監視を成功させ、迅速な MTTD と MTTR を確保するには、開発と操作が同じテレメトリと同じツールにアクセスすることが不可欠です。 Azure Monitor はチーム全体の統合された監視ソリューションとして設計されており、一般的なメトリック &amp; ログに基づいて<a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-dashboards?toc=/azure/azure-monitor/toc.json\">カスタム ロールベースのダッシュボードを</a>簡単に準備できます。</p>\n\n<p><a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-usage-workbooks?toc=/azure/azure-monitor/toc.json\">ブック</a> は、開発と操作の間の知識共有に役立つもう 1 つの便利な機能です。 これらは、メトリック グラフとログ クエリを含む動的レポートとして、または基本的な問題を処理するためのカスタマー サポートまたは操作を支援する開発者によって準備されたトラブルシューティング ガイドとしても準備できます。</p>\n\n<h3>Build-Measure-Learn を使用して &ldquo;継続的に最適化する&rdquo;</h3>\n\n<p>顧客に適したソリューションを構築することは、最初の段階では実現することは決してなく、多くの場合、反復的なプロセスです。 監視は、一般的な &ldquo;Build-Measure-Learn&rdquo; の哲学の基礎の 1 つであり、KPI またはユーザーの行動メトリックを継続的に追跡し、計画のイテレーションを通じて最適化するよう努めることをお勧めします。 Azure Monitor を使用すると、ビジネスに関連するすべての関連するカスタム イベント、メトリック、またはログを収集できます。また、不足していると思われる場合は、次のデプロイに新しいデータ ポイントを追加するのは非常に簡単です。</p>\n\n<p>Azure Monitor のさまざまなツールを使用して、正常性、可用性、パフォーマンス、信頼性を追跡および最適化し、 <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-users?toc=/azure/azure-monitor/toc.json\">エンドユーザーの行動とエンゲージメント</a> を追跡してカスタマー エクスペリエンスを最適化することもできます。 Azure Monitor には <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-usage-impact?toc=/azure/azure-monitor/toc.json\">影響の相関関係</a> が用意されており、重要な KPI を推進するために重点を置く領域に優先順位を付けるのに役立ちます。</p>\n\n<h2>次の手順</h2>\n\n<p>DevOpsおよび IT Ops プロセス全体にわたるアプリとインフラストラクチャ全体にわたる継続的監視パイプラインは、MTTD と MTTR を削減しながら、顧客に最適なソリューションの提供に努めるのに本当に役立ちます。</p>\n\n<p>ドキュメントで Azure Monitor の詳細を確認 <a href=\"https://aka.ms/MonitoringDocs\">し、これらの</a>プラクティスの一部をさらに詳しく実装するのに役立つ <a href=\"https://aka.ms/AzMonOverview\">、Azure Portal の Azure Monitor の概要</a> 内のいくつかの優れたチュートリアルとビデオを確認してください。</p>\n"
}