{
    "Slug": "advancing-azure-active-directory-availability",
    "Title": "Azure Active Directory の可用性の進化",
    "Summary": "Continuing our Azure reliability series to be as transparent as possible about key initiatives underway to keep improving availability, today we turn our attention to Azure Active Directory",
    "Content": "<p>&ldquo;可用性の向上を維持するために進行中の主要なイニシアティブについて、<a href=\"https://www.aka.ms/advancingreliability\" target=\"_blank\">Azure 信頼性シリーズ</a>をできるだけ透過的に継続し、今日はAzure Active Directoryに注目します。 Microsoft Azure Active Directory (Azure AD) は、2 億 5,000 万人以上の月間アクティブ ユーザーに安全にアクセスできるクラウド ID サービスであり、140 万を超える固有のアプリケーションを接続し、300 億を超える毎日の認証要求を処理します。 これにより、Azure AD最大のエンタープライズ ID とアクセス管理ソリューションだけでなく、世界最大&rsquo;のサービスの 1 つになります。 以下の投稿は、これらの取り組みをリードしているエンジニアリングのパートナーディレクター、ナディム・アブドによって書かれました。&rdquo; - Mark Russinovich、CTO、Azure</p>\n\n<hr>\n<p>&nbsp;</p>\n\n<p>お客様は、すべてのアプリケーションとサービスへの安全なアクセスを管理するためにAzure ADを信頼しています。 これは、すべての認証要求がミッション クリティカルな操作であることを意味します。 サービスの重要な性質と規模を考えると、ID チーム&rsquo;の最優先事項は、サービスの信頼性とセキュリティです。 Azure ADは、真にクラウドネイティブでハイパースケールのマルチテナント アーキテクチャを使用して可用性とセキュリティのために設計されており、当社のチームは信頼性とセキュリティに関する継続的なプログラムを実施しています。</p>\n\n<h2>Azure AD: コア可用性の原則</h2>\n\n<p>この規模、複雑さ、ミッション クリティカル性のサービスをエンジニアリングして、私たちが構築し、失敗する可能性のある世界で高可用性を実現することは、複雑な作業です。</p>\n\n<p>回復性に関する投資は、以下の一連の信頼性原則に基づいています。</p>\n\n<p><img alt=\"o  Azure AD resilience investments are organized around this set of reliability principles\" border=\"0\" height=\"295\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/79639571-4f8a-49d3-ba27-6244be5994b2.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"\" width=\"624\"></p>\n\n<p>可用性の仕事は、可能な限り顧客の目に見える障害の可能性を減らすために多層防御アプローチを採用しています。障害が発生した場合は、その障害の影響を可能な限り範囲を絞り込み、最後に障害の復旧と軽減にかかる時間をできるだけ短縮します。</p>\n\n<p>今後数週間と数か月にわたって、各原則がどのように設計され、実際に検証されるかについて詳しく説明し、お客様のためにどのように機能するかを例として示します。</p>\n\n<h2>非常に冗長</h2>\n\n<p>Azure ADは、複数のレベルの内部冗長性と自動回復性を備えたグローバル サービスです。 Azure ADは、現在存在する Azure Availability Zonesを活用して、世界中の 30 以上のデータセンターにデプロイされています。 この数は、追加の Azure リージョンがデプロイされるにつれて急速に増加しています。</p>\n\n<p>持続性のために、Azure ADに書き込まれたデータは、テナントの構成に応じて、少なくとも 4 つ、最大 13 のデータセンターにレプリケートされます。 各データ センター内では、データは持続性のために少なくとも 9 回レプリケートされますが、認証負荷に対応するために容量をスケールアウトすることもできます。 これを説明&mdash;すると、任意の時点で、サービス内で利用可能なディレクトリ データのコピーが最小リージョンに少なくとも 36 個存在することを意味します。 持続性の場合、リージョン外データセンターへのコミットが成功するまで、Azure ADへの書き込みが完了しません。</p>\n\n<p>このアプローチにより、データの持続性と大規模な冗長性&mdash;の両方が得られます。ネットワーク パスとデータセンターは、特定の承認要求に対応でき、システムはデータセンター内とデータセンター間の両方の障害を自動的かつインテリジェントに再試行およびルーティングします。</p>\n\n<p>これを検証するために、定期的に障害挿入を実行し、Azure AD構築されているシステム&rsquo; コンポーネントの障害に対するシステムの回復性を検証します。 これにより、データセンター全体を定期的に取り出して、システムが顧客への影響をゼロにしてデータセンターの損失を許容できることを確認することができます。</p>\n\n<h2>単一障害点なし (SPOF)</h2>\n\n<p>前述のように、Azure AD自体は複数のレベルの内部回復性で設計されていますが、私たちの原則は、すべての外部依存関係に回復性を持つまでさらに拡張されています。 これは、単一障害点 (SPOF) 原則で表されます。</p>\n\n<p>サービスの重要度を考えると、分散ネーム サービス (DNS)、コンテンツ配信ネットワーク (CDN)、SMS や音声を含む多要素認証 (MFA) を転送する Telco プロバイダーなどの重要な外部システムでは、SPOF を受け入れていません&rsquo;。 これらのシステムごとに、完全なアクティブ/アクティブ構成で構成された複数の冗長システムを使用します。</p>\n\n<p>この原則に関する作業の多くは、過去 1 年間に完了し、大規模な DNS プロバイダーが最近停止した場合、Azure ADは、代替プロバイダーへのアクティブ/アクティブ パスが存在したため、まったく影響を受けませんでした。</p>\n\n<h2>エラスティックスケール</h2>\n\n<p>Azure ADは既に 300,000 を超える CPU コアで実行されている大規模なシステムであり、Azure Cloud の大規模なスケーラビリティに依存して、あらゆる需要に応じて動的かつ迅速にスケールアップできます。 これには、特定のリージョンでの認証の午前 9 時のピークなど、トラフィックの自然な増加と、世界最大&rsquo;のイベントの一部に電力を供給し、多くの場合、数百万人の新規ユーザーが急増するAzure AD B2C によって提供される新しいトラフィックの急増も含まれます。</p>\n\n<p>追加レベルの回復性として、Azure ADは容量を過剰にプロビジョニングし、設計ポイントは、データセンター全体のフェールオーバーで再頒布された負荷を処理するために容量の追加プロビジョニングを必要としないことです。 これにより、緊急時に必要なすべての容量が既に手元にあることを知る柔軟性が得えます。</p>\n\n<h2>デプロイのセーフ</h2>\n\n<p>セーフ展開により、内部オートメーションから内部から Microsoft セルフホスティング リング、運用環境への変更 (コードまたは構成) が徐々に進行します。 運用環境では、デプロイの 1 つのリングから次のリングへの進行状況を制御する自動正常性チェックを使用して、変更にさらされたユーザーの割合の非常に段階的で低速なランプアップを採用しています。 このプロセス全体は、運用環境全体で変更を完全にロールアウトするのに 1 週間以上かかり、いつでも最新の既知の正常な状態に迅速にロールバックできます。</p>\n\n<p>このシステムは、Microsoft の内部にある初期リング&rsquo;と呼ばれる&lsquo;潜在的な障害を定期的にキャッチし、顧客/運用トラフィックに影響を与えるリングへのロールアウトを防ぎます。</p>\n\n<h2>最新の検証</h2>\n\n<p>安全なデプロイをゲートする正常性チェックをサポートし、システムの正常性に関するエンジニアリング チームの分析情報を提供するために、Azure ADは、システムの正常性を監視するために使用される大量の内部テレメトリ、メトリック、およびシグナルを出力します。 私たちの規模では、これは私たちの自動健康監視システムを供給する信号の週に11ペタバイト以上です。 これらのシステムは、可用性またはサービス品質 (QoS) の潜在的な低下に対応する 24 時間 765 日のエンジニアのチームと同様に、自動化へのアラートをトリガーします。</p>\n\n<p>ここでの取り組みは、サービスの正常性だけでなく、特定のテナントの特定のシナリオのエンドツーエンドの正常性を真に表すメトリックを提供するために、そのテレメトリを拡張することです。 チームは既にこれらのメトリックについて内部的にアラートを出しており、&rsquo;このテナントごとの正常性データを Azure Portal で顧客に直接公開する方法を評価しています。</p>\n\n<h2>パーティション分割と詳細な障害ドメイン</h2>\n\n<p>Azure ADをよりよく理解するための良い例は、他のコンパートメントまたは容器全体の完全性に影響を与えずに洪水できるように設計された潜水艦のコンパートメントです。</p>\n\n<p>Azure ADに相当するものは障害ドメインであり、障害ドメイン内の一連のテナントにサービスを提供するスケール ユニットは、他の障害ドメイン&rsquo;スケール ユニットから完全に分離されるように設計されています。 これらの障害ドメインは、障害の発破半径&rsquo;が&lsquo;特定の障害ドメインに含まれるなど、多くのクラスの障害をハードに分離します。</p>\n\n<p>これまでAzure ADは、5 つの個別の障害ドメインで構成されています。 昨年の間に完了し、来年の夏までにこの数は 50 個の障害ドメインに増加し、Azure Multi-Factor Authentication (MFA) を含む多くのサービスが、同じ障害ドメインで完全に分離されるように移行しています。</p>\n\n<p>このハード パーティション分割作業は、ユーザーの 1/50 以下または最大 2% に障害や障害をスコープとするすべてを最終的にキャッチするように設計されています。 私たちの目標は、翌年にこれをさらに数百の障害ドメインに増やすことです。</p>\n\n<h2>来るもの&rsquo;のプレビュー</h2>\n\n<p>上記の原則は、コア Azure AD サービスを強化することを目的としています。 Azure ADの重要な性質を考えると、&rsquo;我々は、&mdash;プライマリAzure ADサービスで障害が発生した場合にシームレスなフォールバック認証サポートを提供できる、2つ目の完全に障害に関連したIDサービスを運用環境でロールアウトするなど、新しい投資&rsquo;をカバーします。</p>\n\n<p>これは、プライマリ電源グリッドが影響を受けた場合にカバレッジと保護を提供できるバックアップ ジェネレーターまたは無停電電源装置 (UPS) システムと同等であると考えてください。 このシステムは、エンド ユーザーにとって完全に透過的でシームレスであり、M365 ワークロードの一連の重要な認証フローの一部を保護する運用環境に入っています。 Well&rsquo; は、より多くのシナリオとワークロードをカバーするために、その適用性を急速に拡大しています。</p>\n\n<p>今後の投稿に関心のあるご質問やトピックをお聞きし、<a href=\"https://www.aka.ms/identityblog\" target=\"_blank\">Azure Active Directory ID ブログ</a>の詳細を共有することを楽しみにしています。</p>\n"
}