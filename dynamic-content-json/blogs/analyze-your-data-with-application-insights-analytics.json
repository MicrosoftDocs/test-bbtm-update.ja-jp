{
    "Slug": "analyze-your-data-with-application-insights-analytics",
    "Title": "Application インサイト Analytics を使用してデータを分析する",
    "Summary": "You can now apply the powerful Analytics query language to high-volume NoSQL data streams that you import from any source. ",
    "Content": "<div style=\"background:#eee;border:1px solid #ccc;padding:5px 10px;\"><strong>2019 年 7 月 23 日更新: </strong>このブログで説明されている機能は廃止され、アプリケーション インサイトには存在しなくなりました。 または、 <a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/platform/data-sources-custom-logs\" target=\"_blank\">カスタム ログ </a>を <a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/overview#overview\" target=\"_blank\">Azure Monitor ログ ストア</a> (Log Analytics) に送信することもできます。 このデータは、リソース間クエリを使用して、Log Analytics または Application インサイト リソースから<a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/log-query/cross-workspace-query\">クエリを実行</a>できます。</div>\n\n<p>強力な <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-analytics-tour\">Analytics</a> クエリ言語を、 <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-analytics-import\">任意のソースからインポート</a>する大量の NoSQL データ ストリームに適用できるようになりました。 <a href=\"https://powerbi.microsoft.com/\">Power BI</a>または Azure ダッシュボードで結果を表示し、指定したしきい値を超えた場合にアラートを取得できます。 これまで、Analytics クエリは、ライブ Web アプリから<a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-overview\">Azure アプリケーション インサイト</a>によって収集されたパフォーマンスと使用状況のテレメトリに適用されてきました。 これで、インポートしたデータをアプリのテレメトリと結合するか、クエリを実行して完全に別のデータを分析できます。 データは、JSON または DSV (区切り記号で区切られた値) として指定できます。</p>\n\n<p>一般的なシナリオを次に示します。</p>\n\n<ul>\n <li><strong>アプリテレメトリを参照テーブルと結合します</strong>。 たとえば、Web サイトの URL を読みやすいページ タイトルにマップするテーブルをインポートすることもできます。 Analytics では、Web サイト内で特に人気のある上位 10 件のページを表示する、ダッシュボード チャート レポートを作成することができます。</li>\n <li><strong>アプリケーション テレメトリを</strong>、ネットワーク トラフィック、サーバー データ、CDN ログ ファイルなどの他のソースと関連付けます。</li>\n <li><strong>Analytics を別のデータ ストリームに適用します</strong>。 タイムスタンプが付いたスパースストリームがある場合は、多くの場合、SQLよりもはるかに効率的に Analytics を使用して分析できます。 これは、このブログで注目するシナリオです。</li>\n</ul>\n\n<p>たとえば、&rsquo;フライトに関するデータ フィードを受け取るとします。 ルートの人気と輻輳の毎日の分析を自動化できます。 分析では、結合、集計、統計関数などの複雑なクエリを実行して、必要な結果を抽出できます。 結果は、Analytics で使用できるグラフの範囲で表示できます。 または、毎日<a href=\"https://powerbi.microsoft.com/\">クエリPower BI</a>実行し、結果をマップにプロットして、Web サイトに表示することもできます。</p>\n\n<h1>設定</h1>\n\n<p>Analytics を使用してデータを分析するには、<a href=\"https://azure.com\">Microsoft Azure</a>にアカウントが必要です。</p>\n\n<p><a href=\"https://portal.azure.com\">ポータルにサインイン</a>し、Azure <a href=\"https://azure.microsoft.com/services/storage/\">でStorage</a> リソースを設定します。 ここで、データを Analytics に吸い込む前&rsquo;にデータを配置します。</p>\n\n<p><a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-create-new-resource\">Application Insights リソースを作成します</a>。 次に、そこから [分析] ページに移動します。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a1136ac9-6321-4296-ada2-c0898de524bb.png\"><img alt=\"Analyze your data with Application Insights Analytics\" border=\"0\" height=\"45\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4b20567b-aad3-4c74-9b4c-49f904a9afe2.png\" style=\"border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;\" title=\"Analytics ポータルを開く\" width=\"361\"></a></p>\n\n<h1>データ ソースを定義する</h1>\n\n<p>データを分析する前に、その形式について Analytics に通知する必要があります。 私たちが言ったように、ここでは&rsquo;アプリケーションインサイトの資料をスキップし、独自のデータ ソースの定義に直接進む必要があります。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3127c813-a24a-41c6-9115-52fabf28aa2f.png\"><img alt=\"Analyze your data with Application Insights Analytics\" border=\"0\" height=\"276\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/39197a83-a900-4222-87ef-230a21203239.png\" style=\"border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;\" title=\"新しいデータ ソースを追加する\" width=\"221\"></a></p>\n\n<p>これにより、データ ソースに名前を付け、そのスキーマを定義するウィザードが開きます。 これを行うには、明示的なスキーマを指定するか、通常は簡単なデータの &ndash; 小さなサンプルを&rsquo;アップロードします。</p>\n\n<p>フライト データの例では、ファイルは CSV 形式です。 サンプル データ ファイルにはヘッダーが含まれており、スキーマはそこから自動的に推論されます。 必要に応じて、推論されたデータ型とフィールド名を更新できます。</p>\n\n<h1>データの取り込み</h1>\n\n<p>スキーマを&rsquo;定義したら、必要な頻度でデータ ファイルをアップロードできます。 数百 MB のデータ ファイルは、Analytics によって簡単に処理されます。</p>\n\n<p>データを取り込むには&rsquo;、短いスクリプトを使用してプロセスを自動化するのが最も簡単です。 このスクリプトは、データを Azure Storage にアップロードし、それを取り込むよう Analytics に通知します。 <a href=\"https://docs.microsoft.com/en-us/azure/application-insights/app-insights-analytics-import#import-data\">インポート ドキュメント</a>にサンプルがあります&rsquo;。</p>\n\n<h1>クエリを実行する</h1>\n\n<p>&rsquo;ここでは、航空会社別の上位 10 の目的地空港を検索するクエリを示します。</p>\n\n<pre>\nairlineRoutes\n| summarize count() by Destination_airport \n| top 10 by count_ desc\n| render piechart</pre>\n\n<p>&nbsp;</p>\n\n<p>結果:</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a1b3bbe5-84af-4e38-991a-b5f476fd59f1.png\"><img alt=\"Analyze your data with Application Insights Analytics\" border=\"0\" height=\"306\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7f93dbfd-bf3a-48fa-9d3a-e6a3736aee7f.png\" style=\"border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;\" title=\"\" width=\"480\"></a></p>\n\n<p><a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-analytics-tour\">クエリ言語</a>は強力ですが、簡単に学習でき、各演算子が 1 つのタスク&ndash;を実行するパイプモデルは、SQLの入れ子になった SELECT よりもはるかに簡単に操作できます。</p>\n\n<h1>複数のテーブルを結合する</h1>\n\n<p>Analytics は複数のソースを取り込み、クエリでそれらのソースに対して結合を実行できます。</p>\n\n<p>たとえば、しかし、空港がコードではなくフルネームで識別されるのを見る方がはるかに良いでしょうか&rsquo;? 各空港コードをその名前やその他の情報にマップする新しいデータ ソース airportsData を追加します&rsquo;。 テーブルに <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-analytics-reference#join-operator\">対して結合</a> を実行できるようになりました。</p>\n\n<pre class=\"prettyprint\">\nairlineRoutes \n| summarize routeCount = count() \n  by airportCode = destination_airport // rename field for join\n| top 10 by routeCount count_ desc \n| join kind=inner  ( airportsData  ) on airportCode\n| project routeCount, airportCode  // the fields we want\n| render piechart</pre>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4c6ef804-8d54-427c-a46e-dc290bfb7be8.png\"><img alt=\"Analyze your data with Application Insights Analytics\" border=\"0\" height=\"183\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/765a31d3-32d0-4c28-8302-a8a8083fb3fd.png\" style=\"border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;\" title=\"\" width=\"610\"></a></p>\n\n<h1>アプリケーション インサイト テレメトリの拡張</h1>\n\n<p>Analytics の主な仕事は、Web アプリケーションの正常性と使用状況を監視するアプリケーション インサイトの強力なクエリ ツールです。 Analytics にデータをインポートする理由の 1 つは、テレメトリ データを拡張することです。 たとえば、テレメトリ レポートを読みやすくするために、クエリ URL をページ名に変換できます。</p>\n\n<h1>今日概要</h1>\n\n<p>分析は、現在のデータに適用できます。 <a href=\"https://docs.microsoft.com/azure/application-insights/app-insights-analytics-import\">詳細な操作方法については、こちらをご覧ください</a>。</p>\n\n<p>データを強化する場合でも、アプリケーションのログ データを分析する場合でも、新しいデータ ソースを簡単に追加してデータの取り込みを開始できます。 大量のインジェストを使用して、Analytics クエリ言語の機能を独自のカスタム データに適用できるようになりました。</p>\n\n<p>常に、次のいずれかのチャネルを使用して、ご質問やフィードバックをお寄せください。</p>\n\n<p>&middot;<a href=\"https://analytics.applicationinsights.io/demo\">Application Analytics を試す</a></p>\n\n<p>&middot;<a href=\"https://visualstudio.uservoice.com/forums/357324-application-insights/category/161991-analytics\">アイデアを提案し、アプリケーションインサイトアイデアに投票する</a></p>\n\n<p>&middot;<a href=\"https://social.msdn.microsoft.com/Forums/vstudio/home?forum=ApplicationInsights\">アプリケーション インサイト Communityで会話に参加</a>する</p>\n"
}