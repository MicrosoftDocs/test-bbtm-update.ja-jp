{
    "Slug": "announcing-general-availability-of-vm-storage-and-network-azure-cli-2-0",
    "Title": "Azure コマンド ライン 2.0 が一般公開されました",
    "Summary": "Today, we’re announcing the general availability of the vm, acs, storage and network commands in Azure CLI 2.0. These commands provide a rich interface for a large array of use cases, from disk and extension management to container cluster creation. See below for an example of the features included with the vm command.",
    "Content": "<p>9 月に戻って、 <a href=\"https://azure.microsoft.com/en-us/blog/announcing-azure-cli-2-preview/\">Azure CLI 2.0 プレビュー</a>を発表しました。 本日は、&rsquo;Azure CLI 2.0 での <a href=\"https://docs.microsoft.com/en-us/cli/azure/vm\">VM</a>、 <a href=\"https://docs.microsoft.com/en-us/cli/azure/acs\">acs</a>、 <a href=\"https://docs.microsoft.com/en-us/cli/azure/storage\">ストレージ</a> 、 <a href=\"https://docs.microsoft.com/en-us/cli/azure/network\">およびネットワーク</a> コマンドの一般提供についてお知らせします。 これらのコマンドは、ディスクと拡張機能の管理からコンテナー クラスターの作成まで、さまざまなユース ケースに対応する豊富なインターフェイスを&nbsp; 提供します。</p>\n\n<p>今日&rsquo;のお知らせは、お客様がこれらのコマンドを運用環境で使用できるようになったことを意味し、Azure サポートチャネルまたはGitHubの両方を通じて Microsoft が完全にサポートしています。 Azure CLI 2.0 の新しいリリースでは、これらのコマンドの破壊的変更は想定されていません&rsquo;。</p>\n\n<p>この新しいバージョンの Azure CLI は、Linux および macOS 用の bash 環境のコマンド ライン エクスペリエンスに慣れている開発者にとって、最も一般的な操作のスマートな既定値を持ち、grep、cut、などの他のテキスト解析ツールと対話するためのタブ補完とパイプ可能な出力をサポートする単純なコマンドを使用する開発者にとって、はるかにネイティブであると感じる必要があります。 jq と一般的な JMESpath クエリ構文。 選択&rsquo;したプラットフォーム <a href=\"https://docs.microsoft.com/en-us/cli/azure/install-az-cli2\"><u>に簡単にインストール</u></a> して学習できます。</p>\n\n<p>プレビュー期間中は、&rsquo;早期導入者から貴重なフィードバックを受け取り、その入力に基づいて新機能を追加しました。 Azure CLI 2.0 でサポートされている Azure サービスの数が増え、Azure 上に sql、documentdb、redis、およびその他の多くのサービス用のコマンド モジュールが追加されました。 また、Azure CLI 2.0 での作業の生産性を向上させる新機能も用意されています。 たとえば、weve は、&rsquo;ユーザーが外部条件に &quot;応答したり、応答を待たずにスクリプトを続行したりできるようにする --wait&quot; 機能と &quot;--no-wait&quot; 機能を追加しました。</p>\n\n<p>&rsquo;また、Azure CLI 2.0 の新機能、特に Bash コマンドと CLI コマンドの組み合わせ、Azure Managed Disks などの新しいプラットフォーム機能のサポートについても非常に興奮しています。</p>\n\n<p>&rsquo;Azure CLI 2.0 の使用を開始する方法について説明します。</p>\n\n<h2>Azure CLI のインストール</h2>\n\n<p>CLI は Mac、Linux、およびもちろんWindowsで実行されます。 概要、使用<a href=\"https://docs.microsoft.com/en-us/cli/azure/install-az-cli2\">するプラットフォームに CLI をインストール</a>します。&nbsp;また、CLI の概要と、スクリプトの CLI を使用して Azure 経由で提供されるサービスにアクセスする方法の詳細については、<a href=\"https://docs.microsoft.com/en-us/cli/azure/overview\">ドキュメントとサンプル</a>を参照してください。</p>\n\n<p>vm コマンドに含まれる機能の例を次&rsquo;に &quot;示します&quot;。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ed323466-71ca-464a-bc25-b64e8e00b496.png\"><img alt=\"vm command example (2)\" border=\"0\" height=\"768\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c056925f-4fef-4872-a6da-4715ef4982ba.png\" style=\"border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"vm コマンドの例 (2)\" width=\"902\"></a></p>\n\n<p>&nbsp;</p>\n\n<h2>Azure CLI を使用する</h2>\n\n<p>Azure へのアクセスと 1 つ以上の VM の起動は簡単です。 Azure の westus2 リージョンに <a href=\"https://azuremarketplace.microsoft.com/en-us/marketplace/apps/Canonical.UbuntuServer?tab=PlansAndPrice\">Azures 最新の Ubuntu VM イメージを使用して&rsquo;</a><a href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-portal\">リソース グループ</a> (Azure リソースをグループ化および管理する方法) と Linux VM を作成する 2 行のコードを次に示します。</p>\n\n<pre class=\"prettyprint\">\naz group create -n MyResourceGroup -l westus2\naz vm create -g MyResourceGroup -n MyLinuxVM --image ubuntults \n</pre>\n\n<p>VM のパブリック IP アドレスを使用して (vm create コマンドの出力で取得するか、az vm list-ip-addresses&quot; コマンドを使用して&quot;個別に検索できます)、コマンド ラインから VM に直接接続します。</p>\n\n<pre class=\"prettyprint\">\nssh &lt;public ip address&gt; </pre>\n\n<p>Azure 上の Windows VM の場合は、リモート デスクトップ (&quot;Windows デスクトップからの mstsc &lt;パブリック IP アドレス&gt;&quot;) を使用して接続できます。</p>\n\n<p>vm&quot; の&quot;作成コマンドは実行時間の長い操作であり、VM の作成、デプロイ、および Azure での使用に時間がかかる場合があります。 ほとんどの自動化スクリプトの場合、次のコマンドを実行する前にこのコマンドが完了するまで待機しても問題ありません。このコマンドの結果は次のコマンドで使用できます。 ただし、それ以外の場合は、前のコマンドがまだ実行中で、サーバーからの結果を待っている間、他のコマンドを引き続き使用できます。 Azure CLI 2.0 では、このようなシナリオに対して新しい &quot;--no-wait&quot; オプションがサポートされるようになりました。</p>\n\n<pre class=\"prettyprint\">\naz vm create -n MyLinuxVM2 -g MyResourceGroup --image UbuntuLTS --no-wait</pre>\n\n<p>リソース グループとVirtual Machinesと同様に、Azure CLI 2.0 を使用して、azure で他のリソースの種類を作成するには、theaz &lt;リソースの種類名&gt;の作成名前付&quot;けパターンを&nbsp;&quot;使用します。</p>\n\n<p>たとえば、Azure AppServices 内で WebApps などのマネージド リソースを Azure に作成できます。</p>\n\n<pre class=\"prettyprint\">\n# Create an Azure AppService that we can use to host multiple web apps \naz appservice plan create -n MyAppServicePlan -g MyResourceGroup\n\n# Create two web apps within the appservice (note: name param must be a unique DNS entry)\naz appservice web create -n MyWebApp43432 -g MyResourceGroup --plan MyAppServicePlan\naz appservice web create -n MyWEbApp43433 -g MyResourceGroup --plan MyAppServicePlan\n</pre>\n\n<p>さまざまな Azure リソースの種類の作成コマンド オプションの詳細については、 <a href=\"https://docs.microsoft.com/en-us/cli/azure/\">CLI 2.0 リファレンス ドキュメント</a> を参照してください。 Azure CLI 2.0 を使用すると、Azure リソースを一覧表示し、さまざまな出力形式を提供できます。</p>\n\n<pre class=\"prettyprint\">\n<strong>--output Description</strong>\njson json string. json is the default. Best for integrating with query tools etc\njsonc colorized json string.\ntable table with column headings. Only shows a curated list of common properties for the selected resource type in human readable form.\ntsv tab-separated values with no headers. optimized for piping to other tex-processing commands and tools like grep, awk, etc.\n</pre>\n\n<p>list コマンドで &quot;--query&quot; オプションを使用すると、特定のリソースを検索したり、出力に表示するプロパティをカスタマイズしたりできます。 次に例をいくつか示します。</p>\n\n<pre class=\"prettyprint\">\n# list all VMs in a given Resource Group\naz vm list -g MyResourceGroup --output table\n\n# list all VMs in a Resource Group whose name contains the string &lsquo;My&rsquo;\naz vm list --query &ldquo;[?contains(resourceGroup,&rsquo;My&rsquo;)]&rdquo; --output tsv\n\n# same as above but only show the &#39;VM name&#39; and &#39;osType&#39; properties, instead of all default properties for selected VMs\naz vm list --query &ldquo;[?contains(resourceGroup,&rsquo;My&rsquo;)].{name:name, osType:storageProfile.osDisk.osType}&rdquo; --output table\n</pre>\n\n<p>Azure CLI 2.0 では、Azure 上のSQL Serverに対する管理操作がサポートされています。 これを使用して、サーバー、データベース、データ ウェアハウス、およびその他のデータ ソースを作成できます。使用状況を表示したり、管理ログインを管理したり、その他の管理操作を実行したりします。</p>\n\n<pre class=\"prettyprint\">\n# Create a new SQL Server on Azure\naz sql server create -n MySqlServer -g MyResourceGroup --administrator-login &lt;admin login&gt; --administrator-login-password &lt;admin password&gt; -l westus2\n\n# Create a new SQL Server database\naz sql db create -n MySqlDB -g MyResourceGroup --server-name MySqlServer -l westus2\n\n# list available SQL databases on Server within a Resource Group\naz sql db list -g MyResourceGroup --server-name MySqlServer\n</pre>\n\n<h2>新しい Azure CLI 2.0 機能を使用したスクリプト作成</h2>\n\n<p>同じスクリプトで Bash と Azure CLI 2.0 コマンドを組み合わせる新しい機能は、特に grep、cut、jq、<a href=\"https://docs.microsoft.com/en-us/cli/azure/query-az-cli2\">JMESpath クエリ</a>などの Linux コマンド ライン ツールに既に慣れている場合&rsquo;に、大きな時間を節約できます。</p>\n\n<p>まず&rsquo;、VMs リソース ID (またはスペース別の複数の ID) を使用して、リソース グループ内の VM&rsquo; を停止する簡単な例を示します。</p>\n\n<pre class=\"prettyprint\">\naz vm stop &ndash;ids &lsquo;&lt;one or more ids&gt;&rsquo;</pre>\n\n<p>VM 名を使用して、リソース グループ内の VM&rsquo; を停止することもできます。 上で作成した VM を停止する方法を次に示&rsquo;します。</p>\n\n<pre class=\"prettyprint\">\naz vm stop -g resourceGroup -n simpleVM</pre>\n\n<p>より複雑なユース ケースでは、&rsquo;リソース グループ内に多数の VM があり、Windowsと Linux を実行しているとします。&nbsp;そのリソース グループ内で実行中のすべての Linux VM を停止するには、次のように JMESpath クエリを使用します。</p>\n\n<pre class=\"prettyprint\">\nos=&quot;Linux&quot;\nrg=&quot;resourceGroup&quot;\nps=&quot;VM running&quot;\nrvq=&quot;[].{resourceGroup: resourceGroup, osType: storageProfile.osDisk.osType, powerState: powerState, id:id}| [?osType==&#39;$os&#39;]|[?resourceGroup==&#39;$rg&#39;]| [?powerState==&#39;$ps&#39;]|[].id&quot;\naz vm stop --ids $(az vm list --show-details --query &quot;$rvq&quot; --output tsv)\n</pre>\n\n<p>このスクリプトは az vm stop コマンドを発行しますが、JMESpath クエリ結果 (rvq 変数で定義) で返される VM に対してのみ発行されます。 osType、resourceGroup、powerState パラメーターには値が指定されています。 resourceGroup パラメーターは VMs&rsquo; resourceGroup プロパティと比較され、osType パラメーターは VMs&rsquo; storageProfile.osDisk.osType プロパティと比較され、az vm stop&quot; コマンドで&quot;使用するために一致するすべての結果が (<a href=\"https://en.wikipedia.org/wiki/Tab-separated_values\">tsv 形式</a>で) 返されます。</p>\n\n<h2>CLI の Azure Container Services</h2>\n\n<p>Azure Container Service (ACS) を使用すると、コンテナー アプリケーションを実行するように事前構成された仮想マシンのクラスターの作成、構成、管理が簡単になります。 オーケストレーションには、(Apache Mesos を搭載した) DC/OS、Docker Swarm、または Kubernetes で Docker イメージを使用できます。</p>\n\n<p>Azure CLI では、az acs コマンドを使用した ACS クラスターの作成とスケーリングがサポートされています。 <a href=\"https://docs.microsoft.com/en-us/cli/azure/acs\">Azure Container Services</a> の完全なドキュメントと、Azure <a href=\"https://docs.microsoft.com/en-us/azure/container-service/container-service-create-acs-cluster-cli\">CLI コマンドを使用して ACS DC/OS クラスターをデプロイするための</a>チュートリアルを確認できます。</p>\n\n<h2>CLI を使用して Azure Managed Disksを使用してスケーリングする</h2>\n\n<p>Microsoft は最近、Virtual Machinesの管理とスケーリングを簡素化するために、Azure Managed Disksの一般提供を<a href=\"https://azure.microsoft.com/en-us/blog/announcing-general-availability-of-managed-disks-and-larger-scale-sets/\">発表しました</a>。 特定のディスク イメージの暗黙的なマネージド ディスクを使用して仮想マシンを作成し、az vm disk コマンドを使用して BLOB ストレージまたはスタンドアロンからマネージド ディスクを作成することもできます。 更新とスナップショットも簡単です。 <a href=\"https://azure.microsoft.com/en-us/blog/azure-cli-managed-disks/\">CLI から Managed dDisks</a> でできることも確認してください。</p>\n\n<h2>Azure CLI 2.0 の使用を今すぐ開始してください。</h2>\n\n<p>既存の CLI ユーザーでも、新しい Azure プロジェクトを開始する場合でも、CLI <a href=\"https://aka.ms/CLI\">https://aka.ms/CLI</a> の使用を簡単に開始し、&rsquo;更新された<a href=\"https://docs.microsoft.com/en-us/cli/azure/\">ドキュメントとサンプル</a>を使用してコマンド ラインをマスターできます。 <a href=\"https://docs.microsoft.com/en-us/cli/azure/install-az-cli2\">CLI のインストールと更新</a>、<a href=\"https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-linux-quick-create-cli?toc=%2fcli%2fazure%2ftoc.json\">Virtual Machines</a>の操作、VM、スケール セット、Storage、ネットワークなどの<a href=\"https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-linux-create-cli-complete?toc=%2fcli%2fazure%2ftoc.json\">完全な Linux 環境</a>の作成、Azure <a href=\"https://docs.microsoft.com/en-us/azure/app-service-web/app-service-web-get-started-nodejs?toc=%2fcli%2fazure%2ftoc.json\">Web Apps</a> &ndash; のデプロイなどのトピックを確認し、ご自分の考えをお聞かせください。</p>\n\n<p>Azure CLI 2.0 はオープンソースされ、<a href=\"https://github.com/azure/azure-cli\">GitHub</a>。</p>\n\n<p>今後数か月で、&rsquo;さらに多くの更新プログラムが提供されます。 これまでと同様に、継続的なフィードバックが必要です。 運用環境で VM、ストレージ、およびネットワーク コマンドを使用しているお客様は、Azure サポートに問い合わせて問題が発生した場合、 <a href=\"https://stackoverflow.com/questions/tagged/azure-cli\">azure-cli タグを使用して StackOverflow</a> 経由で連絡したり、直接メールを <a href=\"mailto:azfeedback@microsoft.com\">azfeedback@microsoft.com</a>送信したりすることができます。</p>\n"
}