### YamlMime:Yaml
ms.openlocfilehash: 04b8772f436a0c5bc4ad2d0cc081c614b25ea076
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139904763"
Slug: installing-certificates-into-iot-devices
Title: IoT デバイスへの証明書のインストール
Summary: 多くの人が、Azure IoT Hub Device Provisioning Service の使用を開始するときに x.509 証明書ベースの認証に移行しています。 しかし、ベストプラクティスについての質問や、大規模な運用方法についての質問がたくさんあります。
Content: >-
  <div style="background:#eee;border:1px solid #ccc;padding:5px 10px;"><strong>更新:</strong>Azure IoT デバイスに関する関連情報については、 <a data-bi-area="undefined" data-bi-id="page-clicked-link" data-bi-view="undefined" data-event="page-clicked-link" href="https://docs.microsoft.com/en-us/azure/iot-dps/concepts-device-oem-security-practices">Azure IoT デバイスの製造元のセキュリティプラクティス</a>に関するドキュメントを参照してください。</div>


  <p>多くの人が、 <a href="https://docs.microsoft.com/azure/iot-dps/" target="_blank">Azure IoT Hub Device Provisioning Service</a>の使用を開始するときに<a href="https://docs.microsoft.com/en-us/azure/iot-dps/concepts-security#x509-certificates" target="_blank">x.509 証明書ベースの認証</a>に移行しています。 しかし、ベストプラクティスについてよく寄せられる質問や、大規模な運用方法については、&#39;。 証明書の取得元とインストール方法に影響を与える変数は多数あります。また、各ステージを所有するユーザーは、所定のプロセスやビジネス関係によって異なります。 このブログ投稿は、実稼働レベルのスケールでの IoT デバイスの証明書の生成とインストールプロセスについて、明確に説明することを目的としています。</p>


  <p>開始する前に、IoT デバイスに証明書をインストールするためのシステムが既に用意されていて、その機能をお試しください。 読み取りを停止し、 <a href="https://channel9.msdn.com/Shows/Internet-of-Things-Show" target="_blank">他のコンテンツ</a>を確認してください。 このブログ投稿は、IoT デバイスで証明書を使用するように切り替えている人を対象としており、最適な機能を理解することに苦労しています。</p>


  <h2>必須のセキュリティ rant</h2>


  <p>パスワードを使用していて、すぐに修正が必要な&#39;場合は、すべてのデバイスで同じパスワードを使用できるように、すべてのデバイスで同じ証明書を使用することを&#39;できる理由をユーザーにたずねることがあります。 まず、同じパスワードをどこでも使用するのは非常に悪いことであり、既にいくつかの主要な DDoS 攻撃を受けています。これには、米国東部海岸で DNS をダウンした場合などがあります。 私は自分の個人アカウントを使用していても、このようなことは&#39;いません。 2つ目の証明書は、完全な id であるパスワードではありません。 パスワードは、clubhouse にアクセスするための秘密のフレーズを知っているのと同じように、証明書は bouncer がドライバー&#39;s ライセンスを確認するように求めるです。 これは、 &rsquo; passport に複数のコピーを作成し、識別に使用するものを付与した場合と同じです。 自分の名前と passport を指定して (なりすまし id とも呼ばれます)、または自分の名前と passport を指定すると、ユーザー名に一致する ID を持っていないため、罫線コントロールエージェントが開始します。</p>


  <h2>証明書の決定に含まれる変数</h2>


  <p>IoT デバイスで証明書を使用する場合は、いくつかの変数が用意されています。 重い top-hitters は次のとおりです。</p>


  <p><strong>信頼の証明書ルートの取得元</strong>。 この決定は、独自のコストの許容範囲と、公開キー基盤 (PKI) の管理レベル &ndash; に基づいて行います。特に、会社が経験を持っていない場合は、あまり重要ではありません。 オプションは次のとおりです。</p>


  <ul>
      <li>サードパーティの証明書ベンダーから中間署名証明書 (またはプライベート CA) を購入するサードパーティ PKI。</li>
      <li>自己管理型 PKI。独自の PKI システムを維持し、独自の証明書を生成します。</li>
      <li><a href="https://www.microsoft.com/en-us/azure-sphere/details/" target="_blank">Azure Sphere &rsquo; s</a> セキュリティサービス (Azure Sphere デバイスのみ)。</li>
  </ul>


  <p><strong>証明書が格納</strong>される場所。 これは、再構築&#39;デバイスの種類、予想されるデバイスの余白 (セキュリティで保護されたストレージを確保できるかどうか)、デバイス&#39;機能、利用できるデバイス上の既存のセキュリティテクノロジによって異なります。 オプションは次のとおりです。</p>


  <ul>
      <li>(ハードウェアセキュリティモジュール (HSM)) (推奨)。 デバイス&#39;s control board に HSM が既にインストールされているかどうかを確認します。 &#39;私は、お客様のデバイスに HSM が既にインストールされていることを確認したことがあります。これは、使用していることが&#39;t であることがわかりました。 HSM&#39;ないことがわかっている場合は、ハードウェアの製造元と協力して、ニーズを満たす HSM を特定します。</li>
      <li>信頼できる実行環境 (TEE) など、ディスク上のセキュリティで保護された場所。</li>
      <li>ローカルファイルシステムまたは証明書ストア (Windows 証明書ストアなど)。</li>
      <li>その他</li>
  </ul>


  <p><strong>ファクトリでの接続</strong>。 これにより、デバイスにインストールされる証明書を取得する方法とタイミングが決まります。 オプションは次のとおりです。</p>


  <ul>
      <li>はい。接続はローカルに証明書を生成できます。</li>
      <li>接続がありません (ファクトリには、ローカルでオフラインでデバイス証明書を生成するために使用される署名済み CA 証明書があります)。</li>
      <li>接続なし (証明書を事前に生成する必要があります。または、オフライン PKI)。</li>
  </ul>


  <p><strong>監査要件</strong>。 作成するデバイスの種類によっては、デバイスにデバイス id がどのようにインストールされているかについて監査可能な記録を得るために、規制によって要求される場合があります。 これは、運用環境に大きなコストを追加できるため、必要な場合にのみ実行してください。 これが当てはまるかどうかわからない場合は、会社の&#39;の法務部門に確認してください。&#39;。 オプションは次のとおりです。</p>


  <ul>
      <li>機密業界ではなく、監査は必要ありません。</li>
      <li>機密業界では、さまざまなコンプライアンス認定の要件に従って、セキュリティで保護された場所に証明書をインストールする必要があります。 証明書をインストールするのに十分な空き領域が必要な場合は、証明書がデバイスにインストールされ、システムが既に存在していることを既に認識していることがあります。 この投稿はお勧めできません。</li>
  </ul>


  <p><strong>証明書の有効期間の長さ</strong>。 ドライバー&#39;s ライセンスと同様に、証明書の作成時に有効期限が設定されます。 オプションは次のとおりです。</p>


  <ul>
      <li>非常に長いですが、ロールをロールする必要はありません。 非常に危険なアプローチです。 HSM などの非常に安全な記憶域を使用してリスクを軽減することができます。ただし、有効期間が長い証明書の方法はお勧めできません。</li>
      <li>デバイスの有効期間中はロールする必要があります。 これはコンテキストに依存しており、証明書をロールする方法、証明書を取得する&#39;する方法、およびデバイスに対してどのような種類の無線機能が存在するかについての戦略が必要です。</li>
  </ul>


  <h2>証明書を生成するタイミング</h2>


  <p>前のセクションで説明したように、ファクトリでの接続は、デバイスの証明書を生成するタイミングを決定するうえで重要な役割を果たします。 それについて&#39;しましょう。</p>


  <p>Hsm ベンダーによっては、お客様に代わって hsm に証明書がインストールされる premium サービスが提供されています。 お客様は、HSM ベンダーに署名証明書へのアクセス権を付与し、その署名証明書によって署名された証明書を、顧客が購入する各 HSM にインストールします。 顧客が行う必要があるのは、デバイスに HSM を取り付けることだけです。 このルートに到達したユーザーには、このプロセスが非常に優れていることが示されています&#39;。 &ldquo;HSM &rdquo; ルートに事前に読み込まれている場合、証明書を生成するタイミングは問題ではありません。 おめでとうございます!</p>


  <p>デバイスが内部で証明書を生成する場合は、登録のためにデバイスからパブリックの x.509 証明書を抽出する必要があります。</p>


  <p>ファクトリが接続されている場合は、必要に応じていつでも証明書を生成できます。</p>


  <p>工場が接続されておらず、オフラインサポートで独自の PKI を使用している場合は、必要に応じていつでも証明書を生成できます。</p>


  <p>ファクトリが接続されておらず、サードパーティの PKI を使用している場合は、インターネットに接続されている場所から事前に証明書を生成する必要があります。</p>


  <h2>証明書をインストールするタイミング</h2>


  <p>IoT デバイスに対して生成された証明書 (または、いつ生成するか) を&#39;したので、それをデバイスにインストールする時間を&#39;ます。</p>


  <p>HSM &rdquo; ルートに事前に読み込まれている場合、その &ldquo; 生活は少し簡単になります。 デバイスに HSM をインストールすると、デバイスコードからにアクセスできるようになります。 Hsm Api を使用して、HSM 内に格納されている証明書を使用します。 これは最も簡単なオプションですが、もう少しコストを&#39;ます。</p>


  <p>それ以外の場合は、実稼働プロセスの一部として証明書をインストールする必要があります。 既存のプロセスに統合する最も簡単な方法は、最初のファームウェアイメージを使用して証明書をインストールすることです。 各デバイスは、製造フロアで少なくとも1つのタッチを通過してイメージをインストールし、最終的な品質チェックを実行する必要があります。その前に、最終的な宛先に送信するためにデバイスをパッケージ化します。 &#39;は、通常、インストールとテストをワンショットで行うツールです。 証明書を生成したり、事前に生成されたストアから証明書を取得したり、証明書をインストールする必要がある場所にインストールしたりするように、ツールを変更することができます。 このツールを使用すると、運用レベルの製造に必要なスケールを得ることができます。</p>


  <p>IoT デバイスでの証明書の取得についてさらに支援が必要な場合は、 <a href="https://azureiotpartners.azurewebsites.net/#partnerCategoryFilter=security" target="_blank">セキュリティ監査者プログラム</a>の担当者にお問い合わせください。 デバイスで証明書を<a href="https://docs.microsoft.com/en-us/azure/iot-dps/how-to-manage-enrollments" target="_blank">設定したら</a>、<a href="https://docs.microsoft.com/azure/iot-dps/" target="_blank">デバイスプロビジョニングサービス</a>で<a href="https://docs.microsoft.com/en-us/azure/iot-dps/how-to-roll-certificates" target="_blank">証明書</a>と登録を使用する方法について説明します。</p>


  <p>Limerick を使用して合計を計算するには、次の手順を実行します。</p>


  <p>大規模なデバイス証明書のインストール<br>

  しかしを使用して問題なく実行できます。<br>

  完全に実行できます。<br>

  計画と作業のみ<br>

  このブログ投稿は、guシャードとして機能します。</p>
