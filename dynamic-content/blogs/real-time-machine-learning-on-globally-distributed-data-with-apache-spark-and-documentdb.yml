### YamlMime:Yaml
ms.openlocfilehash: 78911ad637045aca2208add25bf193f43cf7cfe1
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139889009"
Slug: real-time-machine-learning-on-globally-distributed-data-with-apache-spark-and-documentdb
Title: Apache Spark と DocumentDB を使用したグローバル分散データでのリアルタイム機械学習
Summary: サン・・・・2017・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ x これにより、リアルタイムのデータサイエンス、機械学習、および探索をグローバルに行うことができます...
Content: >-
  <p><strong>2017年5月10日のうち、</strong></p>


  <p><strong>Azure Cosmos DB は、Microsoft &rsquo; がグローバルに分散したマルチモデルデータベースです。Azure Cosmos DB は、グローバルな分散と水平方向のスケールを中心として一から構築されました。任意の数の Azure リージョンでのターンキーグローバル分散を提供します。ユーザーがどこにいても、透過的にデータのスケーリングとレプリケーションを行うことができます。スループットとストレージを世界規模で弾力的にスケーリングし、必要なスループットとストレージに対してのみ料金を支払うことができます。Azure Cosmos DB では、世界中のどこでも99パーセンタイルで1桁のミリ秒の待機時間を保証し、複数の明確に定義された整合性モデルを使用してパフォーマンスを微調整し、業界トップレベルのサービスレベルアグリーメント (sla) によってサポートされるマルチホーム機能 &mdash; によって高可用性を保証します。&nbsp;</strong></p>


  <p><strong>Azure Cosmos DB は完全にスキーマに依存しません。スキーマとインデックスの管理に対処する必要がなく、すべてのデータのインデックスが自動的に作成されます。また、マルチモデルで、ドキュメント、キー値、グラフ、列ファミリの各データモデルも、ネイティブにサポートされて &rsquo; います。Azure Cosmos DB では、DocumentDB SQL (ドキュメント)、MongoDB (ドキュメント)、Azure Table Storage (キー値)、およびグリーン mlin (グラフ) がすべてネイティブにサポートされているため、お好きな api を使用してデータにアクセスできます。</strong></p>


  <hr>

  <p>サン・・・ <a href="https://aka.ms/spark-documentdb">・2017・</a>・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ x これにより、Azure DocumentDB のグローバル分散データをリアルタイムでデータサイエンス、機械学習、探索することができます。 Apache Spark を Azure DocumentDB に接続することにより、お客様 &rsquo; は迅速にデータサイエンスの問題を解決できるようになり、DocumentDB を使用してデータを迅速に保存してクエリを実行できるようになります。 Spark to DocumentDB コネクタは、ネイティブの DocumentDB 管理インデックスを効率的に悪用し、 <a href="https://github.com/Azure/azure-documentdb-spark/wiki">IoT、データサイエンス、分析のシナリオ</a>から、急速に変化するグローバル分散データに対して分析、プッシュダウン述語フィルター処理を実行するときに、更新可能な列を有効にします。 Spark to DocumentDB コネクタは、 <a href="https://github.com/Azure/azure-documentdb-java">Azure DocumentDB JAVA SDK</a>を使用します。 今すぐ<a href="https://aka.ms/spark-documentdb">開始</a>して、 <a href="https://github.com/Azure/azure-documentdb-spark">GitHub</a>から Spark コネクタをダウンロードすることができます。</p>


  <h2>DocumentDB とは?</h2>


  <p>Azure DocumentDB は、開発者が地球規模のアプリケーションを構築できるように設計された、グローバル分散型データベースサービスです。 DocumentDB では、多数の地理的リージョン間でスループットとストレージの両方を弾力的にスケーリングできます。 このサービスは、P99 での待機時間の短縮、99.99% の高可用性、予測可能なスループット、および <a href="https://docs.microsoft.com/en-us/azure/documentdb/documentdb-consistency-levels">明確に定義された複数の整合性モデル</a>を提供します。これらはすべて包括的な sla に支えられています。 DocumentDB では、<a href="https://www.vldb.org/pvldb/vol8/p1668-shukla.pdf">スキーマに依存しない書き込みに最適化されたデータベース エンジン</a>により、取り込んだすべてのデータのインデックスを既定で自動的に作成することができ、規模に依存しない方法で、<a href="https://docs.microsoft.com/en-us/azure/documentdb/documentdb-sql-query">SQL</a>、<a href="https://docs.microsoft.com/en-us/azure/documentdb/documentdb-protocol-mongodb">MongoDB</a>、および <a href="https://docs.microsoft.com/en-us/azure/documentdb/documentdb-programming#javascript-language-integrated-query-api">JavaScript</a> 統合言語クエリを処理できます。 DocumentDB は、クラウド サービスとして、最初からマルチテナントとグローバル配布を念頭に置いて入念に設計されています。<br>

  これらの固有の利点により、DocumentDB は運用環境でも、web、モバイル、パーソナル化、ゲーム、IoT など、シームレスなスケールとグローバルレプリケーションを必要とするその他のアプリケーションの分析ワークロードにも適しています。</p>


  <h2>機械学習とデータサイエンスに DocumentDB を使用する利点は何ですか。</h2>


  <p>DocumentDB は完全にスキーマフリーです。 データベース エンジン内で JSON データ モデルを直接処理することで、明示的なスキーマやセカンダリ インデックスの作成を必要とせずに、JSON ドキュメントの自動インデックス作成を実現しています。 DocumentDB は、よく知られている SQL 言語を使用した JSON ドキュメントの照会をサポートしています。 DocumentDB クエリは、JavaScript&#39;s 型システム、式の評価、および関数呼び出しをルートとしています。 これにより、リレーショナルプロジェクションの自然なプログラミングモデル、JSON ドキュメント間の階層ナビゲーション、自己結合、空間クエリ、および JavaScript で完全に記述されたユーザー定義関数 (Udf) の呼び出しが、他の機能の中でも提供されます。 ここでは、集計を含むように SQL 文法を拡張し、これらの機能に加えて、グローバルに分散した aggs を有効にしました。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f52a7b7a-855c-4c89-bb1f-7cff2d5a92c9.png"><img alt="Apache Spark" border="0" height="214" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/44b11fb4-3155-4b2a-895c-9eba313e9cbe.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="Apache Spark" width="597"></a></p>


  <p align="center"><em>図 1: DocumentDB 用の Spark コネクタを使用すると、Spark worker ノードと DocumentDB データパーティション間でデータが並列化されます。 </em></p>


  <h2>分散集計と高度な分析</h2>


  <p>Azure documentdb では、 <a href="https://azure.microsoft.com/en-us/blog/planet-scale-aggregates-with-azure-documentdb/">Azure documentdb を使用した世界規模の集計</a>に記載されているように、azure documentdb には集計 (SUM、MIN、MAX、COUNT、sum、および GROUP BY、DISTINCT など) がありますが、documentdb に Apache Spark を接続すると、Apache Spark を利用して、より大きな分散集計を簡単かつ迅速に実行できます。 たとえば、次のスクリーンショットでは、Spark SQL を介して Apache Spark&#39;s PERCENTILE_APPROX 関数を使用して分散中央値計算を計算しています。</p>


  <pre>

  select destination, percentile_approx(delay, 0.5) as median_delay

  from df

  where delay &lt; 0

  group by destination

  order by percentile_approx(delay, 0.5)</pre>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6c35825c-ba72-4570-831c-bc9b4839c348.png"><img alt="Figure 2" border="0" height="244" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/871de0ae-ccbc-4321-bbe8-d09441cdd292.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="図2" width="468"></a></p>


  <p align="center"><em>図 2: Azure HDInsight の Spark で Jupyter notebook サービスを使用して、上記の分散中央値を計算するための領域の視覚化。 </em></p>


  <h2>プッシュダウン述語のフィルター処理</h2>


  <p>次のアニメーション gif に記載されているように、Apache Spark からのクエリでは、Azure DocumentDB に対して処理がプッシュダウンされ、DocumentDB が既定ですべての属性のインデックスを作成します。 さらに、データが存在する場所に計算をプッシュすることで、-situ で処理を実行し、移動する必要があるデータの量を減らすことができます。 グローバルなスケールでは、分析クエリのパフォーマンスが大幅に高速化ます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/70e50ce0-d235-4244-9b8a-2f7faa6d9c70.gif"><img alt="Figure 3" border="0" height="262" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/51e64ae2-3c84-4abb-a403-5eaba74144fc.gif" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="図3" width="466"></a></p>


  <p>たとえば、シアトル (SEA) から出発したフライトだけを要求する場合、Spark to DocumentDB コネクタは次のようになります。</p>


  <ul>
   <li>クエリを Azure DocumentDB に送信します。</li>
   <li>Azure DocumentDB 内のすべての属性に自動的にインデックスが作成されるため、シアトルに関連するフライトのみが Spark worker ノードに迅速に返されます。</li>
  </ul>


  <p>これにより、分析、データサイエンス、ML の作業を実行するときに、必要なデータのみが転送されます。</p>


  <h2>非常に高速な IoT シナリオ</h2>


  <p>Azure DocumentDB は、高スループットで待機時間の短い IoT 環境向けに設計されています。 次のアニメーション GIF は、フライトシナリオを示しています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7f743c1f-e8c1-4fef-a069-967488a69724.gif"><img alt="Figure 4" border="0" height="255" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/65219540-d72e-463a-a236-cf789d2afe1b.gif" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="図4" width="453"></a></p>


  <p>これにより、次のことが可能になります。</p>


  <ul>
   <li>同時実行アラートの高スループット (天気、フライト情報、グローバルな安全性アラートなど) を処理します。</li>
   <li>この情報をデバイス通知や RESTful サービスなどに送信します (たとえば、フライトの遅延が近い電話に関するアラートなど)。変更フィードの使用</li>
   <li>同時に、データに対して ML モデルを構築するときに、最新の情報を理解することもできます。</li>
  </ul>


  <h2>更新可能な列</h2>


  <p>前述の非常に優れた高速の IoT シナリオに関連して、更新可能な列について&#39;説明します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f766d97d-baf1-493f-836e-4833b534e016.gif"><img alt="Figure 5" border="0" height="250" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6a8041ab-7ffd-4a47-92b6-73832981bf48.gif" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="図5" width="444"></a></p>


  <p>新しい情報が含まれている場合 (フライトの遅延が5分から30分に変更された場合など)、この最新の情報を反映するために machine learning (ML) モデルをすぐに再実行できる必要があります。 たとえば、すべてのダウンストリームフライトの30分の影響を予測できます。 このイベントは、ML モデルを更新するために、 <a href="https://docs.microsoft.com/en-us/azure/documentdb/documentdb-change-feed">Azure DocumentDB Change Feed</a>を使用して迅速に開始できます。</p>


  <h2>次の手順</h2>


  <p>このブログ投稿では、新しい Spark to DocumentDB コネクタを見てきまし &rsquo; た。 DocumentDB を使用した Spark は、ビッグデータに対してアドホックで対話型のクエリを実行できるだけでなく、高度な分析、データサイエンス、機械学習、人工知能を実現します。 DocumentDB を使用すると、世界中のさまざまなソースから徐々に収集されたデータをキャプチャできます。 これには、ソーシャル分析、タイムシリーズ、ゲームまたはアプリケーションテレメトリ、小売カタログ、最新の傾向とカウンター、および監査ログシステムが含まれます。 その後、Spark を使用して、DocumentDB からのデータに加えて、高度な分析と AI アルゴリズムを大規模に実行できます。</p>


  <p>企業や開発者は、このシナリオをオンラインショッピングの推奨事項、リアルタイム通信アプリケーションのスパム分類器、個人設定の予測分析、および支払いの受け入れまたは拒否に関する迅速な意思決定を行う必要があるモバイルアプリケーションの不正行為検出モデルを採用できます。 最後に、モノのインターネットのシナリオもここに当てはまるので、データは人間ではなくコンピューターのアクションを表しているという明確な違いがあります。</p>


  <p>クエリの実行を開始するには、 <a href="https://portal.azure.com/#create/Microsoft.DocumentDB">azure Portal から新しい documentdb アカウントを作成</a>し、 <a href="https://github.com/Azure/azure-documentdb-spark">azure documentdb-Spark GitHub</a>リポジトリでプロジェクトを操作します。 詳細な手順については、「 <a href="https://aka.ms/docdbsparkdoc">Azure DocumentDB への Apache Spark の接続 </a>」を参照してください。</p>


  <p>最新の DocumentDB のニュースと機能については、Twitter <a href="https://twitter.com/DocumentDB">@DocumentDB</a> をフォローするか、 <a href="https://stackoverflow.com/questions/tagged/azure-documentdb">Stack Overflow の開発者フォーラム</a>でご連絡ください。</p>
