### YamlMime:Yaml
ms.openlocfilehash: 3b15bbca99e276fc996287d9c05f4db8d81700dd
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139912938"
Slug: automation-of-azure-analysis-services-with-service-principals-and-powershell
Title: サービスプリンシパルと PowerShell を使用した Azure Analysis Services の自動化
Summary: Azure Analysis Services は、サーバーのプロビジョニング、スケールアップ/スケールダウン、一時停止/再開、モデル管理、データ更新、配置などの管理タスクを自動化するための大きな機会を提供します。これにより、クラウドの効率を活用し、ミッションクリティカルなシステムの再現性と信頼性を確保できます。
Content: '<p>Azure Analysis Services は、サーバーのプロビジョニング、スケールアップ/スケールダウン、一時停止/再開、モデル管理、データ更新、配置などの管理タスクを自動化するための機会を提供します。 これにより、クラウドの効率を活用し、ミッションクリティカルなシステムの再現性と信頼性を確保できます。</p> <p>このようなタスクは、Azure クラウドで自動モードで PowerShell を使用して実行できます。 <a href="https://azure.microsoft.com/en-us/services/automation/">Azure Automation</a>などのサービスは、これらのプロセスをサポートするために存在します。 セキュリティを強化し、管理を容易にするために、 <strong>サービスプリンシパル</strong> を使用して実行する必要があります。 サービスプリンシパルはオンプレミスのサービスアカウントに似ていますが、Azure ではです。 パスワードまたは証明書と共に、アプリケーション ID の形式で資格情報を使用します。 モデル権限は、通常の Azure Active Directory UPN アカウントなどのロールメンバーシップを通じてサービスプリンシパルに割り当てられます。</p> <p>この記事の残りの部分では、 <a href="https://www.powershellgallery.com/packages/SqlServer/">SqlServer</a> PowerShell モジュールで使用可能な Analysis Services<a href="https://docs.microsoft.com/en-us/sql/analysis-services/powershell/analysis-services-powershell-reference">コマンドレット</a>と共に使用するサービスプリンシパルを作成する方法を示します。 </p>  <h2>サービスプリンシパルの作成</h2> <p><a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-create-service-principal-portal">Azure Portal でサービスプリンシパルを作成する方法</a>と、パスワードまたは証明書を使用して<a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-authenticate-service-principal">PowerShell でサービスプリンシパルを作成</a>する方法について説明します。</p> <h2>ロールのメンバーシップ</h2> <p>サービスプリンシパルが作成されると、そのアプリケーション ID には、次の構文を使用して Azure Analysis Services サーバーまたはモデルロールの権限を割り当てることができます。 次の例では、 <a href="https://docs.microsoft.com/en-us/sql/ssms/sql-server-management-studio-ssms">SSMS</a>のサーバー管理者グループにサービスプリンシパルを追加します。</p> <div style="border-top: #ccc 1px solid; border-right: #ccc 1px solid; background: #eee; border-bottom: #ccc 1px solid; padding-bottom: 5px; padding-top: 5px; padding-left: 10px; border-left: #ccc 1px solid; padding-right: 10px"><i>アプリ: &lt; アプリ guid &gt; @ &lt; テナント guid&gt;</i></div> <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9bf2046c-d104-4523-9c3b-2c6bca6a0d2d.jpg"><img title="clip_image002 [5]" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="clip_image002[5]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9e36480e-c89c-423c-b660-a3a8af4a1adc.jpg" width="1247" height="350"></a></p> <p>アプリケーションを選択するには、アカウントの選択を使用して SSMS で名前を検索します。</p> <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/189f35c0-8a5b-4284-9ffd-b23723c7dce3.png"><img title="絵" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5da11443-4a3d-464b-84a9-4032e70e93a0.png" width="363" height="467"></a></p> <h2>PowerShell とサービスプリンシパルを使用した管理タスクの実行</h2> <p>このセクションの前提条件は、最新の <a href="https://www.powershellgallery.com/packages/Azure.AnalysisServices/">microsoft.analysisservices.sharepoint.integration.dll</a> および <a href="https://www.powershellgallery.com/packages/SqlServer/">SqlServer</a> PowerShell モジュールをインストールすることです。</p> <div style="border-top: #ccc 1px solid; border-right: #ccc 1px solid; background: #eee; border-bottom: #ccc 1px solid; padding-bottom: 5px; padding-top: 5px; padding-left: 10px; border-left: #ccc 1px solid; padding-right: 10px"> <p>Install-Module-Name Microsoft.analysisservices.sharepoint.integration.dll</p> <p>Install-Module -Name SqlServer</p></div> <p>次の例では、サービスプリンシパルアプリケーション ID とパスワードを使用してログインし、モデル内のテーブルを処理 (データ更新) する方法を示します。</p> <div style="border-top: #ccc 1px solid; border-right: #ccc 1px solid; background: #eee; border-bottom: #ccc 1px solid; padding-bottom: 5px; padding-top: 5px; padding-left: 10px; border-left: #ccc 1px solid; padding-right: 10px"> <p>Param</p> <p> [Parameter (必須 = $true)][文字列] $AppId、</p> <p> [Parameter (必須 = $true)][文字列] $PlainPWord、</p> <p> [Parameter (必須 = $true)][文字列] $TenantId</p> <p> )</p> <p>$PWord = ConvertTo-SecureString-文字列 $PlainPWord-AsPlainText-Force</p> <p>$Credential = New-Object-TypeName "ArgumentList"--$AppId、$PWord</p> <p>Login-AzureAsAccount-Credential $Credential-ServicePrincipal-TenantId $TenantId-RolloutEnvironment "southcentralus.asazure.windows.net"</p> <p>Invoke-ProcessTable-Server "asazure://southcentralus.asazure.windows.net/myserver"-TableName "MyTable"-Database "MyDb"-RefreshType "Full"</p></div> <p>使用される login コマンドレットは、AzureAsAccount ではなく、ログイン-Azurlogin アカウントであることに注意してください。 前者は、 <a href="https://www.powershellgallery.com/packages/SqlServer/">SqlServer</a> PowerShell モジュールの Analysis Services<a href="https://docs.microsoft.com/en-us/sql/analysis-services/powershell/analysis-services-powershell-reference">コマンドレット</a>によって有効にされているような Azure Analysis Services データベースレベルの操作に使用する必要があります。 後者は、 <a href="https://www.powershellgallery.com/packages/AzureRM.AnalysisServices/">Microsoft.analysisservices.sharepoint.integration.dll</a> PowerShell モジュールで有効になっているものなど、Azure リソース管理操作に使用する必要があります。</p> <p>次の例では、サービスプリンシパルアプリケーション ID と自己署名証明書を使用してログインし、モデル内のテーブルを処理 (データ更新) する方法を示します。</p> <div style="border-top: #ccc 1px solid; border-right: #ccc 1px solid; background: #eee; border-bottom: #ccc 1px solid; padding-bottom: 5px; padding-top: 5px; padding-left: 10px; border-left: #ccc 1px solid; padding-right: 10px"> <p>Param</p> <p> [Parameter (必須 = $true)][文字列] $AppId、</p> <p> [Parameter (必須 = $true)][文字列] $CertThumbprint、</p> <p> [Parameter (必須 = $true)][文字列] $TenantId</p> <p> )</p> <p>Login-AzureASAccount-RolloutEnvironment "southcentralus.asazure.windows.net"-ServicePrincipal-ApplicationId $AppId-CertificateThumbprint $CertThumbprint-TenantId $TenantId</p> <p>Invoke-ProcessTable-Server "asazure://southcentralus.asazure.windows.net/myserver"-TableName "MyTable"-Database "MyDb"-RefreshType "Full"</p></div> <h3>&nbsp;</h3> <h2>Azure Automation での資格情報と証明書の格納</h2> <p>資格情報と証明書は、Azure Automation に安全に格納し、runbook で使用するために抽出できます。 <a href="https://docs.microsoft.com/en-us/azure/automation/automation-credentials">資格情報資産</a>と<a href="https://docs.microsoft.com/en-us/azure/automation/automation-certificates">証明書資産</a>の詳細については Azure Automation を参照してください。 </p>'
