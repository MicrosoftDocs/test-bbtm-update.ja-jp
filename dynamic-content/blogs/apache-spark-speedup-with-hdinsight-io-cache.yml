### YamlMime:Yaml
ms.openlocfilehash: 4ee254a9963b8234bf013f2a9e9a5116d957e8fd
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139903732"
Slug: apache-spark-speedup-with-hdinsight-io-cache
Title: Apache Spark ジョブが HDInsight IO キャッシュで最大 9 倍のスピードアップ
Summary: お客様に Apache Spark ジョブの最大 9 倍のパフォーマンス向上を提供する、Azure HDInsight の新しい透過的なデータ キャッシュ機能である HDInsight IO Cache のプレビューを明らかにいたします。
Content: >-
  <p>本日は、HDInsight IO Cache のプレビューが公開されました。これは、Azure HDInsight の新しい透過的なデータ キャッシュ機能であり、Apache Spark ジョブの最大 9 倍のパフォーマンス向上を顧客に提供します。 マネージド クラウドベースの Apache Hadoop サービスと Spark サービスの分析コスト効率は、お客様の主要な引き付け者の 1 つだとお客様から知っています。 HDInsight IO Cache を使用すると、対応するコストを増やさずにパフォーマンスを向上することで、この重要な価値提案をさらに改善できます。</p>


  <h2>アーキテクチャ</h2>


  <p>Azure HDInsightは、最高のオープン ソース プロジェクトを提供し、それらを Azure 上でネイティブに統合する、オープン ソース分析用のクラウド プラットフォーム サービスです。 エコシステムには多くのオープン ソース キャッシュ プロジェクトが存在します。Alluxio、Ignite、および IgnitiX は、いくつかの目立つプロジェクトに名前を付けたものになります。</p>


  <p>HDInsight IO Cache は、RubiX に基づいて作成されます。 "リバイX" は、より新しいプロジェクトの 1 つであり、アーキテクチャが異なります。 他のキャッシュ プロジェクトとは異なり、キャッシュ&rsquo;のために運用メモリは予約しません。 代わりに、SSD テクノロジの最近の進歩を最大限に活用して、明示的なメモリ管理を不要にする可能性を最大限に高めています。 最新の SSD は、1 秒あたり 1 GB を超える帯域幅を日常的に提供します。 自動オペレーティング システムのメモリ内ファイル キャッシュと組み合これにより、ビッグ データ コンピューティング処理エンジン (Apache Spark など) を読み込むのに十分な帯域幅が提供されます。 このアーキテクチャの動作メモリは、Apache Spark がメモリに依存するタスク (シャッフルなど) を処理するために引き続き使用できます。これにより、リソース使用率が最も高く、パフォーマンスがさらに向上します。 全体的に見ると、リモート クラウド ストレージからデータを読み取るジョブの速度が向上します。これは、クラウドの主要なアーキテクチャ パターンです。</p>


  <h2>作業の開始</h2>


  <p>Azure HDInsight IO キャッシュは、Azure HDInsight 2.3 の最新バージョンの Apache Spark 3.6 および 4.0 Spark クラスターで使用できます。 プレビュー期間中、この機能は既定で非アクティブ化されます。 アクティブ化するには、クラスターの Ambari 管理 UI で、[HDInsight IO Cache サービス] を選択し、[アクションのアクティブ化] <strong>をクリック &gt; します</strong>。</p>


  <p style="text-align: center;"><img alt="Ambari IO Cache Service" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/image-3.png" style="width: 180px; height: 234px;">&nbsp; <img alt="Action activate" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/image-4.png" style="width: 230px; height: 196px;"></p>


  <p>クラスター上の影響を受けるサービスの再起動を確認して続行します。</p>


  <p>HDInsight IO Cache がアクティブになると、クラスターの各ワーカー ノード上で、CacheiX Cache Metadata Servers が起動および管理されます。 また、RubiX キャッシュの透過的な使用のためにクラスターのすべてのサービスを構成します。 これにより、Spark ジョブを変更することなく、キャッシュの利点を得る可能性があります。 たとえば、IO キャッシュが非アクティブ化されると、この Spark コードは、Azure Blob Cache から通常のリモート読み取りを実行Storage。</p>


  <pre style="margin-left: 40px;">

  spark.read.load(&#39;wasbs:///myfolder/data.parquet&#39;).count()</pre>


  <p>IO キャッシュがアクティブ化されると、同じコード行が、CacheiX キャッシュを介してキャッシュされた読み取りを実行し、後続の読み取り時に SSD からローカルにデータを読み取ります。 HDInsight クラスター上のワーカー ノードにはローカルで接続された専用の SSD ドライブが備わっています。 HDInsight IO Cache では、これらのローカルの SSD をキャッシュに使用します。これは、待機時間を最小限に抑え、帯域幅を最大化します。</p>


  <h2>パフォーマンス ベンチマーク</h2>


  <p>IO キャッシュを使用した Azure HDInsight Spark クラスターのパフォーマンスと、それに対応する最適化された設定を、IO キャッシュ機能のない以前のバージョンのクラスターと比較しました。 TPC-DS から派生したベンチマークを使用し、1 TB のデータセットを分析SQL 99 個のクエリで構成されています。 どちらの場合もクラスターの構成は同じです。HDInsight 3.6 Spark 2.3 を実行している 16xD14v2 ワーカー ノード VM で構成されます。 結果は、クエリの実行時間の 9 倍のパフォーマンス向上と、geomean の 2.25 倍の改善を示します。</p>


  <p style="text-align: center;"><img alt="Top 20 TPC-DS queries" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/image-7.png" style="border: 0px currentcolor; border-image: none; width: 600px; height: 327px; background-image: none;"></p>


  <p style="text-align: center;"><img alt="Total running time" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/image-6.png" style="border: 0px currentcolor; border-image: none; width: 600px; height: 296px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;"></p>


  <h2>まとめ</h2>


  <p>HDInsight IO Cache は、最新のクラスターでプレビュー Azure HDInsight Apache Sparkされました。 有効にすると、必要なジョブを変更することなく、Spark ジョブのパフォーマンスが完全に透過的に向上します。 これにより、クラウドベースの Spark デプロイのパフォーマンス比率に対する優れたコストが提供されます。 このページで今 <a href="https://azure.microsoft.com/en-us/services/hdinsight/apache-spark/" target="_blank">すぐ試Azure HDInsight</a>。 質問とフィードバックについては、 にお問い合わせください <a href="mailto:AskHDInsight@microsoft.com">AskHDInsight@microsoft.com</a>。</p>


  <h2>HDInsight について</h2>


  <p>Azure HDInsightは、Azure でオープン&rsquo; ソース ワークロードを実行する Microsofts Premium マネージド オファリングです。 Apache Spark HDInsight 上のクラスターでは、クラス最高のセキュリティ機能、承認と監査の制御<a href="https://azure.microsoft.com/en-us/blog/powerful-debugging-tools-for-spark-for-azure-hdinsight/"></a>、作成用<a href="https://azure.microsoft.com/en-us/blog/hdinsight-tools-for-vscode-simplifying-cluster-spark-job-configuration-management/"></a>の開発ツール、Spark ジョブの<a href="https://azure.microsoft.com/en-us/blog/spark-debugging-and-diagnosis-toolset-for-azure-hdinsight/">診断が提供</a>されます。 &rsquo;Azure HDInsight顧客の中には、製造、小売、教育、非営利団体、政府機関、医療、メディア、銀行、電気通信、保険など、幅広いセクターで、ミッション クリティカルなアプリケーションの一部が機能します。 これらの業界では、ETL、データ ウェアハウス、機械学習、IoT など、さまざまなケースが使用されています。</p>
