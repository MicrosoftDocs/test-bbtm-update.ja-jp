### YamlMime:Yaml
ms.openlocfilehash: e782bbef4817059b0432171eb159b964a41d879b
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139890589"
Slug: advancing-azure-virtual-machine-availability-monitoring-with-project-flash
Title: Project Flash を使用して Azure 仮想マシンの可用性の監視を進める
Summary: 現在、プロジェクトの最初の2つのマイルストーン (Azure Resource Graph での vm の可用性データのプレビュー) と、Azure Monitor における vm 可用性メトリックのプライベートプレビューを発表しています。
Content: >-
  <p>&ldquo;強化され<em>た信頼性に関する<a href="https://www.aka.ms/AdvancingReliability" target="_blank">ブログシリーズ</a>の第4暦年であるため、組織が Azure でワークロードを確実に実行できるようにすることは、最優先事項の1つにとどまります。Microsoft は、Azure プラットフォームの進化に継続的に投資して、日々の実現に役立てています。仮想マシン (VM) の可用性を堅牢で包括的な方法で監視することは、アプリケーションの可用性と回復性を確保するうえで非常に重要です。シリーズの本日 &rsquo; の投稿では、Azure Core Platform の基礎エンジニアリングチームから、VM の可用性監視の最新の可観測性拡張機能について説明し、最適な監視エクスペリエンスを実現するための計画された投資を<strong>Pujitha Desiraju</strong>にお願いしました</em>。 &rdquo; &mdash;Mark Russinovich、CTO、Azure</p>


  <hr>

  <p>&nbsp;</p>


  <p><em>この投稿は、主要なソフトウェアエンジニアリングマネージャーである <strong>Jagtiani</strong>によって共同作成されました。</em></p>


  <p>Flash は、プロジェクトが内部で認識されているため、Azure の仮想マシン (VM) の可用性監視エコシステムを、お客様が特定の可観測性のニーズを満たすことができる集中管理された包括的な intelligible ソリューションに進化 &rsquo; させることを目的としています。 現在、プロジェクト &rsquo; の最初の2つのマイルストーン &mdash; の完了を発表しました。これ &rsquo; は、 <a href="https://azure.microsoft.com/features/resource-graph/">Azure Resource Graph</a>での vm の可用性データのプレビューと、 <a href="https://azure.microsoft.com/en-us/services/monitor/">Azure Monitor</a>の vm 可用性メトリックのプライベートプレビューです。</p>


  <h2>Project Flash とは</h2>


  <p>Project の Flash では、お客様のコミットメントから名前を取得します。これにより、仮想マシン (VM) の可用性を、アプリケーションの効率的なパフォーマンスを実現するための重要な前提条件として、できるだけ包括的に監視することができ &mdash; ます。 &rsquo;次のことを実現するための使命です。</p>


  <ul>
      <li>Vm の可用性の中断に関する<strong>正確で実用</strong>的なデータ (vm の再起動と再起動、ネットワークドライバの更新によるアプリケーションのフリーズ、30秒のホスト OS の更新など) に加え、正確なエラーの詳細 (プラットフォームとユーザーが開始した、再起動と凍結、計画済みまたは計画外のもの) も使用できます。</li>
      <li><strong>VM の可用性の傾向を分析してアラート</strong> を生成し、迅速なデバッグと月単位のレポートを作成できます。</li>
      <li><strong>大規模なデータを定期的に監視</strong> し、カスタムダッシュボードを作成して、すべてのリソースの最新の可用性状態を更新します。</li>
      <li>影響<strong>を受けた vm の詳細、</strong>ダウンタイムの原因と期間、修正後の修正など、すべてを対象と &mdash; した調査と事後分析を可能にするために、すべての問題について詳しく説明します。</li>
      <li>修復アクションを迅速にトリガーし、エンドユーザーの影響を防ぐために、VM の可用性に関する重要な変更についての<strong>即時通知を受け取り</strong>ます。</li>
      <li>変化するワークロードの感度とフェールオーバーのニーズに基づいて、<strong>プラットフォームの回復ポリシーを動的に調整し、自動化し</strong>ます。</li>
  </ul>


  <p>これらの目標を念頭に置いて、現在の重要なニーズを満たすために、長期的なフェーズである2つ &mdash; のフェーズに実行戦略を分けまし &rsquo; た。また、VM の可用性を監視するのに最適なエクスペリエンスを提供するための長期的なフェーズもあります。 この2段階のアプローチにより、ギャップを継続的に橋渡しし、サービス品質を反復処理し、すべての手順でフィードバックから学ぶことができます。</p>


  <h2>新しい監視オプションの発表</h2>


  <p>最初のフェーズでは、VM の可用性データへの便利なアクセスを可能にするためのさまざまなオプションを提供して、さまざまな可観測性ニーズに対応しています。 お客様が選択したソリューションの一貫性のあるビューを提供するために、これらの既存の機能とソリューション ( <a href="https://docs.microsoft.com/en-us/azure/service-health/resource-health-overview" target="_blank">Resource Health</a> や <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log" target="_blank">アクティビティログ</a>など) のすべてについて、同様の厳格な品質基準によってデータの一貫性を維持することを目的としています。</p>


  <h3>VM の可用性についてのスケール分析の概要</h3>


  <p>現時点では、 &rsquo; Azure Resource Graph で VM の可用性状態のプレビューリリースを使用して、初めての Project の Flash マイルストーン &mdash; にリーチし、プログラムによる使用量を拡大しています。</p>


  <p><a href="https://docs.microsoft.com/en-us/azure/governance/resource-graph/overview" target="_blank">azure リソース Graph</a>は azure のサービスであり、多数のサブスクリプションに対してクエリを効率的に実行できるようにするために広く採用されています。 &rsquo;現在、Azure リソース Graph の正常性リソーステーブルに対して<a href="https://docs.microsoft.com/en-us/azure/service-health/resource-health-overview#health-status" target="_blank">VM 可用性の状態</a>(利用可能、使用不可、不明) を出力しています。そのため、大規模なデータセットを一度に使用するための複雑な<a href="https://docs.microsoft.com/en-us/azure/data-explorer/data-explorer-overview" target="_blank">kusto クエリ言語 (kql) クエリ</a>を実行できます。 この機能は、VM の可用性の履歴の変更を追跡したり、カスタムダッシュボードを作成したり、複数のテーブルに分散した多数のリソースプロパティにわたる詳細な調査を実行したりする場合に便利です。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f4377708-8c04-45d9-835d-d5c503b8db87.png"><img alt="Azure Resource Graph Explorer Window with query and results, to demonstrate fetching data from the HealthResources table." border="0" height="449" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/550dc050-72b4-40b0-a5e5-df5af79f169c.png" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" title="図1引数エクスプローラーウィンドウ" width="1024"></a></p>


  <p><em><strong>図 1:</strong>HealthResources テーブルからのデータのフェッチを示すクエリと結果が表示された Azure リソース Graph エクスプローラーウィンドウ。</em></p>


  <ol>

  </ol>


  <p>この年の後半で、Azure リソース Graph の正常性リソーステーブルにエラーの詳細と低障害の VM シナリオを追加する予定です。 これらの詳細を使用すると、障害 &mdash; の原因と影響について適切に通知されるため、フェールオーバーまたは再起動したり、エンドユーザーの影響を防ぐために適切な対策を講じることができます。</p>


  <p>Azure portal の<a href="https://ms.portal.azure.com/#blade/HubsExtension/ArgQueryBlade/resourceType/Microsoft.Resources%2Fresources" target="_blank">Azure リソース Graph エクスプローラー</a>に移動して、<a href="https://docs.microsoft.com/en-us/azure/governance/resource-graph/samples/samples-by-table?tabs=azure-cli#healthresources" target="_blank">正常性リソーステーブルに対して発行</a>された kql クエリを開始します。</p>


  <h3>Azure Monitor での VM の可用性メトリックの概要</h3>


  <p>&rsquo;また、curated メトリックのアラートと監視エクスペリエンスを実現するために、既定の VM 可用性メトリックのプライベートプレビューを Azure Monitor で発表します。</p>


  <p><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/data-platform-metrics" target="_blank">Azure Monitor のメトリック</a> は、短時間で簡単にデバッグを行うための VM の可用性の時系列表現を監視および分析したり、傾向に関するアラートを受け取ったり、パフォーマンスの低下を把握したり、他のプラットフォームのメトリックと相互に関連付けたりするために役立ちます。</p>


  <p>メトリックを使用すると、予想される動作中に Vm &mdash; のパルスを追跡でき、メトリックには値1が表示されます。 VM の可用性の中断に対応するために、メトリックは影響の期間中は0になります。 Azure インフラストラクチャの停止が発生した場合、ポータルで点線として表現された null を出力します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/682a713e-22d0-4f16-8c2a-637804d289ae.png"><img alt="Screenshot of VM availability metric as seen on Metrics Explorer in the Azure portal, with occasional dips to reflect VM availability disruptions." border="0" height="445" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6800f334-da66-4a18-8b2a-2a10a6b1345a.png" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" title="VM 可用性メトリックのスクリーンショット" width="1024"></a></p>


  <p><em><strong>図 2:</strong> Vm の可用性の中断を反映するために発生する可能性のある、Azure portal のメトリックスエクスプローラーに表示される VM 可用性メトリックのスクリーンショット。</em></p>


  <p>このメトリックのプライベートプレビューはロールアウト計画のフェーズとしてリリースされ、現在、お客様からのフィードバックを収集して、オファリングをさらに改善しています。 インパクトの障害シナリオについて正確にアラートを作成できるように、来年にメトリックディメンションやプラットフォームログなどのエラーの詳細を追加する予定です。</p>


  <h2>近日公開予定</h2>


  <p>上記の2つの監視オプションは Project Flash の開始点にすぎません。 データ品質と障害の属性を向上させることで、既存のソリューションの構築を続けます。 同時に、待機時間と軽減のニーズを満たすために2つの新しい監視サービスを設計しています。また、障害検出をより弾力性と包括的なものにするために、基になるプラットフォームにも多額の投資を行っています。</p>


  <h3>即時通知の Azure Event Grid</h3>


  <p>ビジネスクリティカルなアプリケーションを正常に実行するには、VM 可用性に影響するイベントのハイパー認識が必要です。そのため、修復アクションは、エンドユーザーの影響を防ぐために瞬時にトリガーできます。 日常的な運用をサポートするために、 <a href="https://docs.microsoft.com/en-us/azure/event-grid/overview" target="_blank">Azure Event Grid</a>の低待機時間テクノロジを活用する通知メカニズムの設計を計画しています。 これにより、単に <a href="https://docs.microsoft.com/en-us/azure/event-grid/system-topics" target="_blank">Event Grid システムのトピック</a>をサブスクライブし、 <a href="https://docs.microsoft.com/en-us/azure/event-grid/event-handlers" target="_blank">イベントハンドラー</a> を使用してスコープを持つイベントを下流のツールに瞬時にルーティングできます。</p>


  <h3>プラットフォーム回復ポリシーの自動化と調整</h3>


  <p>vm の可用性の監視エクスペリエンスを向上させるために継続的に行われている多くの投資を考慮して、Project Flash では、vm の可用性が中断した場合に対応するために、プラットフォームによってトリガーされる復旧ポリシーをカスタマイズするためのヒントを提供することで、さらに優れた機能を提供</p>


  <p>設計中のノブの1つは、予期しない可用性の中断の特定のセットに応じて、単一インスタンスの Vm の <a href="https://azure.microsoft.com/en-us/blog/service-healing-auto-recovery-of-virtual-machines/" target="_blank">サービス復旧</a> をオプトアウトする機能です。 このノブは、ポータルまたは VM のデプロイ時に使用できるようになり、動的に更新できます。 この機能を利用すると、通常の Azure 仮想マシンの可用性 Sla が無効になることに注意してください。</p>


  <p align="left">今後、その他の該当する復旧ポリシー ( <a href="https://azure.microsoft.com/en-us/blog/improving-azure-virtual-machine-resiliency-with-predictive-ml-and-live-migration/" target="_blank">ライブマイグレーション</a> や <a href="https://azure.microsoft.com/en-us/blog/improving-azure-virtual-machines-resiliency-with-project-tardigrade/" target="_blank">tardigrade</a>など) をオプトアウトするためのノブの導入についても説明します。これにより、変化する軽減のニーズに簡単に適応できるようになります。</p>


  <h3>継続的なプラットフォーム品質投資</h3>


  <p>最初のフェーズは、現在の可観測性のニーズを満たすように設計されていますが、VM の可用性に関する世界クラスの可観測性エクスペリエンスを提供する長期的な目標を重視しています。 私たちは、このエクスペリエンスに寄与するすべてのデータ基づく拡張とテクノロジの進歩に非常に満足しています。そのため、ここで &rsquo; は、計画された投資のロードマップの概要について説明します。</p>


  <ol>
      <li><strong>フォールト検出と属性:</strong> Microsoft では、基になるインフラストラクチャを継続的に検出して属性を設定し、エラーを正確かつ瞬時 &mdash; に検出し、問題の発生したエラーの詳細を出力し、プラットフォームの回復のカスタマイズを処理できるようにしています。 これにより、すべてのサイクルの反復処理が継続されます。</li>
      <li><strong>根本原因分析 (RCA) オートメーション:</strong> ここでは、個々の VM のダウンタイムについて簡単な追跡メカニズムを実装することを計画しています。また、詳細なダウンタイム RCA ステートメントの自動構築と出力を使用して、エンドツーエンドで手動の追跡とチャーンを軽減します。</li>
      <li><strong>Aiops 統合:</strong> Microsoft では、Microsoft の <a href="https://azure.microsoft.com/en-us/blog/advancing-azure-service-quality-with-artificial-intelligence-aiops/" target="_blank">AIOps で行われる大きな進歩</a> を活用して、VM の可用性に関するさまざまなデータポイントでスマートな洞察と異常の検出と診断を可能にしています。</li>
      <li>一元化された統合された<strong>ユーザーエクスペリエンス:</strong>この短期的なアプローチの結果として、さまざまなサービスを通じて複数の監視、アラート、回復ツールが用意されており、混乱を招き、さまざまなエクスペリエンスが得られる可能性があります。 これは、最後のフェーズで解決する予定の問題です。 ここでは、エンドユーザーが VM の可用性に関する個別の必要な表現を提供し、 <a href="https://azure.microsoft.com/en-us/services/monitor/" target="_blank">Azure Monitor</a>内に統合し、検出性、使いやすさ、直感的なオンボードの一般的な使用パターンに従って分類することを目標としています。</li>
  </ol>


  <h2>詳細情報</h2>


  <p>このリストは、長期的な戦略の一部として複数の基づく拡張が計画されているため、完全ではありません。 繰り返しますが、Project Flash を使用することは、VM の可用性の監視を非常に直感的で包括的かつシームレス &mdash; にすることです。そのため、ワークロードの正常性の変化について常に準備して通知を受け、最終的には独自の sla とビジネスの約束を維持することができます。</p>


  <p>最新の情報を最新の状態に保つために、次のように Project Flash での更新プログラムを引き続き共有します。 ご期待ください。</p>
