### YamlMime:Yaml
ms.openlocfilehash: 4e48d362e44262c77be9c9c2849606197dacfcaa
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139894199"
Slug: a-comprehensive-tool-for-azure-media-services
Title: データを管理する包括的なAzure Media Services
Summary: 現在、または間もなく GA (一般提供) される予定Azure Media Servicesの主要コンポーネントのほとんどで、著者は包括的な AMS ツールを共有する必要があります。
Content: >-
  Azure Media Services (AMS) でプロフェッショナル グレードのオンライン ビデオ <a href="https://azure.microsoft.com/en-us/services/media-services/">ストリーミング ソリューションを</a>構築する場合、データのフローは非常に異なります。 例としてライブ ストリーミングを使用します。

  <ol>
   <li>1 つ目と最も重要なのは、もちろんビデオ フローです。キャプチャ、フィード長いペット、エンコード、AMS への取り込み、アーカイブ、動的パッケージ化/保護、CDN へのアクセス、最後にクライアント プレーヤーへの到着です。 画面に美しい画像を表示するのは最初の部分で、最も難しい部分ではない可能性があります。 実際に画面に美しい画像を表示するのは "簡単"、"難しい" とは、"美しい画像を表示しない" 方法 (DRM 保護)、およびユーザーが美しい画像以外のものを視聴する方法 (動的に挿入された広告、CC、ゲーム スコアや選手情報などのメタデータ、緊急のお知らせ、気象遅延メッセージなど) です。</li>
   <li>2 つ目は、広告フローです。挿入される広告マーカーから、ストリーミング形式に基づいて広告マーカーを動的にさまざまな SCTE 形式にパッケージ化する方法、プレーヤーによる広告マーカーの解析、広告の決定と広告配信、最後に広告の再生を行います。</li>
   <li>CC フロー: テキスト コンテンツが生成され、投稿フィードに追加され、ビデオ コンテンツを含むパス全体を流れます。</li>
   <li>メタデータ フロー: さまざまなサブシステムで生成される最初のメタデータ。次に、Web ポータルに流れるコンテンツ管理ストレージに追加され、表示やフェールオーバーなどの目的でクライアント プレーヤーに追加されます。 たとえば、資産を AMS に発行し、そのストリーミング URL を生成した後、URL は、自動化された統合された方法で、次の方向にフローする必要がある場合があります。
  <ul>
   <li>URL を CMS データベースにフローする必要があります。このデータベースは、エンド ユーザーの閲覧、検索、再生のために顧客にビデオ ポータルを提供します。</li>
   <li>URL は、メタデータの 1 つの部分として顧客の広告プロバイダーにフローする必要があります。</li>
   <li>URL は、元の問題が発生した場合にプレーヤーがフェールオーバーするためのプライマリ URL やセカンダリ URL など、ビデオ プレーヤー クライアントにメタデータを提供するエンド ポイント (WebAPI サービスなど) にフローする必要があります。</li>
  </ul>

  </li>
   <li>コンテンツ保護フロー: コンテンツ キーの生成、動的コンテンツ保護の設定、認証トークンの発行、DRM ライセンスまたは暗号化解除キーの配信、最後にクライアント プレーヤーでのコンテンツの暗号化解除。</li>
   <li>分析フロー: クライアント プレーヤーからクラウド内のデータ集計まで、他のフローを制御するか、フロントエンドに表示するかの決定まで</li>
   <li>OTT シナリオでさらに重要なアカウント プロビジョニング、課金、エンドユーザー向けポータル、ユーザー認証、承認、EPG (電子プログラミング ガイド)、EMS は含まれていません。</li>
  </ol>

  これらのデータ "フロー" はすべて、(サブシステム間で) 適切な方向に (対象ユーザーのサイズ/需要、ネットワーク帯域幅、クライアント CPU に基づいて) 適切な方向に移動し、適切な時点 (秒またはフレーム精度レベルまで) に到着する必要があります。 そのため、これらの "フロー" を制御し、これらすべての "フロー" を一緒に動作させる "コントローラー" が必要です。 多くの場合、この "コントローラー" を CMS と大別して呼び出します。


  このような CMS をより速く、より良く構築するにはどうすればいいでしょうか。 利用できる機能はありますか?


  ビデオ ソリューションを Azure Media Servicesする場合、次のシナリオが考えられます。

  <ol>
   <li>顧客は、自動化されたワークフローのために既存のシステムと統合された CMS ツールを構築することができます。</li>
   <li>Azure Media Services に基づいてビデオ ソリューションを構築しているお客様をサポートするシステム インテグレーター (SI) では、パッケージ化された SDK またはソフトウェア フレームワークを構築して、そのようなプロジェクトをゼロから開始する必要が生じなくすることができます。 このアプローチでは、市場への時間を高速化し、プロジェクトの配信をより反復可能にし、市場での SI の競争力を高めさせます。</li>
  </ol>

  このような状況では、顧客/SIs に必要な機能は、人間用のスタンドアロン ツールではなく、自動化されたワークフローを備えた完全に統合されたソリューションを構築するためのより迅速な方法である可能性があります。 作成者は、このようなソリューションで使用されているツールセットを共有する必要があります。 コードは、シナリオベースの方法で構造化されています。 このツールセットの値は、ソース コードを使用可能にするための値です。 ソース コードは、サンプル コードとして使用するか、ソリューションで直接使用するか、そのようなソリューションの設計と計画に利用できます。


  ソース コードは、MIT ライセンスの下で Microsoft LCA for OSS リリースによって承認され、GitHub で<a href="https://github.com/MicrosoftDX/AMSOpsTool">確認できます</a>。


  これは包括的なツール セットであり、次のツール セットのすべての主要なAzure Media Services。

  <ol>
   <li>ライブ</li>
   <li>VOD</li>
   <li>ライブから VOD への管理とライブ アーカイブ診断</li>
   <li>PlayReady 保護 (ライブと VOD の両方)</li>
   <li>AES-128 暗号化 (ライブと VOD の両方)</li>
   <li>広告の挿入 (Aventus ライブ エンコーダー用)</li>
  </ol>

  このツールに含まれる機能は、実際のソリューション/使用事例に基づいて作成されます。 このツールは "テスト済み" です。

  <ol>
   <li>このツールは、NBC Sports ソリューションのシナリオをテストするために使用されます。これは、NBC Sports ソリューションのリリース サインオフ テスト プロセスの一環Azure Media Services。</li>
   <li>このツールは、iStreamPlanet CMS ツールの準備が整う前の <a href="https://www.nbcsports.com/">NBC</a> Sports イベント ライブ ストリーミングに使用されています。</li>
   <li>このツールは、NBC Sports と Deltatre の両方で (その診断機能のために) Sochi いびきストリーミングをサポートするために広く使用されています。</li>
   <li>このツールは、 <a href="https://news.microsoft.com/2014/02/06/nbc-olympics-production-of-the-2014-olympic-winter-games-to-utilize-microsoft-for-live-and-on-demand-streaming/">NBC Sports/Sochi のプロジェクト</a>のエンジニアリング プロセス全体で、北米、ヨーロッパ、アジアの 15 ベンダーによって使用される 24 時間 365 日のライブ ストリーミング エンジニアリング環境を運用するために使用されました。</li>
   <li>このツールは、<a href="https://news.microsoft.com/2014/02/06/nbc-olympics-production-of-the-2014-olympic-winter-games-to-utilize-microsoft-for-live-and-on-demand-streaming/">NBC Sports/Sochi Subsystems プロジェクトの VOD</a> サブシステムに対して<a href="https://msdn.microsoft.com/en-us/library/azure/dn673582.aspx">、Azure Media</a> Processors と Processor Media Processor の両方で、すべての VOD トランスコード ワークフロー パフォーマンス テストに使用されました。</li>
   <li>このツールのソース コードの大部分は、<a href="https://news.microsoft.com/2014/02/06/nbc-olympics-production-of-the-2014-olympic-winter-games-to-utilize-microsoft-for-live-and-on-demand-streaming/">NBC Sports/SochiPlanes</a> ソリューションを運用する CMS ツールを開発するために <a href="https://www.istreamplanet.com/">iStreamPlanet</a> と共有されています。</li>
   <li>このツールのソース コードの一部は、Sochi Ofs プロジェクト中にいくつかの重要な機能について <a href="https://www.deltatre.com">Deltatre</a> と共有されています。</li>
   <li>このツールは、エンドツーエンド <a href="https://azure.microsoft.com/blog/2014/11/17/an-end-to-end-prototype-of-playready-protection-with-acs-authentication-and-acs-token-authorization/">の PlayReady</a> 保護プロトタイプとエンドツーエンドの AES 暗号化プロトタイプを作成 <a href="https://azure.microsoft.com/blog/2014/11/26/an-end-to-end-prototype-of-aes-encryption-with-acs-authentication-and-acs-token-authorization/">するためにも使用されています</a>。</li>
  </ol>

  &nbsp;

  <h1>機能のハイライト</h1>

  このツールの範囲と機能を強調するために、このツールの機能のサブセットを一覧にしています。この機能はすべて、 <a href="https://news.microsoft.com/2014/02/06/nbc-olympics-production-of-the-2014-olympic-winter-games-to-utilize-microsoft-for-live-and-on-demand-streaming/">NBC Sports/Sochi 立</a>ち上がりソリューションなどの実際のソリューションで使用されます。これは、NBC Sports が毎日のスポーツ ストリーミングに使用するビジネスライン (LOB) ソリューションです。

  <h2>ACS の冗長性</h2>

  REST または .NET API に関係なく、すべての AMS API 呼び出しには有効な ACS ベアラー トークンが必要であり、この ACS トークンは AMS ACS から取得されます。 当然ながら、重要なライブ イベント中に単一の ACS インスタンスに依存したくはないでしょう。 ライブ イベント中に ACS トークンを取得できない場合は、メディア サービス内のすべてのものにアクセスできません。これは致命的です。 このツールは、複数の AMS ACS インスタンス間での自動フェールオーバーの実装を提供し、"推奨される ACS" を備える "もの" を提供します。 具体的には、このツールの ACS 冗長性機能は、次のライブ実稼働要件を満たしています。 <a href="https://news.microsoft.com/2014/02/06/nbc-olympics-production-of-the-2014-olympic-winter-games-to-utilize-microsoft-for-live-and-on-demand-streaming/">2014 Sochi Olympics</a> ライブ ストリーミングの実行に十分に使用できます。

  <table border="1" width="719" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td valign="top" width="193"><b>要件</b></td>

  <td valign="top" width="524"><b>要件の詳細</b></td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>ACS 自動フェールオーバー</b></td>

  <td valign="top" width="524">現在の ACS で障害が発生した場合に、他の ACS に自動的に切り替え可能である必要があります。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>ACS トークンの再利用</b></td>

  <td valign="top" width="524">Media Services SDK 3.0 の新機能を使用する必要がある: ACS トークンの有効期限が切れていない場合は、CloudMediaContext の作成で再利用します。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>ACS トークンの自動更新</b></td>

  <td valign="top" width="524">ACS トークンの有効期限が切れている場合は、最初に ACS トークンを更新してから、それを使用して CloudMediaContext を作成します。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>複数のコンテキスト インスタンスをサポートする</b></td>

  <td valign="top" width="524">複数のメディア サービスと対話する必要がある場合、アプリケーションは CloudMediaContext の複数のインスタンスと対話できる必要があります。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>SDK 変更の将来を証明する</b></td>

  <td valign="top" width="524">今後の AMS SDK リリースでは、CLOUDMediaContext コンストラクターで ACS トークンを更新できない可能性があります。 コードで ACS トークンの有効期限チェックと ACS トークンの更新を実行する必要があります (ACS トークンの手動更新)。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>ACS の "ベクネス"</b></td>

  <td valign="top" width="524">"優先" ACS インスタンスは、そのインスタンスへのフェールオーバーを待機する代わりに、使用可能な限り使用する必要があります。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>ACS インスタンスのサポート</b></td>

  <td valign="top" width="524">すべての AMS ACS インスタンスをサポートする必要があります。</td>

  </tr>

  <tr>

  <td valign="top" width="193"><b>単一 ACS のサポート</b></td>

  <td valign="top" width="524">SwitchACSEnabled 設定と PreferredACSEnabled 設定を false に設定することで、単一の ACS インスタンスを使用できます。 一部の環境では、1 つの AMS ACS インスタンスのみを使用できます。</td>

  </tr>

  </tbody>

  </table>

  &nbsp;

  <h2>Azure BLOB から AMS 資産への変換</h2>

  多くの場合、物理ビデオ ファイルは Azure Storage に BLOB として保存され、AMS IAsset に変換する必要があります。 このツールは、次のシナリオで変換を提供します。

  <ol>
   <li>BLOB は、使用しているメディア サービスに関連付けられているストレージ内にあります。</li>
   <li>BLOB は、使用しているメディア サービスに関連付けされていないストレージ内にあります。</li>
  </ol>

  &nbsp;

  <h2>データ センター間で一貫性のある URL を作成CDN</h2>

  AMS のライブ プログラムの URL の形式は、https://[origin_name]-[media_service_name].streaming.mediaservices.windows.net/[locator_id]/[manifest_file_name].ism <a href=""></a> です。たとえば、通常、ロケーター ID は生成された GUID です。 冗長性のために 2 つのデータ センターを使用する場合、同じライブ チャネルとプログラムに対して、2 つの URL がホスト名部分でのみ異なり、仮想パスで同じものにする必要があります。 これには、2 つの異なるデータ センターで 2 つの対応するプログラムを作成する場合、ロケーター ID (したがってロケーター パス) がまったく同じで、マニフェスト ファイル名がまったく同じである必要があります。 このツールは、ライブ ストリーミング用のプログラムを作成する際にこの機能を提供します。

  <h4></h4>

  <h2>指定したプログラムでのプログラムのStorage</h2>

  Azure Media Servicesでは、1 つのメディア サービスに複数の Azure ストレージを使用できます。 信頼性を向上するために、メディア サービスは、ライブ アーカイブまたはオンデマンド資産を格納するために、基になる複数の Azure BLOB ストレージを使用する場合があります。 このツールを使用すると、プログラムの作成時に使用するストレージを指定できます。 これにより、複数の同時チャネルで複数の BLOB ストレージにアーカイブ負荷を分散できます。

  <h4></h4>

  <h2>ライブ アーカイブ診断</h2>

  このツールは、通常の操作を提供する以外に、ライブ ストリーミングとライブ アーカイブの診断も提供します。 ライブ ストリーミング中とライブ ストリーミング後のライブ アーカイブの問題をすばやく検出できます。 たとえば、ツールは次の問題を診断して報告できます。

  <ol>
   <li>ライブ アーカイブの "ジャグスタート" と、最初のフラグメントが欠落している品質レベル。 多くの場合、ライブ アーカイブには "ジャグスタート" があります。 WAMS チームによると、これはほとんどバグではありませんが、フラグメントが別の時刻に到着するという事実が原因です。</li>
  </ol>

  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2015/01/26/tool01.jpg"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="tool01" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/tool01_thumb.jpg" alt="tool01" width="767" height="153" border="0" /></a>

  <ol>
   <li>Aventus フィードと Azure インジェストの間のネットワーク遅延: Aventus バッファーからの遅延とバースト。 通常、6秒の GOP を使用する場合、連続した入力 blob の書き込み間隔は6秒の間になります。 2番目の列は、連続した2つの2つの blob の実際の時間差から6秒を引いた値を示しています。</li>
  </ol>

  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2015/01/26/clip_image005.jpg"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="clip_image005" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image005_thumb.jpg" alt="clip_image005" width="761" height="304" border="0" /></a>

  <ol>
   <li>ライブアーカイブに入力 blob がありません。連続した2つの blob 間の開始時間の差は約6秒にする必要があります。 これよりもはるかに大きい場合は、不足している blob があります。</li>
  </ol>

  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2015/01/26/clip_image007.jpg"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="clip_image007" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image007_thumb.jpg" alt="clip_image007" width="758" height="262" border="0" /></a>

  <h4></h4>

  <h2>Content Protection</h2>

  <ol>
   <li>オンデマンドストリーミングの動的 PlayReady 保護</li>
   <li>ライブストリーミングの動的 PlayReady 保護</li>
   <li>ストレージ暗号化を使用しない資産のオンデマンドストリーミング用の動的 AES 暗号化</li>
   <li>ストレージ暗号化を使用した資産のオンデマンドストリーミング用の動的 AES 暗号化</li>
  </ol>

  コンテンツ保護には、ソリューション内の複数のサブシステムが含まれます。動的な保護/暗号化、ライセンス/キーの配信、プレーヤークライアントを認証するための STS、および承認トークンの発行元とプレーヤー。 エンドツーエンドのコンテンツ保護の設計と実装については、 <a href="https://azure.microsoft.com/blog/topics/media-services/">Azure ブログ</a>で公開されている次の2つのブログを参照してください。 Media Services:

  <ol>
   <li><a href="https://azure.microsoft.com/blog/2014/11/26/an-end-to-end-prototype-of-aes-encryption-with-acs-authentication-and-acs-token-authorization/">ACS 認証と ACS トークン認証を使用した AES 暗号化のエンドツーエンドプロトタイプ</a></li>
   <li><a href="https://azure.microsoft.com/blog/2014/11/17/an-end-to-end-prototype-of-playready-protection-with-acs-authentication-and-acs-token-authorization/">ACS 認証と ACS トークン承認による PlayReady 保護のエンドツーエンドプロトタイプ</a></li>
  </ol>

  SWT に加えて、2つのエンドツーエンドのプロトタイプ/設計が JWT トークン認証にアップグレードされていることに注意してください。

  <h3></h3>

  <h1>制限事項</h1>

  このツールには制限があります。 主な制限は、ユーザーにわかりやすい UI がないことです。 このツールは Windows コンソールの種類 Visual Studio プロジェクト (ライブ用に1つ、オンデマンド用に1つ、または ad マーカーの挿入用) であり、カラーコードされた UI 用のカラーコンソールカスタムクラスを備えています。 このツールを使用する最も便利な方法は、"ユーザーインターフェイスとして Visual Studio を使用する" (入力パラメーターを変更し、コンパイルして実行する) ことです。 もちろん、この場合、ユーザーは C# の基本的な構文を理解する必要があります。 理想的な UI は、次のようにサポートされる web UI です。

  <ul>
   <li>Azure Active Directory によって提供される認証</li>
   <li>複数の顧客が独自の media services に対して使用できるようにするマルチテナント。</li>
   <li>ユーザーがインストール/セットアップを行う必要がないように、Azure で SaaS としてホストされています</li>
  </ul>

  この日はそれほど大きくありません。


  <b>確認:</b>特別な確認は、長年にわたるヘルプと洞察を得るために、Azure Media Services チームの多くのメンバーに送信されます。
