### YamlMime:Yaml
ms.openlocfilehash: c327565ea05846baca0fb4d1dea679f43fc0de40
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139903500"
Slug: managing-connections-in-powerpivot
Title: PowerPivot での接続の管理
Summary: '[この記事は SQL Azure チームによって提供されました。]ビジネスインテリジェンスを使用してデータベースを分析することで、仕事の大部分がデータを認識していることがわかりました。'
Content: '<p>[この記事は SQL Azure チームによって提供されました。]</p><p>ビジネスインテリジェンスを使用してデータベースを分析することで、仕事の大部分がデータを認識していることがわかりました。 PowerPivot を使用すると、テーブルを追加して複数のデータソースをまとめることが非常に簡単になります。これにより、レポートの作成時にデータを検出できます。 この記事では、PowerPivot から SQL Azure への接続を管理する方法、テーブルを追加する方法、およびリレーションシップを作成する方法について説明します。</p>  <p>最初の接続 (ここではここで記録したもの) を作成した後、テーブルを追加し、内部データベースのリレーションシップを管理し、他のデータソースを取り込む必要があります。 その理由の1つは、データを PowerPivot レポートに関連付けると、そのレポートの別のバリエーションを生成して、追加のルックアップテーブルまたはリレーションシップが必要になることです。</p>  <p>ビジネスインテリジェンスの大部分は、2つの異なるデータポイントを取得し、データに新しい洞察をもたらすような方法で関連しています。 通常、これらのデータポイントはテーブルおよびリレーションシップのネットワークを介して内部的に関連付けられており、PowerPivot にする必要があります。これにより、テーブル選択ダイアログが正しく表示されるまでに、いくつかの処理が行われる場合があります。 このダイアログに再度アクセスできることは、PowerPivot で成功するために重要です。</p>  <h2>接続の検索</h2>  <p>接続の作成方法については、前のブログ記事に従ってください。サーバー名、ログイン情報、パスワードを入力すると、接続にフレンドリ名を付けることもできます。 各接続の Excel ブックには一意の表示名が必要です。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image001" border="0" alt="clip_image001" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4812.clip_5F00_image001_5F00_thumb_5F00_3C0F0B7A.png" width="551" height="212"></a></p>  <p>テーブルを選択し、Excel のブックにインポートした後は、この接続にもう一度アクセスして、さらに多くのテーブルをダウンロードできます。 同じ接続をもう一度使用して同じデータベースにアクセスすることは、新しい接続を作成して構築するよりもはるかに優れた方法であり、ブック内のリソースを節約し、テーブル間のリレーションシップを PowerPivot することができます。</p>  <p>既存の接続へのアクセスを検索するには、[PowerPivot] ウィンドウを開きます。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image002" border="0" alt="clip_image002" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4571.clip_5F00_image002_5F00_thumb_5F00_0DB585CD.png" width="628" height="292"></a></p>  <p>PowerPivot ウィンドウが表示されたら、<b>デザイン</b>と呼ばれる2番目のリボンバーを選択し、[<b>既存の接続</b>] ボタンを探します。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image003" border="0" alt="clip_image003" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1362.clip_5F00_image003_5F00_thumb_5F00_543275D5.png" width="629" height="259"></a></p>  <p>[<b>既存の接続</b>] ダイアログが表示されます。下のスクリーンショットでは、adventure works というわかりやすい名前を使用して、SQL Azure 上の adventure works データベースへの接続を確認できます。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image004" border="0" alt="clip_image004" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7536.clip_5F00_image004_5F00_thumb_5F00_6CC21325.png" width="552" height="562"></a></p>  <p>接続をダブルクリックすると、その接続が開き、ダウンロードするテーブルをさらに選択できるようになります。</p>  <h4>リレーションシップの作成</h4>  <p>テーブルをインポートしたら、ピボットテーブルを作成できます。 これを行うには、[PowerPivot] ウィンドウを閉じて、Excel ブックに戻ります。 PowerPivot リボンで、[ピボットテーブル] ボタンと [ピボットテーブル] を選択します。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image005" border="0" alt="clip_image005" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4503.clip_5F00_image005_5F00_thumb_5F00_4C3AD373.png" width="636" height="337"></a></p>  <p>[PivotTable モーダルの作成] ダイアログボックスが表示されます。ここで、新しいワークシートを選択します。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image006" border="0" alt="clip_image006" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7723.clip_5F00_image006_5F00_thumb_5F00_729CB6BE.png" width="415" height="185"></a></p>  <p>新しいワークシートが埋め込みピボットテーブルで作成され、非常に便利な PowerPivot フィールドの一覧] ウィンドウが右側にドッキングされます。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image007" border="0" alt="clip_image007" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8231.clip_5F00_image007_5F00_thumb_5F00_24282454.png" width="700" height="654"></a></p>  <p>Adventure Works データベースを使用しているので、売上高を製品カテゴリと比較して、どのカテゴリが最適に販売されるかを確認したいと思います。 まず、 <b>Productcategory</b>テーブルから<b>Name</b>列を選択します。 次に、 <b>Salesheader</b>テーブルから<b>SubTotal</b>列を選択します。 2つの列が異なるテーブルにあるため、PowerPivot では、2つのデータポイントを関連付ける方法を判断する必要があります。 リレーションシップを使用しない場合 PowerPivot は、カテゴリを考慮せずに、小計の合計のすべての行を結合します (以下のスクリーンショットをご覧ください)。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image009" border="0" alt="clip_image009" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1768.clip_5F00_image009_5F00_thumb_5F00_57F01AA5.jpg" width="644" height="601"></a></p>  <p>ドッキングされた PowerPivot フィールドリストウィンドウには、"リレーションシップが必要な可能性があります" という警告メッセージが表示されます。 [作成] ボタンをクリックすると、SQL Azure から外部キーのリレーションシップが取得され、テーブルのダウンロードがブックに照合されます。 上記の例では、小計が個々のカテゴリに分割されます。</p>  <p>場合によっては、PowerPivot がテーブル間のリレーションシップを正しく検出できないことがあります。複雑なスキーマでは、それらを解析できないことがあります。 この場合、[PowerPivot] ウィンドウを使用して手動でリレーションシップを追加できます。 以下に、その方法を示します。</p>  <ol>   <li>1)<b>PowerPivot</b>のリボンバーで、[ <b>PowerPivot ウィンドウ</b>] を選択します。 </li>    <li>2)<b>デザイン</b>と呼ばれる2番目のリボンバーで、[<b>リレーションシップの管理</b>] を選択します。       <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image010" border="0" alt="clip_image010" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6175.clip_5F00_image010_5F00_thumb_5F00_3768DAF3.png" width="604" height="246"></a></p>   </li>    <li>3) これにより、[リレーションシップの管理] ダイアログボックスが表示されます。 ここでは、検出されなかったリレーションシップを作成および削除できます。      <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image011" border="0" alt="clip_image011" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1781.clip_5F00_image011_5F00_thumb_5F00_0183E5D9.png" width="553" height="371"></a></p>   </li> </ol>  <h2>まとめ</h2>  <p>で正常に動作するには、データに関する既知の情報を取得し、それを使用して適切なテーブルをインポートし、レポート用のピボットテーブルを生成するために必要なリレーションシップを確立 PowerPivot ます。 </p>  <p>質問、懸念事項、コメントがありますか。 これらを下に投稿してください。</p>'
