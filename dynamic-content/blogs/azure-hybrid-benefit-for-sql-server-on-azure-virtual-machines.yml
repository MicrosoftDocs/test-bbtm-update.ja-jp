### YamlMime:Yaml
ms.openlocfilehash: 33bdfeabef9fcec9ca8fe9a350d826a31c19f484
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139889970"
Slug: azure-hybrid-benefit-for-sql-server-on-azure-virtual-machines
Title: Azure ハイブリッド特典 Azure SQL Server のVirtual Machines
Summary: Azure ハイブリッド特典 (AHB) for SQL Serverを使用すると、オンプレミスの SQL Server ライセンスを使用して、Azure SQL Server でVirtual Machines。
Content: >-
  <p><em>この投稿は、最新の例を</em>最近公開した Azure Azure PowerShell VM CLI に置き換<a href="https://docs.microsoft.com/en-us/cli/azure/sql/vm?view=azure-cli-latest" target="_blank">SQLされています。</a></p>


  <p><a href="https://azure.microsoft.com/en-us/pricing/hybrid-benefit/" target="_blank">Azure ハイブリッド特典</a> (AHB) for SQL Serverを使用すると、オンプレミスのライセンスを使用して <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-iaas-overview" target="_blank">Azure SQL Serverを実行Virtual Machines</a>。 ソフトウェア アシュアランス を使用している場合は、新しい SQL VM をデプロイするときに AHB を使用するか、既存の SQL VM に対して SQL Server AHB をアクティブ化し、支払い (PAYG) ライセンスを使用できます。 Azure Marketplace 上のイメージのライセンス持ち込<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance#bring-your-own-license-byol" target="_blank">み (BYOL SQL)</a> を使用して、SQL Server VM をデプロイするときに SQL Server AHB を実装SQLがあります。 ただし、PAYG ライセンスを持つ SQL VM が既にある場合、AHB をアクティブ化するには、現在、BYOL イメージを使用して VM を再デプロイSQLがあります。</p>


  <p>現在、Azure VM リソース プロバイダーを使用して Azure VM SQL Server AHB をアクティブ化する新しい簡単<a href="https://azure.microsoft.com/en-us/blog/sql-server-on-azure-virtual-machine-resource-provider/" target="_blank">なSQLを明らかにしています</a>。 SQL VM リソース プロバイダーは、新しい Azure リソース プロバイダー<strong>である Microsoft です。SqlVirtualMachine</strong>。Azure VM SQL Server構成を、Azure VM を通じてデプロイおよび管理できるリソースとして提供Azure Resource Manager。 この新しいインフラストラクチャにより、ライセンスの種類などの SQL Server設定の動的更新を含む、Azure VM SQL Serverバックエンド管理サービスが提供されます。 既存の PAYG SQL Server VM に対して AHB をアクティブSQL、Microsoft を作成<strong>します。VM&#39;</strong> のリソース ID を指定し、<strong>SqlServerLicenseType</strong> &ldquo; を <strong>AHUB</strong> として設定することで、既存の VM の SqlVirtualMachine/SqlVirtualMachine 型リソース。&rdquo;</p>


  <p>まず、サブスクリプションを Microsoft に登録する <strong>必要があります。SqlVirtualMachine</strong> プロバイダーは、次の Azure CLI コマンドを実行するか、Azure Portal を使用して登録して <strong>SqlVirtualMachine</strong> 型のリソースを作成します。</p>


  <pre>

  // Register subscription with SQL VM RP


  az provider register --namespace Microsoft.SqlVirtualMachine --subscription &lt;subscription name&gt;</pre>


  <p>次に<a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-windows?view=azure-cli-latest" target="_blank">、MSI パッケージをダウンロードAzure CLI</a>して、AZURE VM <a href="https://docs.microsoft.com/en-us/cli/azure/sql/vm?view=azure-cli-latest" target="_blank">CLI にアクセスSQL更新します</a>。</p>


  <p>既存の <a href="https://docs.microsoft.com/en-us/cli/azure/sql/vm?view=azure-cli-latest#az-sql-vm-create" target="_blank">PAYG SQL VM</a> に対して AHB をアクティブ化する Azure SQL CLI コマンドを次に示します。</p>


  <pre>

  // Create an AHUB SqlVm

  az sql vm create -n &lt;VM Name&gt; -g &lt;Resource Group Name&gt; -l &lt;Location&gt; --license-type AHUB

  EX: az sql vm create -n sqlvm -g myresourcegroup -l eastus --license-type AHUB</pre>


  <p><strong>SqlVirtualMachine</strong> リソースの作成時に <strong>SqlServerLicenseType</strong> プロパティを設定していない場合、<strong>SqlServerLicenseType</strong> &ldquo; は既定で <strong>PAYG</strong>&rdquo; として設定されます。 次の <a href="https://docs.microsoft.com/en-us/cli/azure/sql/vm?view=azure-cli-latest#az-sql-vm-update" target="_blank">Azure SQL VM Update CLI</a> コマンドを使用して ソフトウェア アシュアランス を使用している場合は、いつでも <strong>SqlServerLicenseType</strong> &ldquo;プロパティを AHUB&rdquo; として更新して SQL Server AHB をアクティブ化できます。</p>


  <pre>

  // Update SqlVirtualMachine SqlServerLicenseType property

  az sql vm update -n &lt;VM Name&gt; -g &lt;Resource Group Name&gt; --license-type AHUB

  EX: az sql vm update -n sqlvm -g myresourcegroup --license-type AHUB</pre>


  <p>最近 Azure Portal を使用して SQL VM を作成した場合、または Azure Portal を使用して既存の SQL VM の SQL 構成を更新した場合、SQL VM は SQL VM RP に既に登録されています。 この場合は、Azure SQL VM Update CLI コマンドのみを実行して、PAYG から AHUB にライセンスの種類を更新する必要があります。 元の VM が <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance#byol" target="_blank">Azure Marketplace の PAYG SQL Server</a> イメージから作成された場合は、ライセンスの種類を AHUB に更新し、いつでも制限なく PAYG に戻することができます。 元の VM が PAYG SQL Server イメージから作成されていないが、SQL Server が BYOL SQL Server イメージから自己インストールまたはデプロイされた場合、ライセンスの種類を PAYG に変換することはできません。</p>


  <h2>ダウンタイムなし</h2>


  <p>新 <strong>しい SqlVirtualMachine</strong> リソースは、既存の VM リソースへのリンクです。これは、既存の VM リソースに影響を与える影響はありません。 <strong>SqlVirtualMachine</strong> リソースは、IaaS 拡張機能のプロパティからSQL Server設定に関するメタデータをSQL管理します。 VM が削除された場合、リンクされた <strong>SqlVirtualMachine</strong> リソースも非同期的に削除されます。 <strong>SQLVirtualMachine</strong> リソースは、VM リソースを保持することで、個別に削除できます。 ただし、SQL Serverの変更は、この場合は元の状態に戻ります。</p>


  <h2>VM の再起動なし</h2>


  <p>PAYG SQL Server VM の AHB をアクティブSQL VM は再起動しないし、既存のリソースに影響を与えるのではありません。 VM リソースの請求を定義SQL Server種類のライセンスを表すメタデータのみを更新します。</p>


  <h2>追加コストはありません。</h2>


  <p><strong>SqlVirtualMachine</strong> リソースは、自動バックアップ、修正プログラムの適用、Azure Key Vault 統合とストレージの構成、新しい <strong>SqlServerLicenseType</strong>&rdquo; など、現在使用可能なすべての既存の SQL Server &ldquo; 構成を管理します。追加のリソースと管理の強化には、追加コストはありません。</p>


  <h2>すぐに有効</h2>


  <p>Azure リソースの課金は、各リソースの 1 秒あたりのコストと 1 時間の使用秒を乗算することで生成されます。 ライセンスSQL Serverは、ライセンスの種類が AHUB として更新された直後に、VM &ldquo; リソースのSQL Serverから<strong>削除されます</strong>。&rdquo;毎日の Azure 請求書の変更を確認できます。 AHB SQL Server非アクティブ化するには、[ライセンスの種類] を [PAYG] に設定してSQL Server同じ更新コマンドを<strong>実行します</strong>。 新しいコマンドが実行SQL Server、1 秒あたりのライセンス コストが VM の請求に追加されます。</p>


  <h2>すべてのサブスクリプションの種類に対する 1 つのソリューション</h2>


  <p>サブスクリプションの種類ソフトウェア アシュアランスにSQL Server AHB 権限を持っているお客様。 BYOL SQL イメージに基づいて Azure VM 上で SQL Server AHB をアクティブ化する以前のソリューションは EA のお客様のみ利用できますが、上記の新しいソリューションは、ソフトウェア アシュアランス のすべてのサブスクリプションに適用されます。</p>


  <p>新しい <strong>Microsoft を使用します。SqlVirtualMachine</strong> リソース プロバイダーを使用すると、Azure VM SQLサーバー構成を動的に管理できます。 フレキシブル SQL Server ライセンスの種類の構成は、SQL VM リソース プロバイダーで提供される最初の機能であり、SQL VM のコストを大幅に削減できます。</p>
