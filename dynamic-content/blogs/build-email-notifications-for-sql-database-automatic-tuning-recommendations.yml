### YamlMime:Yaml
ms.openlocfilehash: ac85f817c162c7b1c2cb46219f7ab315f769853f
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139896858"
Slug: build-email-notifications-for-sql-database-automatic-tuning-recommendations
Title: 自動チューニングに関する推奨 SQL Database の電子メール通知を作成する
Summary: このブログ投稿をお読みになると、SQL Database 自動チューニングの推奨事項に対して独自のカスタム電子メール通知を作成できるようになります。 この機能を要求し、Azure ですぐに利用できるテクノロジに基づいてカスタムソリューションを作成したお客様を対象としています。
Content: >-
  <p>このブログ投稿をお読みになると、SQL Database 自動チューニングの推奨事項に対して独自のカスタム電子メール通知を作成できるようになります。 この機能を要求し、Azure ですぐに利用できるテクノロジに基づいてカスタムソリューションを作成したお客様を対象としています。</p>


  <p>SQL Database パフォーマンスチューニングの推奨事項は Azure SQL Database<a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-automatic-tuning" target="_blank">自動チューニング</a>によって生成されます。 このソリューションは、人工知能 (AI) を使用した継続的なデータベースパフォーマンスチューニングによって、パフォーマンスと安定したワークロードを実現します。</p>


  <p>チューニングに関する推奨事項は、自動チューニングが有効になっている Azure サブスクリプションの個々の SQL データベースごとに提供されます。 推奨事項は、インデックスの作成、インデックスの削除、およびクエリ実行プランの最適化に関連しています。 チューニングに関する推奨事項は、AI がデータベースのパフォーマンスにとって有益であると判断した場合にのみ提供されます。</p>


  <h2>自動チューニングの電子メール通知</h2>


  <p>一部のお客様は、自動化されたアラートを表示して構築するための提案 SQL Database 自動チューニングの推奨事項で自動電子メール通知を受信する必要があることを示しています。 たとえば、データベースのパフォーマンスを向上させるためにインデックスを削除するようにソリューションで推奨されている場合、一部のお客様はこのようなイベントを通知することをお勧めします。 もう1つの顧客シナリオは、たとえば、さまざまなデータベース管理者に対して自動チューニングの推奨設定を電子メールで送信しています。</p>


  <p><strong>自動的な電子メール通知を作成して自動チューニングの推奨事項を受け取るに</strong>は、詳細な手順に従って、<a href="https://docs.microsoft.com/azure/sql-database/sql-database-automatic-tuning-email-notifications" target="_blank"><strong>カスタム SQL Database 自動チューニング電子メール通知の作成方法</strong></a>に関する記事をご覧ください<strong>。</strong></p>


  <p>考案されたソリューションは、 <a href="https://docs.microsoft.com/en-us/azure/automation/automation-intro" target="_blank">Azure Automation</a>を使用したチューニング推奨設定の取得、および Microsoft Flow を使用した電子メール配信ジョブのスケジュール設定の自動化によって、PowerShell スクリプトの実行を自動化することで構成されます。</p>


  <p>Azure Automation を使用すると、さまざまな方法で使用できる Azure でスクリプトをスケジュールできます。 この例では、Azure サブスクリプションの SQL データベースからの自動チューニングに関する推奨事項の取得をスケジュールするために使用されます。</p>


  <p>次に示すのは、自動 PowerShell スクリプトを実行して、Azure Automation を使用して自動チューニングの推奨設定を取得 SQL Database のスクリーンショットです。 オートメーションを使用すると、スクリプトの入力、出力、ログファイル、エラー、警告を画面に表示して監視やトラブルシューティングを行うことができます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/db53d235-e592-4d02-b44e-dcebc367eb0c.png"><img alt="howto-email-04" border="0" height="510" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/96a1ce39-bea7-42da-8ed0-cbbfdf5dc3b7.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="howto-email-04" width="930"></a></p>


  <p><a href="https://docs.microsoft.com/en-us/flow/getting-started" target="_blank">Microsoft Flow</a>は、Office 365 統合を使用して、取得したデータベースのチューニングに関する推奨設定を転送するための電子メール配信ジョブをスケジュールおよび自動化するための、すぐに使用できるソリューションとして使用されます。 自動スケジュールは、必要に応じて、1分、1時間、1日、1週間おきに実行するように設定できます。</p>


  <p><strong>提供されている PowerShell スクリプトと Microsoft Flow ワークフローをさらにカスタマイズすることで、ソリューションをカスタマイズして、さまざまなユーザーやさまざまな SQL データベースのチューニングに関する推奨設定を自動的に電子メールで送信することができます。</strong></p>


  <p>Microsoft Flow は、自動化されたジョブの実行に関する画面上の統計情報を提供します。つまり、送信された電子メール通知の成功を示します。以下のスクリーンショットのソリューションの例を参照してください。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e29c54a4-e6f3-4e80-8327-f8f63b16a6db.png"><img alt="howto-email-06" border="0" height="540" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b940adb5-2b28-4759-9259-84538eb0b5b5.png" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" title="howto-電子メール-06" width="930"></a></p>


  <p>Microsoft Flow analytics は、automation フローのトラブルシューティングだけでなく、監視にも役立ちます。 トラブルシューティングを行う場合は、Azure Automation アプリからアクセスできる PowerShell スクリプト実行ログを調べることもできます。</p>


  <p>自動電子メール通知の最終的な出力は、このソリューションをビルドして実行した後に受信した次の電子メールのようになります。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/42d1d57d-449f-4845-adb9-77da6120bf32.png"><img alt="howto-email-07" border="0" height="887" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/efa8fa91-44a3-4b6d-8ae3-23ece788f5e5.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="howto-電子メール-07" width="930"></a></p>


  <p>提供されているサンプル PowerShell スクリプトをさらにカスタマイズすることにより、必要に応じて自動電子メールの出力と書式設定を調整できます。</p>


  <p>お客様に提供されているソリューションは、さらに構築して独自のシナリオに合わせてカスタマイズできる出発点となります。 考えられるカスタムシナリオとしては、受信したチューニング推奨設定の種類に基づいた通知の作成、複数の受信者への電子メールの送信、またはデータベース所有者の変更などがあります。</p>


  <h2>まとめ</h2>


  <p>提供されたソリューションを使用すると、Azure SQL Database 自動チューニングの推奨事項に対する電子メール通知の送信を自動化できます。 このソリューションでは、PowerShell スクリプトを使用してチューニング推奨設定を取得し、それを実行する Azure Automation します。 PowerShell スクリプトからの出力を使用して、定期的な電子メール配信ジョブを自動化するフローは Microsoft Flow を使用して構築されました。</p>


  <p>さらに、カスタムシナリオに応じて、特定のチューニングイベント、複数の受信者、複数のサブスクリプション、またはデータベースに基づいた電子メール通知を作成するようにソリューションをカスタマイズすることもできます。</p>


  <p>プログラミングに注目している場合は、 <a href="https://docs.microsoft.com/en-us/rest/api/sql/databaserecommendedactions/listbydatabaseadvisor" target="_blank">REST API</a>の呼び出しを通じて、または<a href="https://docs.microsoft.com/en-us/powershell/module/azurerm.sql/get-azurermsqldatabaserecommendedaction?view=azurermps-5.1.1" target="_blank">PowerShell</a>コマンドと共に<a href="https://azure.microsoft.com/en-us/blog/automatic-tuning-introduces-automatic-plan-correction-and-t-sql-management/" target="_blank">t-sql SQL</a>を使用して、SQL Database から自動チューニングの推奨事項を取得する別の方法もあります。</p>


  <p>このソリューションの使用方法と、必要に応じてカスタマイズする方法の例をご連絡ください。 コメントには、フィードバックや質問を残してください。</p>
