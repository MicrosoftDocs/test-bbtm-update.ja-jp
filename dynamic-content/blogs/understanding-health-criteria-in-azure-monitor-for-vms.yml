### YamlMime:Yaml
ms.openlocfilehash: e7eb0868d386e9359bba0cdd6aef7b131662dedf
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139896995"
Slug: understanding-health-criteria-in-azure-monitor-for-vms
Title: 正常性基準のAzure Monitor for VMs
Summary: 仮想マシン (VM) 用の Azure Monitor には、さまざまな観点から VM を表示するのに役立つ VM を監視するためのさまざまな機能が用意されています。
Content: "<p>Azure Monitor (VM) の場合、さまざまな観点から VM を表示するのに役立つさまざまな監視機能が提供されます。 これらのパースペクティブの一部を次に示します。</p>\n\n<ol>\n <li><strong>VM とそのコンポーネントの正常性。</strong> これは、オペレーティング システム、コア コンポーネント、およびドメイン ネーム システム (DNS)、動的ホスト構成プロトコル (DHCP) などのサービスの問題を監視、診断、およびローカライズするのに役立ちます。 また、VM 上の CPU、メモリ、ディスク、およびネットワーク アダプターに関するパフォーマンスの問題も特定します。</li>\n <li><strong>パフォーマンスの傾向。</strong> これらの傾向は、CPU、メモリ、ディスク、およびネットワーク アダプターのパフォーマンス メトリックの時間の推移を示しています。</li>\n <li><strong>マップ - 接続トポロジとメトリック。</strong> これにより、VM 上で実行されているプロセスと、VM 間の相互作用、および重要なイベントとアラートを示すビジュアル マップが提供されます。</li>\n</ol>\n\n<p>Azure Monitor for VMsは、VM の正常性基準と呼ばれるさまざまな条件セットをほぼリアルタイムで評価し、正常性基準が重大/警告状態になった場合にアラートをトリガーします (アラートは既定でオンになっていますが、動作を変更できます)。 たとえば、CPU 使用率の正常性基準 &ldquo;が重大な状態の場合、CPU 使用率が高すぎるというアラートが&rdquo; 発生します。 正常性アラートは、ポータルの [アラート] ピボットで Azure Monitor他のアラートを管理するのと同じ方法で管理できます。</p>\n\n<p>各正常性基準に対するアラートの作成について心配する必要がなくなりました。 各条件の完全な一&quot;覧については、「Azure 仮想マシンの正常性を理解する(プレビュー)」を参照Azure Monitor for VMs<a href=\"https://docs.microsoft.com/en-us/azure/monitoring/monitoring-vminsights-health?toc=/azure/azure-monitor/toc.json\" target=\"_blank\">してください。</a>&quot;</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4b32f7ef-9301-4d2f-b80f-4054b7b4cc87.png\"><img alt=\"Available Megabytes of Memory\" border=\"0\" height=\"257\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/980a5359-8fc7-4a18-b407-90338ec453cb.png\" style=\"margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;\" title=\"使用可能なメモリのメガバイト数\" width=\"640\"></a></p>\n\n<p>正常性基準がアラートを発生した場合と発生しない場合は、VM エクスペリエンスごとの正常性基準のリンクをクリックして、その構成を表示します。</p>\n\n<h2>API の活用</h2>\n\n<p>VM の正常性Azure portalほとんどのタスクには Azure portal を使用できます。一方、API を介してしかアクセスできない特定のプロパティと構成があります。 さらに、API を使用して、一部のタスクを自動化することもできます。 では&rsquo;、API のツアーを行い、特定のシナリオでそれらを活用する方法を確認します。</p>\n\n<p>1. 特定の VM に適用またはアクティブな正常性基準を特定し、他の API 関連の操作に必要な ID を取得するには、次に示すコマンド プロンプトで ARM クライアントを利用する次の GET API の例を使用します。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b90cfc1e-f829-419b-8fb5-4492dff03039.png\"><img alt=\"GET API example leveraging ARM client on command\" border=\"0\" height=\"586\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ed3fd451-7947-457e-a2ea-269468f0c73e.png\" style=\"margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;\" title=\"コマンドで ARM クライアントを利用する GET API の例\" width=\"1066\"></a></p>\n\n<pre>\n&quot;subscriptions/<strong>Subscription_Name</strong>/resourceGroups/<strong>Resource_Group_Name</strong>/providers/Microsoft.Compute/virtualMachines/<strong>VM_Name</strong>/providers/Microsoft.WorkloadMonitor/monitors?api-version=2018-08-31-preview&rdquo;</pre>\n\n<p>2. 正常性状態の更新は、頻度とルックバック期間 <strong>という 2 つの</strong> 追加パラメーター <strong>によって管理</strong> されます。 Frequency は正常性基準が実行される速度であり、ルックバックは基準が評価される期間です。 たとえば、正常性基準が条件を評価している場合、CPU 使用率は 95% を超え、頻度は 5 分、ルックバック期間は 15 分です。 つまり、CPU 使用率が 95% を超えるかどうかの条件は 5 分ごとに評価されますが、15 分間 (3&rsquo; 回連続する評価サイクル) で 95% を超えたままである場合は、状態が重大に更新されます (まだない場合)。</p>\n\n<p>現在、頻度とルックバック期間は UI では公開されません。 ただし、API を使用してこれらの値を取得できます。 コマンド プロンプトで ARM クライアントを利用する例を次に示します。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ce2ba1f8-4177-49d2-963c-651a71532fe0.png\"><img alt=\"An example leveraging ARM client on command\" border=\"0\" height=\"484\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/af67fdbf-63b4-4e7d-9217-dd52d2e3fee3.png\" style=\"margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;\" title=\"コマンドで ARM クライアントを利用する例\" width=\"1186\"></a></p>\n\n<pre>\n&quot;subscriptions/<strong>Subscription_Name</strong>/resourceGroups/Resource_Group_Name/providers/Microsoft.Compute/virtualMachines/VM_Name/providers/Microsoft.WorkloadMonitor/monitors/Monitor_ID?api-version=2018-08-31-preview&rdquo;</pre>\n\n<p><em>注: 頻度とルックバック期間の変更は、現在&rsquo;利用できません。 </em></p>\n\n<p>3. 正常性基準に対するアラートの有効化または無効化。 たとえば、正常性条件でアラートが有効になっている場合に無効にする場合は、次の式を使用できます。</p>\n\n<pre>\narmclient patch \n\n&ldquo;subscriptions/<strong>Subscription_Name</strong>/resourceGroups/<strong>Resource_Group_Name</strong>/providers/Microsoft.Compute/virtualMachines/<strong>VM_Name</strong>/providers/Microsoft.WorkloadMonitor/monitors/Monitor_ID?api-version=2018-08-31-preview 1-preview &quot;{&#39;properties&#39;:{&#39;alertGeneration&#39;:&rsquo;Disabled&rsquo; }}&quot;</pre>\n\n<p>4. 正常性基準のしきい値の更新。</p>\n\n<pre>\narmclient patch\n\nsubscriptions/<strong>Subscription_Name</strong>/resourceGroups/<strong>Resource_Group_Name</strong>/providers/Microsoft.Compute/virtualMachines/<strong>VM_Name</strong>/providers/Microsoft.WorkloadMonitor/monitors/<strong>Monitor_ID</strong>?api-version=2018-08-31-preview 1-preview &quot;{&#39;properties&#39;:{&#39;Threshold&#39;:<strong>&rsquo;Desired_Value&rsquo;</strong> }}&quot;</pre>\n\n<p>必要な編集を行った後は、ポイント No で強調表示されている GET API を使用できます。 上記の 2: 構成が更新されたかどうかを確認します。 ポータルから検証することもできます。</p>\n\n<p>5.アクション グループを VM の正常性基準に関連&rsquo;<strong>付</strong>けするには。</p>\n\n<p>というタイトルのファイルを<strong>file_name</strong>&rdquo;&ldquo;拡張子を .json に&ldquo;更新します&rdquo;。</p>\n\n<p>その内容は次のように表示されます。</p>\n\n<pre>\n{\n   properties: {\n     &quot;ActionGroupResourceIds&quot;: [\n       &quot;/subscriptions/a7f23fdb-e626-4f95-89aa-3a360a90861e/resourceGroups/default-activitylogalerts/providers/microsoft.insights/actionGroups/SampleAG2&quot;\n     ]\n   }\n}</pre>\n\n<p>次の PUT API を使用して、アクション グループを VM に関連付けます (仮想マシンによってトリガーされる正常性アラートAzure Monitor for VMs。</p>\n\n<pre>\narmclient PUT\nhttps://eastus2euap.management.azure.com/subscriptions/a7f23fdb-e626-4f95-89aa-3a360a90861e/resourceGroups/AzharRG/providers/Microsoft.Compute/virtualMachines/mdavm/providers/Microsoft.WorkloadMonitor/notificationSettings/default?api-version=2018-08-31-preview&quot;  @<strong>file_name</strong>.json (JSON Script)</pre>\n\n<p>設定が正しく更新されたかどうかを確認するには、次の GET API を使用します。</p>\n\n<pre>\narmclient GET\n\n&quot;subscriptions/<strong>Subscription_Name</strong>/resourceGroups/<strong>Resource_Group_Name</strong>/providers/Microsoft.Compute/virtualMachines/<strong>VM_Name</strong>/providers/Microsoft.WorkloadMonitor/notificationSettings?api-version=2018-08-31-preview&quot;</pre>\n\n<p>API サーフェスをさらに詳しくは、api のページで公開されている swagger <a href=\"https://apac01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Frest%2Fapi%2Fmonitor%2Fmicrosoft.workloadmonitor%2Fcomponents&amp;data=02%7C01%7C%7C65d0c096562c40bc271f08d676d13e19%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636827038382032496&amp;sdata=JhfrAqPZ7Bn4fJqM8jnIyZJ5LCSChE9BKAoHchrKI1g%3D&amp;reserved=0\" target=\"_blank\">をGitHub</a>。</p>"
