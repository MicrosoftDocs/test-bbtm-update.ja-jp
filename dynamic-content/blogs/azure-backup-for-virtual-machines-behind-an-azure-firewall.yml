### YamlMime:Yaml
ms.openlocfilehash: acf2c594d0972cf36e51ce41173ca792edb20ca1
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139890575"
Slug: azure-backup-for-virtual-machines-behind-an-azure-firewall
Title: Azure Firewall の背後にある仮想マシンの Azure Backup
Summary: このブログ投稿では、主に Microsoft Azure ファイアウォールと Azure Backup を利用してデータを包括的に保護する方法について説明します。 前者はネットワークを保護し、後者はデータをクラウドにバックアップします。
Content: >-
  <p>このブログ投稿では、主に <a href="https://docs.microsoft.com/en-us/azure/firewall/overview" target="_blank">Azure Firewall</a> と <a href="https://docs.microsoft.com/en-us/azure/backup/backup-introduction-to-azure-backup" target="_blank">Azure Backup</a> を活用してデータを包括的に保護する方法について説明します。 前者はネットワークを保護し、後者はデータをクラウドにバックアップします。 現在一般公開されている<a href="https://docs.microsoft.com/en-us/azure/firewall/overview" target="_blank">Azure Firewall</a>は、Azure Virtual Network リソースを保護するクラウドベースのネットワークセキュリティサービスです。 これは、組み込みの高可用性とクラウドによる無制限のスケーラビリティを備えた、完全にステートフルなサービスとしてのファイアウォールです。 Azure Firewall を使用すると、サブスクリプションと仮想ネットワークの間でアプリケーションとネットワークの接続ポリシーを一元的に作成、適用、および記録できます。 仮想ネットワークリソースには静的パブリック IP アドレスが使用されるため、外部のファイアウォールでは、仮想ネットワークから送信されるトラフィックを識別できます。</p>


  <h2>Azure Virtual Machines のバックアップ</h2>


  <p>一般的なシナリオでは、Azure Virtual Machines (Vm) が Azure Firewall の背後でビジネスクリティカルなワークロードを実行している可能性があります。 これはネットワークの脅威に対して Vm をシールドする効果的な手段ですが、Azure VM のバックアップを使用して Vm 内のデータを保護することもできます。 これにより、いくつかのリスクにさらされる確率がさらに減少します。 Azure Backup は、Recovery Services コンテナーに安全に格納することで、Vm 内のデータを保護します。 これには、仮想マシンの記憶域からコンテナーにデータを移動する必要があり、ネットワークが必要です。 ただし、この通信はすべて、セキュリティで保護された Azure バックボーンネットワークを介して実行され、仮想ネットワークにアクセスする必要はありません。 任意のポートを開いたり、Ip を短縮したり、Azure Firewall 内の Azure Backup へのアクセス権を付与したりする必要はありません。 そのため、バックアップは Azure Firewall の強化されたセキュリティで機能しますが、最終的な操作を行う必要はありません。</p>


  <p>この機能は、NSGs などのネットワークの制限下で VM をロックダウンできる他のセキュリティ対策にも適用されることに注意してください。 そのため、Azure Vm のバックアップは、最後に適用されたネットワークの制限に関係なくシームレスに機能し、選択したネットワーク内にデータを保持し、追加のアクションを実行する必要がありません。</p>


  <h2>Azure VM 内で実行されている SQL Server のバックアップ (プレビュー)</h2>


  <p>Azure VM 内で実行されている SQL サーバーのバックアップでは、バックアップをアップロードして監視情報を出力するために、バックアップ拡張機能が Azure Backup サービスと通信する必要があります。 この拡張機能は、仮想マシン内に存在し、ネットワークアクセスを必要とします。 そのため、Azure vm 内で実行されている SQL サーバーをバックアップする場合は、Azure Backup サービスによるワークロードへのアクセスを許可する必要があります。 これは、データが Azure Backup に制限され、必要なレベルのセキュリティを維持できるようにするための単純なプロセスです。</p>


  <p>必要な作業は、次の手順を実行することだけです。</p>


  <p>1. Azure Firewall に移動します。</p>


  <p>2. [ <strong>ルール</strong> ] にアクセスし、[ <strong>アプリケーションルールコレクション] タブ</strong>を選択します。ここでは、アプリケーションルールコレクションを作成した場合に備えて、新しいアプリケーションルールコレクションを作成したり、既存のルールコレクションを編集したりできます。</p>


  <p><img width="610" height="285" title="アプリケーションルールコレクションへの追加のスクリーンショット" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" alt="Adding to application rule collection screenshot" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/19dcd9c9-a43c-4d85-894f-2452a9ef9280.png" border="0"></p>


  <p>3. 既存または新規のアプリケーション規則コレクションの [FQDN tags] セクションで、次の情報を含む規則を作成します。</p>


  <table border="1" cellspacing="0" cellpadding="2">
   <tbody>
    <tr>
     <td valign="top">
     <p><b>フィールド</b></p>
     </td>
     <td valign="top">
     <p><b>Value</b></p>
     </td>
    </tr>
    <tr>
     <td valign="top">
     <p>Priority</p>
     </td>
     <td valign="top">
     <p>ルールの適切な優先度を入力します。</p>
     </td>
    </tr>
    <tr>
     <td valign="top">
     <p>アクション</p>
     </td>
     <td valign="top">
     <p>ドロップダウンから [ <strong>許可</strong> ] を選択します。</p>
     </td>
    </tr>
    <tr>
     <td valign="top">
     <p>名前</p>
     </td>
     <td valign="top">
     <p>規則の名前を入力します。</p>
     </td>
    </tr>
    <tr>
     <td valign="top">
     <p>ソース アドレス</p>
     </td>
     <td valign="top">
     <p>ファイアウォールのスコープ内のすべてのサブネット内の Vm にこの規則を適用する場合は、テキストボックスに「」と入力し<strong>*</strong>ます。 それ以外の場合は、目的の IP または IP 範囲を指定します。</p>
     </td>
    </tr>
    <tr>
     <td valign="top">
     <p>FQDN タグ</p>
     </td>
     <td valign="top">
     <p>ドロップダウンから [<strong> Azurebackup</strong> ] を選択します。</p>
     </td>
    </tr>
   </tbody>
  </table>


  <p>次に示すのは、Azure vm で SQL サーバーを保護する Azure Backup を許可するルールの例です。</p>


  <p><img width="610" height="260" title="アプリケーション規則コレクションの編集のスクリーンショット" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" alt="Edit application rule collection screenshot" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8da912f7-bb5c-448f-9120-87ba3c2aa8fe.png" border="0"></p>


  <p>4. [ <strong>追加</strong> ] を選択して、前述の規則を作成します。</p>


  <p>ルールが作成されたら、中断することなく、Azure 仮想マシン内のデータベースをバックアップできます。 どのような場合でも、外部の脅威から Azure Firewall によって保護されていることを確認します。 azure 仮想マシン内の SQL サーバーのバックアップの詳細については、ブログ「<a style="margin: 0px; padding: 0px; outline: 0px; border: 0px currentcolor; border-image: none; text-align: left; color: rgb(95, 151, 175); text-transform: none; text-indent: 0px; letter-spacing: normal; font-family: inherit; font-size: 100%; font-style: inherit; font-variant: normal; font-weight: inherit; text-decoration: none; word-spacing: 0px; vertical-align: baseline; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;" href="https://azure.microsoft.com/en-in/blog/azure-backup-for-sql-server-on-azure-vm-public-preview/" target="_blank">azure での SQL Server のパブリックプレビューの Azure Backup</a>」をお読みください。</p>


  <p>Azure Backup と Azure Firewall は相互に補完し、Azure のリソースとデータを完全に保護します。 両方のサービスを一緒に使用する利点を得るために、特別な構成やインフラストラクチャは必要ありません。 詳細については、「azure <a href="https://docs.microsoft.com/en-us/azure/backup/backup-azure-vms-first-look-arm" target="_blank">Virtual Machines のバックアップ</a>」と「 <a href="https://docs.microsoft.com/en-us/azure/backup/backup-azure-sql-database" target="_blank">azure Virtual Machines 内の SQL サーバー</a>のバックアップ」を参照してください。</p>
