### YamlMime:Yaml
ms.openlocfilehash: d693030a46b2c43ce13fab4fb4e89c4a628001b0
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139894372"
Slug: how-skype-modernized-its-backend-infrastructure-using-azure-cosmos-db-part-1
Title: Azure Cosmos DB を使用したバックエンドインフラストラクチャの最新の Skype 方法-パート1
Summary: 2003に設立された Skype は、世界有数のコミュニケーションサービスの1つになっています。これにより、どこにいても他のユーザーとのエクスペリエンスを簡単に共有できます。 Microsoft が2010に買収したため、Skype は、ユーザーの合計が40億を超えています。これは、ユーザー数がを超えています。また、アクティブなユーザーが3億を超え4000万ています
Content: >-
  <p><em>これは、実際のニーズを満たすために Azure Cosmos DB をどのように使用しているか、およびそれに加えた違い &rsquo; に関する3部構成のブログ投稿シリーズです。この投稿 (第1部) では、行動を取るために直面した Skype の課題について説明します。<a href="https://azure.microsoft.com/en-us/blog/how-skype-modernized-its-backend-infrastructure-using-azure-cosmos-db-part-2/">パート 2</a>では、バックエンドインフラストラクチャを最新化するために Azure Cosmos DB Skype 実装する方法について説明 &rsquo; します。<a href="https://azure.microsoft.com/en-us/blog/how-skype-modernized-its-backend-infrastructure-using-azure-cosmos-db-part-3/">パート 3</a>では、これらの作業の結果につい &rsquo; て説明します。</em></p>


  <p><strong>注:</strong> 斜体/かっこ内のコメントは&#39;s です。</p>


  <h2>40億ユーザー &rsquo; へのスケーリングは簡単ではありません</h2>


  <p>2003に設立された Skype は、世界中 &rsquo; のプレミアコミュニケーションサービスの1つになっています。これにより、どこにいても他のユーザーとのエクスペリエンスを簡単に共有できるようになりました。 Microsoft が2010に買収したため、Skype は、ユーザーの合計が40億を超えています。これは、ユーザー数がを超えています。また、アクティブなユーザーが3億を超え4000万ています</p>


  <p>コア内部 Skype サービスの1つである People core サービス (pc) は、Skype ユーザーごとに連絡先、グループ、および関係が格納される場所です。 サービスは、Skype クライアントの起動時に呼び出され、メッセージ交換の開始時にアクセス許可がチェックされ、ユーザー &rsquo; の連絡先、グループ、および関係が追加または変更されたときに更新されます。 pc は、Microsoft Graph、Cortana、bot のプロビジョニング、その他のサードパーティのサービスなど、他の外部システムでも使用されています。</p>


  <p>2017より前では、PC は米国内の3つのデータセンターで実行されていました。このデータは、各データセンターで表されるサービス &rsquo; s 40億ユーザーの1/3 のデータと共に使用されます。 各場所には、大規模なモノリシック SQL Server リレーショナルデータベースがあります。 数年が経過すると、それらのデータベースの年齢が表示されるようになりました。 具体的な問題と問題が含まれています。</p>


  <ul>
      <li><strong>保守性:</strong> データベースには、非常に複雑で密に結合されたコードベースがあり、変更やデバッグが困難な長いストアドプロシージャがあります。 多くの相互依存関係がありました。データベースは別のチームによって所有されていましたが、データには Skype だけでなく、その最大のユーザーも含まれていました。 また、3つの異なる場所にある3つのシステム間でユーザーデータが分割されるため、取得または更新する必要があるユーザー &rsquo; データに基づいて、独自のルーティングロジックを維持する必要が Skype ます。</li>
      <li><strong>過剰な待機時間:</strong>米国からすべての pc データが提供されている場合、他の地域のクライアント Skype およびそれらをサポートするローカルインフラストラクチャ (通話コントローラーなど) では、pc データのクエリまたは更新時に許容できない待機時間が発生しました。 たとえば、呼び出しを設定するときに、Skype に1秒未満の内部サービスレベルアグリーメント (SLA) があります。 ただし、ヨーロッパのローカル呼び出しコントローラーによって実行されるアクセス許可チェックのラウンドトリップ時間は、PC からデータを読み取り、ユーザー A がユーザー B を呼び出すためのアクセス許可を持っていることを確認するために、必要な1秒間にヨーロッパの2人のユーザー間の呼び出しをセットアップできないようにしました。</li>
      <li><strong>信頼性とデータ品質:</strong> PC で使用されているデータが他のシステムと共有されていたため、データベースのデッドロックが問題 &mdash; になり、悪化しました。 また、データ品質は問題であり、連絡先が不足していること、連絡先のデータが正しくないことなどをユーザーが通知しています。</li>
  </ul>


  <p>これらの問題はすべて、使用量が増加するにつれて悪化します。2017によって、問題が許容できなくなりました。 データベーストラフィックの増加によってデッドロックが発生し、サービスが停止し、週単位のバックアップが一部のデータを使用できなくなったときに、デッドロックが発生しています。 &ldquo;私たちは、データベース要求を調整するための追加のコード、 &rdquo; Frantisek kaduk を呼び出し、プリンシパル .net 開発者を Skype チームで使用するなど、すべてのデッドロックに対処するためのさまざまな回避策について説明しました。 &ldquo;問題が悪化し続けるにつれて、別のことを行う必要があることに気付きました。&rdquo;</p>


  <p>さらに、チームは <a href="https://www.microsoft.com/en-us/TrustCenter/CloudServices/Azure/GDPR" target="_blank">一般データ保護規則 (GDPR)</a>に関連する期限に直面しています。システム &rsquo; は GDPR の要件を満たしていないため、サーバーをシャットダウンするための期限がありました。</p>


  <p>チームは、確実なユーザーエクスペリエンスを提供するために、独自のデータストアが必要であると判断しました。 高スループット、低待機時間、高可用性 &mdash; などの要件には、ユーザーが世界中であったかどうかに関係なく、それらすべてを満たす必要がありました。</p>


  <p>イベントドリブンアーキテクチャは自然に適合していましたが、現在のデータを格納する基本的な実装だけでなくてもかまいません。 &ldquo;より優れた監査証跡が必要でした。これは、状態の変化につながるすべてのイベントを格納することを目的と &rdquo; しています。 Kaduk について説明します。 &ldquo;たとえば、不適切なクライアントを処理するには、その一連のイベントを再生できる必要があります。 同様に、クロスサービス/クロスシャードトランザクションやその他の処理後のタスクを処理するには、イベント履歴が必要です。 イベントは、状態変更の発信元、その変更の目的、およびその結果をキャプチャします。&rdquo;</p>


  <p><em><a href="https://azure.microsoft.com/en-us/blog/how-skype-modernized-its-backend-infrastructure-using-azure-cosmos-db-part-2/">パート2で</a>は、バックエンドインフラストラクチャを最新化するために Azure Cosmos DB Skype 実装する方法について説明します。</em></p>
