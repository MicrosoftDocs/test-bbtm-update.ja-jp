### YamlMime:Yaml
ms.openlocfilehash: d016610539961d3f247e1e49252cfc0e68a51b05
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139910897"
Slug: build-custom-video-ai-workflows-with-video-indexer-and-logic-apps
Title: Video Indexer と Logic Apps を使用したカスタムビデオ AI ワークフローの作成
Summary: Logic Apps の Video Indexer コネクタを使用して、最も使用されているアプリを Video Indexer アカウントに接続し、プロセスをさらに自動化するワークフローをセットアップできるようになりました。 このブログでは、ロジックアプリで Video Indexer コネクタを使用する例について説明します。
Content: >-
  <div style="background:#eee;border:1px solid #ccc;padding:5px 10px;"><em><strong>2020 年5月7日の更新:</strong> &nbsp;Video Indexer ロジックアプリと Power Automate コネクタの最新情報については、「<a href="https://docs.microsoft.com/en-us/azure/media-services/video-indexer/logic-apps-connector-tutorial" target="_blank">チュートリアル: ロジックアプリでの Video Indexer の使用」と Power Automate</a> &nbsp; のドキュメントを参照してください。</em></div>


  <p>Logic Apps 用の Video Indexer connector を使用すると、最も使用されているアプリを Video Indexer に接続するカスタムワークフローを設定して、ビデオから深い洞察を抽出するプロセスをさらに自動化できるようになりました。</p>


  <p>このブログでは、ロジックアプリで Video Indexer コネクタを使用して、OneDrive の特定のフォルダーに新しいビデオファイルが作成されるたびに、そのビデオが自動的にアップロードされ、インデックスが作成されるようにワークフローを設定する例について説明します。 完了すると、新しくインデックスが作成されたビデオの洞察が、OneDrive の指定したフォルダーに JSON ファイルとして保存されます。</p>


  <h2>注意事項</h2>


  <p>現時点では、OneDrive とその他のストレージコネクタをトリガーするために、50 MB のファイルサイズ制限があります。 Video Indexer コネクタを使用すると、ストレージコネクタまたは共有アクセス署名の URL からファイルコンテンツを使用してビデオをアップロードできます。 現時点では、ストレージコネクタからビデオの URL にアクセスする方法はありませんが、この機能を OneDrive、OneDrive for Business、および Azure Storage に追加する処理を行っています。 実装されると、50 MB を超えるビデオを扱うことができるようになります。 ただし、現時点では制限を使用する必要があります。</p>


  <h2>ロジックアプリの設定</h2>


  <p>開始するには、Azure Portal にログインし、新しいロジックアプリを作成します。 チュートリアルに従って、 <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-create-a-logic-app" target="_blank">新しいロジックアプリを作成してデプロイする方法</a>を学習できます。</p>


  <p>ロジックアプリを作成したら、 <strong>Logic Apps デザイナー </strong>にアクセスし、[ <strong>空のロジックアプリ</strong>] を選択します。</p>


  <p>&nbsp;<a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/69a14472-bf19-4a62-879e-18e5fff7f39e.png"><img alt="0" border="0" height="417" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e294b86b-dc45-4302-a17c-354b4245ef7a.png" style="background-image: none; display: inline; border-image: none" title="0" width="500"></a></p>


  <p>最初に必要なのは、ビデオ用の OneDrive フォルダーに新しいファイルが作成されたときにイベントを発生させるトリガー &rdquo; です &ldquo; 。</p>


  <p>コネクタとトリガーの検索バーで、OneDrive &rdquo; を &ldquo; 検索します。 OneDrive (コンシューマー) と OneDrive for Business のオプションが表示されます。 これらのアカウントには、同様の手順があるため、または必要なアカウントに基づいて行うことができます。 このチュートリアルでは、OneDrive を使用します。</p>


  <p><strong>OneDrive コネクタ</strong>をクリックします。 これにより、OneDrive で使用できるすべてのトリガーが表示されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/71cb22f1-0af7-4cdb-af42-483e157562ce.png"><img alt="1" border="0" height="314" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ddfae985-29b2-4781-9f7b-cf3de43b7d78.png" style="background-image: none; display: inline; border-image: none" title="1" width="500"></a></p>


  <p><strong>ファイルが作成さ &rdquo; れたときに選択し &ldquo; </strong>ます。 これにより、指定された OneDrive フォルダーに新しいファイルが削除されるたびに、ロジックアプリでトリガーが起動します。 完了すると、OneDrive アカウントにサインインするように求められます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8ae74b7d-0f1b-4285-a528-308bbfec3a23.png"><img alt="21" border="0" height="225" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ba93e829-74dc-4ff4-a16f-be1029777909.png" style="background-image: none; display: inline; border-image: none" title="22" width="500"></a></p>


  <p>サインインすると、トリガーとその他のフィールドが表示されます。 [ <strong>フォルダー</strong> ] フィールドで、フォルダーアイコンをクリックし、ビデオのフォルダーに移動します。 ビデオのフォルダーをビデオ &rdquo; と呼ばれる &ldquo; OneDrive で選択しました。 &nbsp;適切なフォルダーを選択するか、独自のワークフローに固有の新しいフォルダーを作成することができます。 このフォルダーにはビデオファイルまたはオーディオファイルのみを含める必要があることに注意してください。 その他のファイルの場合は、Video Indexer コネクタでアップロードエラーが発生します。</p>


  <p>また、指定したフォルダーにファイルが作成されたかどうかをトリガーで確認する頻度を設定することもできます。 &ldquo;[項目 &rdquo; を確認する頻度] セクションで、[<strong>頻度</strong>] を [分] に設定し、[<strong>間隔</strong>] を3に設定して、トリガーを3分ごとに確認します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7089d7de-9030-4487-928d-00526274ea66.png"><img alt="image" border="0" height="286" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/65c006c6-620f-4b25-8400-b2423f6b90b9.png" style="background-image: none; display: inline; border-image: none" title="絵" width="500"></a></p>


  <p>次に、OneDrive フォルダーで作成されたビデオを Video Indexer ポータルにアップロードするアクションを設定する必要があります。 [ <strong>次のステップ </strong>] をクリックし <strong>、[アクションの追加</strong>] を選択します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/79bd013f-3931-43fc-be74-0e39dee0c9ed.png"><img alt="24" border="0" height="222" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/047b0aa8-4fd2-4fe6-9b14-1be003333195.png" style="background-image: none; display: inline; border-image: none" title="うち" width="500"></a></p>


  <p>&ldquo;Video Indexer &rdquo; を検索し、Video Indexer コネクタを選択します。 さまざまなアクションが一覧表示されます。現時点では Video Indexer のトリガーはありませんが、Webhook のサポートが Video Indexer API に追加されると、トリガーは後で使用されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4c83b83b-5b55-4bef-9e6b-76f1c0687d97.png"><img alt="3" border="0" height="389" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a597e70a-3a54-4817-9ff1-6a2170538bd6.png" style="background-image: none; display: inline; border-image: none" title="3 " width="500"> </a> &nbsp; &nbsp; &nbsp; <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6705051d-8e0d-406d-a5b1-9e1f1c9aab07.png"><img alt="35" border="0" height="389" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a2d9c497-3ccf-403f-92dc-46ebfb971a42.png" style="background-image: none; display: inline; border-image: none" title="35" width="475"></a></p>


  <p>Video Indexer ポータルにビデオをアップロードするための2つのオプションが表示できます。 1つは<strong>ビデオとインデックスアップロード</strong>呼ばれ、ファイルコンテンツデータを使用してビデオをアップロードすることができます。 もう1つのオプションは<strong>アップロードビデオとインデックス (url を使用)</strong>と呼ばれ、url を使用してビデオをアップロードすることができます。 どちらのオプションでも、アップロード時にビデオのインデックスが自動的に作成されます。</p>


  <p>このチュートリアルでは、ファイルコンテンツデータを使用してビデオをアップロードします。そのため、[<strong>アップロードのビデオとインデックス</strong>] を選択します。</p>


  <p>Video Indexer API キーを使用して接続を作成するように求めるメッセージが表示されます。 接続の名前と API キーを入力します。 このチュートリアルに従って、 <a href="https://azure.microsoft.com/en-us/blog/gettingstartedwiththevideoindexerapi/" target="_blank">VIDEO INDEXER api をサブスクライブする方法と、api キーにアクセスする方法を学習</a>できます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/456d9542-c7b8-4b32-9952-6bd8b9165a1e.png"><img alt="4" border="0" height="257" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/619461ff-aa00-4745-ba63-9f814437aa15.png" style="background-image: none; display: inline; border-image: none" title="4/4" width="500"></a></p>


  <p>接続を作成する<strong>と、アップロードのビデオとインデックス</strong>の操作が開きます。 いずれかのフィールドをクリックすると、OneDrive トリガーからの応答要素が表示されます。 [ <em>ファイルコンテンツ</em> ] フィールドで、[ <strong>ファイルコンテンツ </strong>の応答] 要素を選択します。 [ <em>ビデオ名</em>] には、 <strong>ファイル名</strong> の応答要素を選択するか、任意の名前を入力します。 必要に応じてプライバシーを設定します。 ここでは、プライバシーをプライベート &rdquo; に &ldquo; 設定しました。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9ba2326b-8384-42ac-a193-6fb2d8b2473b.png"><img alt="5" border="0" height="354" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9c7d8105-c740-41b3-a8b3-82eb67359669.png" style="background-image: none; display: inline; border-image: none" title="5/5" width="700"></a></p>


  <p>[ <strong>詳細オプションの表示</strong>] をクリックすると、さらに多くのフィールドが表示され、ビデオの詳細情報を入力できます。 必須フィールドではないため、ここでは空白のままにします。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/eb64f59b-7e82-4af8-91ae-5f56abf2a45e.png"><img alt="554" border="0" height="393" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/913c1b30-4393-4ed7-ac6f-85c3c3e75cc5.png" style="background-image: none; display: inline; border-image: none" title="554" width="500"></a></p>


  <p><strong>アップロードのビデオとインデックス</strong>の操作では、アップロード時にビデオの id が返されます。ただし、インデックス作成が完了したことを意味するわけではありません。 そのためには、ビデオが完全に処理されている場合にのみロジックアプリを進めることができるチェックを追加する必要があります。 [ <strong>新しいステップ</strong> ]、[その <strong>他</strong>] の順に選択します。 次 <strong>に、[do until の追加</strong>] を選択します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1774d0c0-1c01-459d-a439-570336ed4713.png"><img alt="7" border="0" height="262" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/efa6fb7a-664f-4ed3-9ae9-13f370cac87c.png" style="background-image: none; display: inline; border-image: none" title="7" width="500"></a></p>


  <p>Until ループが表示されます。 Until ループ内で、[ <strong>アクションの追加</strong>] を選択します。 Video Indexer コネクタをもう一度検索し、[ <strong>処理の取得] 状態</strong>を選択します。 [video id] \ (<em>ビデオ id</em> \) フィールドで、<strong>アップロードビデオとインデックス</strong>から<strong>ビデオ id</strong>応答要素を選択します。</p>


  <p>&nbsp; <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c28efd51-5bb9-4f1d-80a6-dc58558495cf.png"><img alt="9" border="0" height="343" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/14f0ea1d-7d32-4006-9471-a9277e69fac2.png" style="background-image: none; display: inline; border-image: none" title="ませ" width="500"></a>&nbsp;</p>


  <p>&ldquo;Until ループの [値 &rdquo; の選択] フィールドで、[<strong>処理状態の取得</strong>] から<strong>状態</strong>応答要素を選択します。 [値 &rdquo; の選択] という &ldquo; フィールドで、「処理済み &rdquo; 」 &ldquo; と入力します。 処理 &rdquo; 中 &ldquo; の状態は、ビデオのインデックス作成が完了したことを示しています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0b451227-5474-4985-8685-81212854769e.png"><img alt="image" border="0" height="432" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8312407d-b892-4bff-8420-a04e60f838d8.png" style="background-image: none; display: inline; border-image: none" title="絵" width="500"></a></p>


  <p>Until ループ内および [<strong> 処理状態の取得] アクション</strong>の後で、[ <strong>アクションの追加</strong>] を選択します。 [ <strong>遅延</strong> ] アクションを検索して選択します (これはスケジュールコネクタの一部です)。 "カウント" フィールドと "単位" フィールドを設定して、基本的に、<strong>状態</strong>が処理 &rdquo; さ &ldquo; れるかどうかを確認する頻度を決定する必要があります。 ここでは、[ <strong>カウント</strong> &ldquo; ] を 3 &rdquo; に、[ <strong>単位</strong> &ldquo; ] を [分 &rdquo; ] に設定して、3分ごとにチェックします。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/54e904e5-f5f5-4fb6-bdb6-eb2cae0c64a9.png"><img alt="11" border="0" height="510" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e45f1e12-34e0-4996-abd2-c3330701e39d.png" style="background-image: none; display: inline; border-image: none" title="個" width="500"></a></p>


  <p>次の手順は、新しく処理されたビデオの洞察を得ることです。 Until ループの外側で、[ <strong>新しいステップ</strong> ] を選択し、Video Indexer コネクタを検索します。 [ <strong>ビデオの取り込み</strong> ] 操作を選択します。 [video id] \ (<em>ビデオ id</em> \) フィールドで、<strong>アップロードビデオとインデックス</strong>から<strong>ビデオ id</strong>応答要素を選択します。 この操作により、ビデオのすべての洞察が得られます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/04b9f2be-0c19-40a1-9424-401fc5070436.png"><img alt="12" border="0" height="288" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/910e8c07-6cca-4839-9609-fca7ede5584d.png" style="background-image: none; display: inline; border-image: none" title="vdc" width="500"></a></p>


  <p>ビデオの詳細を見ることでビデオの洞察を<strong>得</strong>られたので、次に新しい洞察を含むファイルを作成し、OneDrive の適切なフォルダーに保存します。</p>


  <p>[<strong>アクションの追加</strong>] を選択し、OneDrive コネクタを検索します。 [ <strong>Create file</strong>] アクションを選択します。 [ <em>フォルダーパス</em> ] フィールドで、フォルダーアイコンをクリックし、ビデオの洞察を格納するための適切なフォルダーに移動します。 インサイト &rdquo; という &ldquo; フォルダーを選択しました。</p>


  <p>[ <em>ファイル名</em> ] フィールドで、新しいテキストファイルの名前を入力または選択します。 ここでは、 <strong>Get video ブレークダウン</strong>から<strong>名前</strong>応答要素を選択し、の後に &ldquo; インサイト &rdquo; 入力しました。 [<em>ファイルのコンテンツ</em>] フィールドで、[<strong>概要インサイト</strong>] を選択するか、[<strong>ビデオの取得] ブレークダウン</strong>から格納する特定の応答要素を選択します。 <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/video-indexer/video-indexer-output-json" target="_blank">応答要素</a>の詳細については、こちらを参照してください。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f3a0918c-1eb4-4df9-a9fd-ceb612ea2df6.png"><img alt="13" border="0" height="428" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ae2b0bcb-9393-411d-91ac-082390c1ad4b.png" style="background-image: none; display: inline; border-image: none" title="第" width="500"></a></p>


  <p>ロジックアプリを保存すると、作業が完了します。 ロジック アプリをテストする必要があります。</p>


  <h2>ロジック アプリのテスト</h2>


  <p>まず、[実行] を<strong>選択します。 </strong>次に、ロジック アプリをトリガーするには、トリガーで指定した OneDrive ビデオ フォルダーにビデオ ファイルをアップロードします。 前述のように、OneDrive トリガーには 50 MB のファイル サイズ制限があります。そのため、ビデオ ファイルを適切に選択する必要があります。&nbsp;</p>


  <p>ロジック アプリの [概要<strong></strong>] ページの [実行履歴] セクションで、ロジック <strong> </strong>アプリの実行<strong>の詳細を</strong>確認できます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5904c56d-5cbb-4755-9f17-5e6c9c24d55c.png"><img alt="14" border="0" height="428" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8241f0c7-1af6-4ff3-8896-1b8851e1fe0b.png" style="background-image: none; display: inline; border-image: none" title="14" width="500"></a></p>


  <p>Video Indexer コネクタを使用してさまざまなワークフローの組み合わせをテストして、プロセスを自動化して効率的に行うのに最適な機能を見つける準備ができました。</p>


  <p>現在、ビデオ ファイルが 50 MB の制限内にある限り、Media Services GitHub サイトと <a href="https://github.com/Azure-Samples/media-services-dotnet-functions-integration">Video Indexer</a> コネクタのサンプルを使用して、Media Services のライブ ワークフローとオンデマンド ワークフローを Video Indexer に統合するカスタム ワークフローを作成できます。 ロジック アプリを作成して、Video Indexer から Cosmos DB のようなシステムに分析情報をプッシュし、Azure Search を使用してメタデータ全体に対してクエリを実行したり、独自のカスタム メタデータに分析情報を結合したりすることもできます。</p>
