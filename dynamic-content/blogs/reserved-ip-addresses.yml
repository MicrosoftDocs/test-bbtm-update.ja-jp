### YamlMime:Yaml
ms.openlocfilehash: 2daed2c8e7392a064b70fb06f64f1b683ed7329e
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139904397"
Slug: reserved-ip-addresses
Title: Cloud Services & の予約済み IP アドレス Virtual Machines
Summary: このブログ投稿では、Cloud Services &amp; Virtual Machines の予約済み IP 機能 exerpience について説明します。
Content: >-
  こんにちは。


  2014年5月12日 Virtual Machines Cloud Services &amp; の予約済み IP アドレスの一般提供を発表しました。 このブログの投稿では、予約済み Ip を管理し、それらを Cloud Services/Virtual Machines に関連付けることについて説明します。料金モデル &amp; にはサポートされていないシナリオがいくつかあります。 予約済み Ip に関する技術ドキュメントについては、こちらを参照してください。

  <h2>予約済み IP アドレスとは何ですか。どのような場合に必要ですか。</h2>

  最新の PowerShell リリースでは、Microsoft Azure によって、Azure サブスクリプションでパブリック IPv4 アドレスを予約できます。 これらの IP アドレスは、サブスクリプションで必要な期間だけ所有することができます。また、予約済み IP アドレスのリージョンのクラウドサービスデプロイに関連付けることもできます。 この新しい発表は、特にパブリック IP アドレスを重視しています。 このプラットフォームでは、 <a href="https://azure.microsoft.com/blog/2014/04/22/static-internal-ip-address-for-virtual-machines/">ここで</a>説明するように、内部 ip の予約が既にサポートされています。


  予約済み IP アドレスが必要な理由はいくつかあります。

  <ul>
   <li><b>Easy A-レコード DNS: </b>Vm を削除してシャットダウンした後も同じパブリック IP を維持するため、再起動するときに、新しく割り当てられた IP の IP に応じて、DNS やその他のアプリケーションを再実行する必要がなくなります。</li>
   <li><b>オンプレミスの接続のセキュリティ:</b> パブリック IP を利用して、エンタープライズネットワークから Azure サービスへのアクセスを提供できるようになりましたが、オンプレミスのプロキシ/ファイアウォール経由のアクセスを制御および ACL'ing することができます。 VM を起動および停止するたびに、再プログラミングについて心配する必要はありません。</li>
  </ul>

  次の図は、Vip (予約済み IP) の IP Reservation の IP 予約がどのように機能するかを示しています。 Azure では、リージョンのスコープで予約済み IP を提供しています。つまり、予約済み IP を使用して、任意のロールインスタンスサイズを使用するクラウドサービスとの関連付けを行うことができます。


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/05/reservedip.png"><img style="float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; padding-right: 0px; margin-right: auto; border-width: 0px;" title="予約" alt="reservedip" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/reservedip_thumb.png" width="472" height="480" border="0" /></a>

  <h2>Microsoft Azure で IP アドレスを予約するにはどうすればよいですか。</h2>

  今週から、Azure <a href="https://azure.microsoft.com/en-us/documentation/articles/install-configure-powershell/">PowerShell コマンドレット</a> または <a href="https://msdn.microsoft.com/en-us/library/azure/dn722420.aspx">REST api</a> を使用して、azure サブスクリプションに予約済み IP アドレスを作成できます。 次を除くすべてのリージョンで IP アドレスを予約できます。 これらのリージョンには、すぐにサポートが追加されます。

  <ul>
   <li>ブラジル (プレビュー)</li>
   <li>中国東部</li>
   <li>中国北部</li>
  </ul>

  このプラットフォームでは、管理ポータル経由の予約済み IP アドレスの作成がサポートされていないことに注意してください。 PowerShell コマンドレットを使用して予約済み IP アドレスを作成する例を次に示します。

  <div align="left">

  <pre class="prettyprint">New-AzureReservedIP – ReservedIPName “MyWebsiteIP” –Label “WebsiteIP” –Location “Japan West”</pre>

  </div>

  このプラットフォームでは、既存の Cloud Services または仮想マシンの IP アドレスの予約はサポートされていません。 この機能のサポートは近い将来に発表される予定です。

  <h2>Virtual Machines で予約済み IP アドレス操作方法使用しますか?</h2>

  サブスクリプションに予約済み IP が作成されたら、予約済み IP を使用して仮想マシンのデプロイを作成できます。 New-AzureVM PowerShell コマンドレットで予約済み IP を使用する方法の例を次に示します。

  <pre class="prettyprint">New-AzureVMConfig -Name "WebAppVM" -InstanceSize Small -ImageName $images[130].ImageName | Add-AzureProvisioningConfig -Windows -AdminUsername $username -Password $password | New-AzureVM -ServiceName "MaheshWebApp" -ReservedIPName "MyWebSiteIP" -Location "Japan West"</pre>

  強調表示する2つの主要なシナリオがあります。

  <ul>
   <li><b>VM のシャットダウン-</b> 以前は、すべての仮想マシンインスタンスがシャットダウン状態に移行すると、パブリック IP が解放され、Virtual Machines インスタンスのいずれかが開始されると、新しいパブリック IP が割り当てられます。 今回のリリースでは、VM で予約済み IP を使用していれば、VM を再デプロイするときにその予約済み IP が使用されるようになりました。</li>
   <li><b>VM</b> - の削除予約済み IP を使用していたすべての Virtual Machines を削除すると、その予約済み IP は引き続きサブスクリプションで予約されるため、リージョンでの今後の VM のデプロイに使用できます。</li>
  </ul>

  仮想マシンの REST API については、 <a href="https://msdn.microsoft.com/en-us/library/azure/jj157194.aspx">こちら</a>を参照してください。

  <h2>Cloud Services (Web/Worker ロール) で予約済み IP アドレス操作方法使用しますか?</h2>

  また、同時にクラウドサービス (Web/Worker) 配置で予約済み IP を使用するためのサポートについても発表します。Cloud Services で予約済み IP を使用するには、SDK 2.3 バージョン (2014 年4月リリース) をダウンロードする必要があります。 サービス構成スキーマ (.CSCFG) で予約済み IP を参照する方法の例を次に示します。

  <pre class="prettyprint">&lt;?xml version="1.0" encoding="utf-8"?&gt;

  &lt;ServiceConfiguration serviceName="ReservedIPSample" xmlns="" osFamily="4" osVersion="*" schemaVersion="2014-01.2.3"&gt;
    &lt;Role name="WebRole1"&gt;
      &lt;Instances count="1" /&gt;
      &lt;ConfigurationSettings&gt;
        &lt;Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" value="UseDevelopmentStorage=true" /&gt;
      &lt;/ConfigurationSettings&gt;
    &lt;/Role&gt;
    &lt;NetworkConfiguration&gt;
      &lt;AddressAssignments&gt;
        &lt;ReservedIPs&gt;
         &lt;ReservedIP name="MyWebSiteIP"/&gt;
        &lt;/ReservedIPs&gt;
      &lt;/AddressAssignments&gt;
    &lt;/NetworkConfiguration&gt;
  &lt;/ServiceConfiguration&gt;</pre>

  Web/Worker ロールのデプロイを削除すると、そのデプロイに関連付けられていた予約済み IP がサブスクリプションで使用できるようになり、同じリージョンの今後のデプロイで使用できることに注意してください。

  <h2>サブスクリプションから予約済み IP アドレスをリリース操作方法には、</h2>

  デプロイに関連付けられていない予約済み IP アドレス (VM とクラウドサービスの両方) には課金コストがかかるため、不要な IP アドレスを解放することをお勧めします。 予約済み Ip の課金の詳細については、 <a href="https://azure.microsoft.com/en-us/pricing/details/reserved-ip-addresses/">こちら</a>を参照してください。 サブスクリプションから予約済み IP を解放する方法を示す PowerShell コマンドレットを次に示します。

  <div align="left">

  <pre class="prettyprint">Remove-AzureReservedIP -ReservedIPName "MyWebSiteIP" -Force</pre>

  </div>

  <h2>予約済み IP アドレスとアフィニティグループベースの仮想ネットワーク</h2>

  現時点では、Microsoft Azure は、予約済み IP に関連付けられたクラウドサービスまたは仮想マシンを ' アフィニティグループベースの Virtual Network ' にデプロイすることをサポートしていません。 次のスニペットは、"アフィニティグループベースの VNET" に予約済み IP でバーチャルマシンの展開を展開しようとした場合に表示されるエラーメッセージの例を示しています。

  <pre class="prettyprint">New-AzureVM : BadRequest : The deployment contains VirtualNetwork DemoVNET that belongs to an Affinity Group and ReservedIP that belongs to a region. This combination is not allowed.</pre>

  <h2>予約済み IP アドレスとリージョンの仮想ネットワーク</h2>

  このリリースでは、地域 (場所ベース) 仮想ネットワークのサポートも発表されています。 詳細については、 <a href="https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/">こちら</a>のブログを参照してください。 Microsoft Azure は、予約済み IP に関連付けられたクラウドサービスまたは仮想マシンを Virtual Network ベースの場所にデプロイする機能をサポートしています。

  <h2>予約済み IP アドレスの料金</h2>

  IPv4 アドレスは非常に少数のリソースであるため、Microsoft Azure はいくつかの状況で IP アドレスに対して公称料金を請求します。 予約済み IP の価格と課金に関する Faq の詳細については、 <a href="https://azure.microsoft.com/en-us/pricing/details/reserved-ip-addresses/">こちら</a>を参照してください。 クラウドサービスには、少なくとも1つの Web/Worker または仮想マシンインスタンスが実行されている必要があることに注意してください。


  請求書には、予約済み Ip に関連する2つのエンティティが表示されます。

  <ul>
   <li>予約済み IP のアドレス時間–サブスクリプションの予約済み Ip がどれだけだったかの合計時間数
  <ul>
   <li>実行中のインスタンス (または) の配置 (VM またはクラウドサービス) に関連付けられていません</li>
   <li>は、サブスクリプションで追加の予約済み IP アドレスを使用していました。</li>
  </ul>

  </li>
   <li>再マップの予約済み IP – IP アドレスが新しいクラウドサービスに関連付けられるたびに、再マップと見なされます。 再マップの料金の詳細については、 <a href="https://azure.microsoft.com/en-us/pricing/details/reserved-ip-addresses/">こちら</a>の予約済み IP 価格に関するページを参照してください。</li>
  </ul>

  <h2>予約済み IP アドレス配信登録の制限</h2>

  すべての Azure サブスクリプションは、5つの予約済み Ip を使用することが許可されています。 ただし、 <a href="https://azure.microsoft.com/en-us/support/faq/">ここで</a>サポート要求をログに記録することによって、サブスクリプションに対する予約済み IP 制限の引き上げを要求することができます。 詳細については、Azure サブスクリプションの制限 <a href="https://azure.microsoft.com/en-us/documentation/articles/azure-subscription-service-limits/">に関するドキュメント</a>を参照してください。
