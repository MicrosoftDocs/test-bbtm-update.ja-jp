### YamlMime:Yaml
ms.openlocfilehash: a85228a5d373567fa98dd7afb0038959747885a2
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139890909"
Slug: announcing-serverside-encryption-with-customermanaged-keys-for-azure-managed-disks
Title: Azure Managed Disks のカスタマー マネージド キーを使用したサーバー側暗号化の発表
Summary: 現在、Azure Managed Disks のカスタマー マネージド キー (CMK) を使用したサーバー側暗号化 (SSE) の一般提供を発表します。 Azure のお客様は、既定で有効になっているサービスのプラットフォーム マネージド キーを使用したサーバー Managed Disksメリットを得ていました。
Content: >-
  <p>本日は&#39;、Azure Managed Disks のカスタマー マネージド キー (CMK) を使用したサーバー側暗号化 (SSE) の一般提供を発表します。 Azure のお客様は、プラットフォーム マネージド キー<a href="https://azure.microsoft.com/en-us/blog/azure-managed-disks-sse/" target="_blank"></a>を使用して SSE &nbsp;を利用することで、既定Managed Disks有効になっています。 CMK を使用した SSE では、コンプライアンスのニーズに合わせて暗号化キーを制御することで、プラットフォームマネージド キーが向上します。</p>


  <p>現在、お客様は <a href="https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview" target="_blank">Azure Disk Encryption</a> を使用して、Windows <a href="https://docs.microsoft.com/windows/security/information-protection/bitlocker/bitlocker-overview" target="_blank">BitLocker</a> 機能と Linux <a href="https://en.wikipedia.org/wiki/Dm-crypt" target="_blank">dm-crypt</a> 機能を利用して、ゲスト仮想マシン (VM) 内の CMK で Managed Disks を暗号化できます。 CMK を使用した SSE では、Azure Storage サービス内のデータを暗号化することで、VM に対してカスタム イメージを含む任意の OS の種類とイメージを使用することで、Azure Disk Encryption が向上します。</p>


  <p>CMK を使用した SSE は <a href="https://azure.microsoft.com/en-us/services/key-vault/" target="_blank">Azure Key Vault</a> と統合されています。ハードウェア セキュリティ モジュールによってサポートされるキーに対して、高可用性でスケーラブルなセキュリティで保護されたストレージが提供されます。 独自の <a href="https://docs.microsoft.com/azure/key-vault/key-vault-hsm-protected-keys" target="_blank">キー (BYOK)</a> をアプリケーションに取り込むか、Key Vaultに新しいキーを生成Key Vault。</p>


  <h2>キー管理について</h2>


  <p>Managed Disksは、使用可能な最も強力なブロック暗号の 1 つである 256 ビット Advanced Encryption Standard (AES) 暗号化を使用して透過的に暗号化および暗号化解除されます。 Storageサービスは、エンベロープ暗号化を使用して、暗号化と暗号化解除を完全に透過的に処理します。 <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank">256 ビットの AES</a> ベースのデータ暗号化キーを使用してデータが暗号化されます。これは、Key Vault に格納されているキーを使用して保護されます。</p>


  <p>このStorageサービスは、データ暗号化キーを生成し、RSA 暗号化を使用して CMK で暗号化します。 エンベロープ暗号化を使用すると、VM に影響を与えることなく、コンプライアンス ポリシーに従って定期的にキーをローテーション (変更) することができます。 キーをローテーションすると、Storageサービスは新しい CMK を使用してデータ暗号化キーを再暗号化します。</p>


  <h2>キーのフル コントロール</h2>


  <p>ユーザーは、アプリケーション内のキーを完全にKey Vault。 Managed Disksでは、<a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview" target="_blank">システム割り当</a>てマネージド ID を Azure Active Directory (Azure AD) で使用して、Key Vault。 Key Vault で必要なアクセス許可を持つ管理者は、データ暗号化キーの暗号化と暗号化解除にキーを使用するために、Key Vault の Managed Disks へのアクセス権を最初に付与する必要があります。 キーを無効にするか、キー操作の&mdash;アクセス制御を取り出して、Managed Disks がキーにアクセスするのを防ぐことが可能です。そのため、実行中の VM に接続されているディスクの場合、VM は失敗します。 さらに、セキュリティ監視を使用してキーの使用状況を追跡Key Vault、信頼された他の Azure サービスManaged Disksサービスだけがキーにアクセスするようにすることができます。</p>


  <h2>CMK を使用した SSE の可用性</h2>


  <p>CMK を使用した SSE は、Azure Virtual Machines および VM スケール セットに接続できる Standard HDD、Standard SSD、および プレミアム SSD Managed Disks で使用できます。 Ultra Disk Storageは個別に発表されます。 CMK を使用する SSE は、すべてのパブリック リージョンと Azure Government リージョンで有効にされ、数週間後にドイツ (ソブリン) と中国のリージョンで使用できます。</p>


  <p>CMK を使用Azure Backup SSE で暗号化された Managed Disksを使用して VM をバックアップできます。 また、既定で使用できるプラットフォームマネージド キーではなく、Key Vault に格納されているキーを使用して、Recovery Services コンテナー内のバックアップ データを暗号化することもできます。 CMK を使用したバックアップの暗号化の詳細 <a href="https://docs.microsoft.com/en-us/azure/backup/backup-azure-security-feature-cloud#encryption-of-backup-data-using-customer-managed-keys" target="_blank">については、ドキュメントを参照してください</a>。</p>


  <p>Azure Site Recovery を使用して、CMK を使用して SSE Managed Disks暗号化された Azure 仮想マシンを、ディザスター リカバリーのために他の Azure リージョンにレプリケートできます。 また、オンプレミスの仮想マシンをレプリケートして、Azure Managed Disks CMK を使用して SSE で暗号化された仮想マシンにレプリケートできます。 CMK を使用 <a href="https://docs.microsoft.com/en-us/azure/site-recovery/azure-to-azure-how-to-enable-replication-cmk-disks" target="_blank">して SSE で暗号化された仮想マシンManaged Disksレプリケートする方法について説明します</a>。</p>


  <h2>はじめに</h2>


  <p>Managed Disks に対して CMK による暗号化を有効にするには、まず DiskEncryptionSet という名前の新しいリソースの種類のインスタンスを作成してから、そのインスタンスに Key Vault へのアクセス権を付与する必要があります。 DiskEncryptionSet は Key Vault のキーを表し、同じキーを持つ多数のディスク、スナップショット、およびイメージを暗号化するために同じキーを再利用できます。</p>


  <p>DiskEncryptionSet&rsquo; のインスタンスを作成する例を見てみます。</p>


  <p>1. ディスクにキーを指定して DiskEncryptionSet のインスタンスを作成Key Vault。</p>


  <p><code>keyVaultId=$(az keyvault show --name yourKeyVaultName --query [id] -o tsv)</code></p>


  <p><code>keyVaultKeyUrl=$(az keyvault key show --vault-name yourKeyVaultName --name yourKeyName --query [key.kid] -o tsv)</code></p>


  <p><code>az disk-encryption-set create -n yourDiskEncryptionSetName -l WestCentralUS -g yourResourceGroupName --source-vault $keyVaultId --key-url $keyVaultKeyUrl</code></p>


  <p>2. インスタンスにアクセス権を付与Key Vault。 インスタンスを作成すると、システムによって自動的にシステム割<a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview" target="_blank"></a>り当てマネージド ID が Azure ADに作成され、その ID が インスタンスに関連付けされます。 ラップキー、アンラップキー、get Key Vault操作を実行するには、ID にアクセスできる必要があります。</p>


  <p><code>desIdentity=$(az disk-encryption-set show -n yourDiskEncryptionSetName -g yourResourceGroupName --query [identity.principalId] -o tsv)</code></p>


  <p><code>az keyvault set-policy -n yourKeyVaultName -g yourResourceGroupName --object-id $desIdentity --key-permissions wrapkey unwrapkey get</code></p>


  <p><code>az role assignment create --assignee $desIdentity --role Reader --scope $keyVaultId</code></p>


  <p>ディスク、スナップショット、およびイメージを DiskEncryptionSet のインスタンスに関連付け、暗号化を有効にする準備ができました。 同じ DiskEncryptionSet に関連付けられるリソースの数に制限はありません。</p>


  <p>既存&rsquo;のディスクを有効にする例を見てみます。</p>


  <p>1. VM に接続されているディスクの暗号化を有効にするには、仮想マシンを停止 (割り当て) する必要があります。</p>


  <p><code>az vm stop --resource-group MyResourceGroup --name MyVm</code></p>


  <p>2. DiskEncryptionSet のインスタンスに関連付け、接続されているディスクの暗号化を有効にします。</p>


  <p><code>diskEncryptionSetId=$(az disk-encryption-set show -n yourDiskEncryptionSetName -g yourResourceGroupName --query [id] -o tsv)</code></p>


  <p><code>az disk update -n yourDiskEncryptionSetName -g yourResourceGroupName --encryption-type EncryptionAtRestWithCustomerKey --disk-encryption-set $diskEncryptionSetId</code></p>


  <p>3. VM を起動します。</p>


  <p><code>az vm start -g MyResourceGroup -n MyVm</code></p>


  <p>CMK を <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disk-encryption" target="_blank">使用Managed Disks</a> サーバー側暗号化を有効にする方法の詳細については、次のドキュメントを参照Managed Disks。</p>


  <h2>フィードバックを送信します</h2>


  <p>CMK を使用した SSE に関するフィードバックをお待ちしております。 こちらから <a href="mailto:AzureDisks@microsoft.com">メールをお送りください</a>。&nbsp;</p>
