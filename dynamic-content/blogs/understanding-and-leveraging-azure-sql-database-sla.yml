### YamlMime:Yaml
ms.openlocfilehash: 90d846a7ca3af1e3a644286ccd89186e43ec04cc
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139891939"
Slug: understanding-and-leveraging-azure-sql-database-sla
Title: クラウドの SLA Azure SQL Database理解して活用する
Summary: データがビジネスのライフブレードである場合は、データベースが信頼性が高く、セキュリティで保護され、呼び出し時に実行できる必要があります。
Content: >-
  <p>データがビジネスのライフブレードである場合は、データベースが信頼性が高く、セキュリティで保護され、呼び出し時に実行できる必要があります。 サービス レベル アグリーメント (SLA) は、アップタイムとパフォーマンスに対する期待を設定し、ビジネス ニーズに合わせてシステムを設計する場合の重要な入力です。 最近、新しいバージョンの <a href="https://azure.microsoft.com/en-us/support/legal/sla/sql-database/v1_4/" target="_blank">SQL Database SLA</a>&rsquo; を公開し、リレーショナル データベース サービス間で最高の可用性を保証し、業界初のビジネス継続性 SLA を導入しました。 これらの更新プログラムは、データが安全であり、ビジネスが破壊的なイベントが発生しても実行を続けるアプリとプロセスに依存するというコミットメントをさらに示しています。</p>


  <p>最近のサービス更新で示した通り <a href="https://azure.microsoft.com/en-us/updates/azure-sql-db-published-first-in-industry-business-continuity-sla-for-a-relational-database-service/" target="_blank">、</a>SLA には 2 つの大きな変更が加えらされました。 1 つAzure SQL Databaseでは、ビジネス クリティカルレベルのゾーン冗長データベースに対して 99.995% の可用性 SLA が提供されます。 これは、すべてのリレーショナル データベース サービスの中で業界最高の SLA です。 また、SLA が維持されていない場合に対して、最大 100% の月額コスト クレジットによってバックアップされます。 次に、2 つの異なる Azure リージョン間で geo レプリケートされるビジネス クリティカル層のデータベースに対して、ビジネス継続性 SLA を提供します。 この SLA には、5 秒の目標復旧時点 (RPO) と 30 秒の目標復旧時間 (RTO) の非常に強力な保証が付属しています。SLA が維持されていない場合の月間コスト クレジットは 100% です。 Azure SQL Databaseは、ビジネス継続性 SLA を提供する業界で唯一のリレーショナル データベース サービスです。</p>


  <p>次の表は、さまざまなクラウド ベンダー SLA の簡単な比較を&rsquo; 示しています。</p>


  <table border="1" cellpadding="2" cellspacing="0">
      <tbody>
          <tr>
              <td colspan="1" rowspan="2" style="text-align: center;" valign="top"><strong>プラットフォーム</strong></td>
              <td colspan="2" rowspan="1" style="text-align: center;" valign="top"><strong>可用性</strong></td>
              <td colspan="4" rowspan="1" style="text-align: center;" valign="top"><strong>ビジネス継続性</strong></td>
          </tr>
          <tr>
              <td valign="top">Uptime</td>
              <td valign="top">最大クレジット</td>
              <td valign="top">RTO</td>
              <td valign="top">最大クレジット</td>
              <td valign="top">RPO</td>
              <td valign="top">最大クレジット</td>
          </tr>
          <tr>
              <td valign="top"><strong>Azure SQL Database</strong></td>
              <td valign="top">99.995%</td>
              <td valign="top">100%</td>
              <td valign="top">30 秒</td>
              <td valign="top">100%</td>
              <td valign="top">5 秒</td>
              <td valign="top">100%</td>
          </tr>
          <tr>
              <td valign="top"><strong>AWS RDS</strong></td>
              <td valign="top">99.95%</td>
              <td valign="top">100%</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
          </tr>
          <tr>
              <td valign="top"><strong>GCP Cloud SQL</strong></td>
              <td valign="top">99.95%</td>
              <td valign="top">50%</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
          </tr>
          <tr>
              <td valign="top"><strong>Alibaba ApsaraDB</strong></td>
              <td valign="top">99.9%</td>
              <td valign="top">25%</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
          </tr>
          <tr>
              <td valign="top"><strong>Oracle クラウド</strong></td>
              <td valign="top">99.99%</td>
              <td valign="top">25%</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
              <td valign="top">N/A</td>
          </tr>
      </tbody>
  </table>


  <p align="center"><em>2019 年 7 月 18 日現在のデータであり、予告なしに変更される可能性があります。</em></p>


  <h2>可用性 SLA について</h2>


  <p>可用性 SLA には、すべてのSQL Database&rsquo;定期的に発生する破壊的なイベントを自動的に処理する機能が反映されています。 これは、コンピューティング リソースとストレージ リソースのリージョン内の冗長性、一定の正常性の監視、およびリージョン内の自動フェールオーバーを使用した自己回復操作に依存します。 これらの操作は同期的にレプリケートされたデータに依存し、データ損失は発生します。 そのため、アップタイムは可用性の最も重要なメトリックです。 Azure SQL Databaseは引き続き、そのすべてのサービス レベルでベースライン 99.99% の可用性 SLA を提供しますが、現在は、可用性ゾーンをサポートするリージョンのビジネス クリティカルレベルまたは Premium レベルに対して、より高い 99.995% の SLA を提供しています。 名前が示すように、ビジネス クリティカルレベルは、パフォーマンスと信頼性の両方の観点から、最も要求の厳しいアプリケーション向けに設計されています。 このサービス レベルを Azure 可用性ゾーン (AZ) と統合することで、AZ によって提供される追加のフォールト トレランスと分離を利用します。これにより、AZ 全体のコンピューティングとストレージの冗長性と同じ自己修復操作を使用して、より高い可用性の保証を提供できます。 コンピューティングとストレージの冗長性はビジネス クリティカルなデータベースとエラスティック プール用に組み込まれています。このため、可用性ゾーンを使用すると追加コストはかからずになります。 このドキュメントの「&ldquo;高可用性と可用性<a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-high-availability#premium-and-business-critical-service-tier-availability" target="_blank">Azure SQL Database</a>&rdquo;、ビジネス クリティカルなサービス レベルが可用性ゾーンを活用する方法の詳細について説明しています。 また、AZURE をサポートするリージョンの&ldquo;一覧については、Azure のドキュメント「Availability Zones<a href="https://docs.microsoft.com/en-us/azure/availability-zones/az-overview" target="_blank">」を参照してください</a>。&rdquo;</p>


  <p>99.99% の可用性は、ビジネス クリティカル層のデータベースを含め、すべてのデータベースのダウンタイムが年間 52.56 分を超えないようにする必要があるという意味です。 ゾーンの冗長性により、可用性が 99.995% に向上します。つまり、最大ダウンタイムは 1 年あたり 26.28 分、または 50% 削減されます。 1 分間のダウンタイムは、接続を確立しようとして失敗した期間として定義されます。 このレベルの可用性を実現するには、ビジネス クリティカルなデータベースまたはエラスティック プールを作成するときにゾーン冗長構成を選択する必要があります。 次の図に示す方法では、データベースの作成または更新 API をAzure portalプログラムで行います。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/053ce2db-1073-4e38-ae9b-18321e235273.png"><img alt="Screenshot of create or update database API in Azure portal" border="0" height="976" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ec7596c4-5a10-453d-b21f-9974e34c4552.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="データベース API の作成または更新のスクリーンショット Azure portal" width="1673"></a></p>


  <p>ゾーン冗長容量はほとんどのリージョンで Gen5 に基づくため、Gen5 コンピューティング世代を使用することをお勧めします。 ゾーン冗長構成への変換は、データベースのサービス レベルまたはコンピューティング サイズを変更した場合に行うのと同様の非同期オンライン プロセスです。 アプリケーションの受け入れやオフライン化は必要ではありません。 接続ロジックが <a href="https://social.technet.microsoft.com/wiki/contents/articles/4235.retry-logic-for-transient-failures-in-windows-azure-sql-database.aspx" target="_blank">適切に実装されている</a>限り、この移行中にアプリケーションは中断されません。</p>


  <h2>ビジネス継続性 SLA について</h2>


  <p>ビジネス継続性とは、リージョン内の自己復旧操作では軽減できない影響を受け、致命的なイベント中に迅速に復旧し、機能し続けるサービスの機能です。 このような計画外のイベントはまれですが、その影響は大きな影響を与える可能性があります。 ビジネス継続性は、複数の地理的に分離された場所にデータベースのスタンドアロン レプリカをプロビジョニングすることで実装されます。 これらの場所間の距離が長いので、非同期データ レプリケーションを使用して、ネットワーク待機時間によるパフォーマンスへの影響を回避します。 非同期レプリケーションを使用する主なトレードオフは、データ損失の可能性です。 SQL Databaseのアクティブ geo レプリケーション機能は、地理的に冗長なデータベースを作成および管理することで、ビジネス継続性を実現するように設計されています。 数&rsquo;年間は実稼働中であり、非常に積極的な保証をサポートするテレメトリが豊富に備え付けされています。</p>


  <p>ビジネス継続性イベントの影響を測定するために使用される 2 つの一般的なメトリックがあります。 目標復旧時間 (RTO) は、アプリケーションの可用性を復元できる時間を測定します。 目標復旧時点 (RPO) は、可用性が復元された後に予想される最大データ損失を測定します。 RPO に対して 5 秒、RTO に 30 秒の SLA を提供するだけでなく、これらの SLA が満たされていない場合は業界で最初に 100% のサービス クレジットを提供します。 つまり、データベース フェールオーバー要求が 30 秒以内に完了しない場合、またはレプリケーションのラグが 1 時間以内に 99 番目の割合で 5 秒を超える場合は、対象のセカンダリ データベースの月額コストの 100% に対してサービス クレジットを受け取る資格があります。 サービス クレジットの資格を得るには、セカンダリ データベースのコンピューティング サイズがプライマリと同じである必要があります。 ただし、これらのメトリックは、致命的な停止からの自動復旧の保証として解釈すべきではありません。 Azure SQL&rsquo;データを同期する際の信頼性とパフォーマンス、およびアプリケーションから要求されたフェールオーバーの速度が反映されます。 完全に自動化された復旧プロセスを使用する場合は、自動フェールオーバー <a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auto-failover-group" target="_blank"></a> ポリシーを使用した自動フェールオーバー グループ (RTO が 1 時間) を検討する必要があります。</p>


  <p>フェールオーバー要求の期間 (RTO 準拠など) を測定するには、セカンダリ サーバー上の master データベースの <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-operation-status-azure-sql-database?view=azuresqldb-current" target="_blank">sys.dm_operation_status</a> に対して次のクエリを使用します。 操作の状態情報は 24 時間のみ保持されます。</p>


  <pre>

  SELECT  datediff(s, start_time, last_modify_time) as [Failover time in seconds] FROM sys.dm_operation_status    WHERE major_resource_id = &#39;&lt;my_secondary_db_name&gt;&#39;,  operation=&rsquo;ALTER DATABASE FORCE FAILOVER ALLOW DATA LOSS &rsquo;, state=2 ORDER BY start_time DESC;</pre>


  <p>プライマリ データベースの <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-geo-replication-link-status-azure-sql-database?view=azuresqldb-current" target="_blank">sys.dm_replication_link_status</a> に対する次のクエリでは、partner_server で作成されたセカンダリ データベースのレプリケーションの遅延 (RPO 準拠) が数秒で表示されます。 1 時間あたりの測定値の統計的に有意なセットを持つには、30 秒以下ごとに同じクエリを実行する必要があります。</p>


  <pre>

  SELECT link_guid, partner_server, replication_lag_sec FROM sys.dm_replication_link_status</pre>


  <h2>可用性とビジネス継続性を組み合わせてミッション クリティカルなアプリケーションを構築する</h2>


  <p>更新された SLA は、実際には何を意味しますか? 私たちの目標は、お客様が Azure 上で高い回復性と信頼性の高いサービスを構築し、SQL Database。 ただし、ミッション クリティカルなアプリケーションによっては、1 年あたり 26 分間のダウンタイムでも許容できない場合があります。 ゾーン冗長データベース構成とビジネス継続性設計を組み合わせることで、アプリケーションの可用性をさらに高める機会が生み出されます。 この SLA リリースは、その機会を実現するための最初のステップです。</p>
