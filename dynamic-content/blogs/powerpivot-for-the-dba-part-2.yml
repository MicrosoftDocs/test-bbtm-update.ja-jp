### YamlMime:Yaml
ms.openlocfilehash: 36e6d2dca4f7038765f8b6ca42ae91e753e90a1d
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905144"
Slug: powerpivot-for-the-dba-part-2
Title: 'DBA の PowerPivot: パート2'
Summary: '[この記事は SQL Azure チームによって提供されました。]この記事では、ビジネスインテリジェンスのいくつかの簡単な用語と手法について、引き続き SQL します。'
Content: '<p>[この記事は SQL Azure チームによって提供されました。]</p><p>この記事では、ビジネスインテリジェンスのいくつかの簡単な用語と手法については、「SQL」をご覧ください。 これは、私が開始した一連のブログ記事の続きで、PowerPivot に対しては、SQL に相当します。</p>  <h2>Measure</h2>  <p>OLAP の専門家ではない場合は、PowerPivot の<i>メジャー</i>を頻繁に参照する baffled があるかもしれません。 基本的に、PowerPivot のメジャーは、評価されるセルのスコープを理解する定義済みの計算です。 これは、SQL Transact-sql での<a href="https://msdn.microsoft.com/en-us/library/bb675163.aspx">テーブル値パラメーター</a>を使用した関数とよく似ています。 概念的には、任意の言語の関数に似ています。これは、入力を受け取り、その入力に基づいて出力を生成する定義済みの計算です。 メジャーの言語は、 <a href="https://technet.microsoft.com/en-us/library/ee835613.aspx">データ分析式 (DAX)</a>です。</p>  <p>メジャーが定義されているダイアログには、複数のエントリポイントがあります。</p>  <ul>   <li>[PowerPivot] リボンの [新しいメジャー] ボタン</li>    <li>フィールドの一覧で、[新しいメジャーの追加...] と表示されている各テーブルのメニュー項目を右クリックします。</li>    <li>[式の編集] と表示されているフィールドリストの各メジャーに対して、[メニュー項目] を右クリックします。</li>    <li>フィールドの一覧の下にある [メジャーの編集...] と表示されている各メジャーの [メニュー項目] を右クリックします。</li> </ul>  <p>これらのエントリポイントのいずれかを選択すると、メジャーの名前と数式を指定できる [メジャー設定] ダイアログボックスが表示されます。このダイアログは次のようになります。</p>  <p><a href=""><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image001" border="0" alt="clip_image001" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3250.clip_5F00_image001_5F00_thumb_5F00_50AEF856.png" width="628" height="312"></a></p>  <p>このメジャーは、作成したテーブルに関連付けられます (上の [<b>テーブル名</b> ] ドロップダウン)。</p>  <p>DAX は Excel の式と非常によく似ていますが、スコープを扱うための追加属性があります。 実際、メジャーはピボットテーブルでのみ使用できます。これは、ピボットテーブルだけがスコープの概念を持つためです。</p>  <h2>Scope</h2>  <p>スコープについて理解することは、メジャーについて理解するための鍵です。 スコープについては、PowerPivot によってメジャーに送信される行の数について説明します。 たとえば、前のブログ記事では、Adventure works データベースを使用して、次のような PowerPivot の例を作成しました。</p>  <p><a href=""><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image003" border="0" alt="clip_image003" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4274.clip_5F00_image003_5F00_thumb_5F00_41F426A4.jpg" width="644" height="480"></a></p>  <p>これは、 <b>OrderDate</b>と<b>ProductCategory.Name</b>の両方を含む GROUP BY ステートメントを含む、この transact-sql SQL ステートメントと同じデータです。</p>  <pre class="csharpcode"><span class="kwrd">SELECT</span>    ProductCategory.Name, SalesOrderHeader.OrderDate, <span class="kwrd">SUM</span>(LineTotal)  <span class="kwrd">FROM</span>    Sales.SalesOrderHeader      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Sales.SalesOrderDetail <span class="kwrd">ON</span>           SalesOrderHeader.SalesOrderID = SalesOrderDetail.SalesOrderID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.Product <span class="kwrd">ON</span>           Product.ProductID = SalesOrderDetail.ProductID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductSubcategory <span class="kwrd">ON</span>           Product.ProductSubcategoryID = ProductSubcategory.ProductSubcategoryID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductCategory <span class="kwrd">ON</span>           ProductSubcategory.ProductCategoryID = ProductCategory.ProductCategoryID  <span class="kwrd">GROUP</span> <span class="kwrd">BY</span> ProductCategory.Name, SalesOrderHeader.OrderDate  <span class="kwrd">ORDER</span> <span class="kwrd">BY</span> SalesOrderHeader.OrderDate</pre>      <p>メジャーを使用していた場合、この場合、メジャーに送信されるスコープは、GROUP BY に一致するすべての行と、SELECT * が返す内部結合のすべての列になります。 メジャーは、ピボットテーブル内のすべてのセルに対して評価されます。 2001年7月1日、上記の例のカテゴリアクセサリは、次のような37行になります。 </p>    <p><a href=""><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image005" border="0" alt="clip_image005" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8311.clip_5F00_image005_5F00_thumb_5F00_62D7737E.jpg" width="644" height="233"></a></p>    <p>このセルに対して評価するために、すべての37行がメジャーに送信されます。 この例の<b>Sales</b> measure は、linetotal 列を合計するだけです。これは、最初の例の列を PowerPivot 合計するのと同じ結果になります。</p>    <p>先ほど作成した<b>Sales</b>メジャーを使用した場合、PowerPivot テーブルは次のようになります。</p>    <p><a href=""><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image007" border="0" alt="clip_image007" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0827.clip_5F00_image007_5F00_thumb_5F00_01318E9B.jpg" width="644" height="426"></a></p>    <p>他の言語と同様に、メジャー (または関数) を変更すると、すべてのセルが自動的に更新されます。 メジャーは、PowerPivot と計算の間の名前付けの抽象化と考えることができます。 実際には、複数のピボットテーブルまたはピボットグラフで Sales メジャーを使用できます。</p>    <h2>スコープの変更</h2>    <p>DAX 言語には、メジャー内の結果のスコープを変更するための組み込み関数が用意されています。 結果をフィルター処理するか、スコープを拡張してさらに多くの行を含めることができます。 これは、メジャーの機能です。これは、セルのスコープを取得し、拡張または縮小されたスコープと比較する機能です。</p>    <h2>まとめ</h2>    <p>このシリーズの次のブログ投稿では、PowerPivot でスコープを取得して展開する方法を説明し、セルのスコープとセルが含まれている製品カテゴリとの比率を計算するメジャーを作成します。 さらに、Transact SQL でも同じ結果が得られます。</p>    <p>質問、懸念事項、コメントがありますか。 これらを下に投稿してください。</p>'
