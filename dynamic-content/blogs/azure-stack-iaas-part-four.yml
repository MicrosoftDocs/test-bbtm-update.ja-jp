### YamlMime:Yaml
ms.openlocfilehash: 024d2d87884a92e37b418e278389476a37d5b49e
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139894474"
Slug: azure-stack-iaas-part-four
Title: Azure Stack IaaS – パート 4
Summary: この投稿では、仮想マシン上の IaaS 仮想マシン (VM) を保護するための概念とベスト プラクティスについて説明Azure Stack。
Content: >-
  <h2>自分のものを保護する</h2>


  <p>この投稿では、IaaS&rsquo; 仮想マシン (VM) を保護するための概念とベスト プラクティスについて説明Azure Stack。 この投稿は、「ビジネス継続性Azure Stackディザスター リカバリーに関する考慮事項」のホワイト ペーパー <a href="https://aka.ms/azurestackbcdrconsiderationswp">の一部です</a>。</p>


  <h2>IaaS 仮想マシン ベースのアプリケーションの保護</h2>


  <p>Azure Stackは、組織のデータセンターから IaaS Azure サービスを提供できる Azure の拡張機能&rsquo;です。 IaaS サービスを Azure Stack使用するには、ビジネス継続性とディザスター リカバリー (BC/DR) に対する最新のアプローチが必要です。 &rsquo;Azure と Azure Stack を使用して作業を開始するだけの場合は、包括的な BC/DR 戦略を実行して、クラウドのコンテキストでのアプリケーションの最新化による直接的かつ長期的な影響を組織が理解するようにしてください。 Azure Stack が既にある場合は、各アプリケーションに、組織のビジネス ニーズを満たす回復性、信頼性、可用性の要件を示す明確な BC/DR 計画が必要です。</p>


  <h2>そのAzure Stackとは何か、何がそうではないか&rsquo;</h2>


  <p>Ignite 2017&rsquo; Azure Stackを開始して以来、多くのお客様から、組織内で直面する課題に関するフィードバックを受け取り、Azure Stackをエンド カスタマーに提供しています。 主な懸念事項は、従来の仮想化との大きな違いです。 BC/DR プラクティスの最新化のコンテキストでは、次の 3 つの誤解が目立っています。</p>


  <h3>Azure Stackは、単なる別の仮想化プラットフォームです</h3>


  <p>Azure Stackは、統合システム パートナーと共同で設計された、スクリプト化されたハードウェア上のアプライアンス <a href="https://azure.microsoft.com/en-us/overview/azure-stack/">として提供されます</a>。 顧客が提供するサービスとAzure Stackに展開するアプリケーションに焦点を当てる必要があります。 アプリケーション チームと一緒に作業し、サービスを実行するインフラストラクチャとは別に、最新の IaaS のコンテキストで高可用性、バックアップの回復、ディザスター リカバリー、監視を実現する方法を定義する責任があります。</p>


  <h3>同じ仮想化保護スキームを仮想マシンで使用Azure Stack</h3>


  <p>Azure Stackは、インフラストラクチャを保護するための複数のセキュリティ層を備えた封印されたシステムとして提供されます。 次の制約があります。</p>


  <ul>
   <li>Azure Stackは、 <a href="https://docs.microsoft.com/en-us/azure/azure-stack/azure-stack-security-foundations">システムへの管理アクセスの制限のみを受け取る必要があります</a>。 システムへの昇格されたアクセスは、Microsoft サポートを通じて <a href="https://docs.microsoft.com/en-us/azure/azure-stack/azure-stack-privileged-endpoint">のみ可能です</a>。</li>
   <li>スケール ユニット ノードとインフラストラクチャ サービスでは、コードの整合性が有効になっています。</li>
   <li>ネットワーク層では、スイッチで定義されているトラフィック フローは、アクセス制御リストを使用してデプロイ時にロックダウンされます。</li>
  </ul>


  <p>これらの制約を考えると、スケールユニット ノードにバックアップ/レプリケーション エージェントをインストールしたり、レプリケーションとスナップショット作成のために外部デバイスからノードへのアクセスを許可したり、ストレージ レベルのレプリケーションのために外部ストレージ デバイスを別のサイトに物理的にアタッチしたりする機会はありません。</p>


  <p>お客様からのもう 1 つの質問は、複数のデータセンターまたはサイトにAzure Stackユニットをデプロイする可能性です。 Azure Stackユニット&rsquo;のストレッチ トポロジまたはマルチサイト トポロジはサポートされていません。 ストレッチ デプロイでは、1 つのサイト内のノードをオフラインにし、セカンダリ サイト内の残りのノードを使用してアプリケーションの実行を続行できると予想されます。 可用性の観点からは、Azure Stack N-1 フォールト トレランスしかサポートしないので、ノード数の半分を失った場合、システムはオフラインになります。 さらに、スケール ユニットの構成方法に基づいて、Azure Stackレベルの障害ドメインのみをサポートします。 スケール ユニット内にサイトの概念はありません。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a6ef49df-2214-4c9a-afc9-85b9373b12bc.png"><img alt="Azure Stack scale-unit stretched across multiple locations or sites separated by a large distance. This is an unsupported deployment topology for Azure Stack." src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9cb114bd-bd8c-4229-bdaa-bb9f2092d132.png" style="border: 0px currentcolor; border-image: none; width: 569px; height: 261px; margin-right: auto; margin-left: auto; display: block; background-image: none;" title="200 Azure イメージ 1"></a></p>


  <h3>Azure に最新のアプリケーションをデプロイしているのではありません。このいずれも私には当てはめ込みではありません</h3>


  <p>Azure Stackは、データセンターでクラウド サービスを提供するように設計されています。 インフラストラクチャの操作と IaaS VM ベースのアプリケーションの配信方法は明確に分離されています。 &rsquo;アプリケーションを Azure にデプロイする予定がなくても、Azure Stack &ldquo;&rdquo; へのデプロイは通常どおりのビジネスではなく、アプリケーションのライフサイクル全体を通して BC/DR の影響について考える必要があります。</p>


  <h2>リスク許容度のレベルを定義する</h2>


  <p>IaaS VM&rsquo; ベースのアプリケーションに対して bc/DR に対して Azure Stack に対して異なるアプローチが必要であるという理解を得て、1 つ以上の Azure Stack システム、Azure Stack の物理的および論理構造、およびユーザーとアプリケーション所有者が焦点を当てる必要がある回復目標の影響を確認できます。</p>


  <h3>システムをどのまで離れたAzure Stack展開する</h3>


  <p>まず&rsquo;、障害が発生した場合に保護する影響半径を定義します。 これは、同じ場所の施設のラックと同じでも、国または大陸の地域全体でも小さくすることができます。 影響半径内で、1 つ以上のシステムをデプロイAzure Stackできます。 リージョンが十分に大きい場合は、複数のデータセンターが互いに近く、それぞれが複数のAzure Stack場合があります。 重要なポイントは、障害や致命的なイベントのためにサイトがオフラインになる場合、Azure システムをオンラインに保つ冗長性が確保されるというものです。 次の図に示すように、サイト全体が失われる可能性がある場合は、1 つの場所の災害が他の場所に影響を与えないので、十分な距離で区切られた複数の地理的な場所に Azure Stack システムをデプロイする必要があります。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/69329167-4756-4e4d-a006-59b96677a5d6.png"><img alt="A flowchart of the Azure Stack system deployed in a datacenter that can have a single utility feed (referred to as a tier 1 or tier 2 datacenter) or two redundant utility feeds (commonly referred to as a tier 3 or tier 4 datacenter)." border="0" height="305" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ebb9e5c3-1462-4e28-8e33-973d131cc29a.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="200 2" width="571"></a></p>


  <h3>アプリケーション所有者がアプリケーションの物理層と論理層を理解Azure Stack</h3>


  <p>次に&rsquo;、1 つの環境内にまとめる物理層と論理レイヤーを理解Azure Stack重要です。 すべてのAzure Stackサービスを実行するシステムとアプリケーションが、データセンター内のラック内に物理的に配置されます。 アプリケーションの各デプロイAzure Stack、独自のポータルを持つ個別のインスタンスまたはクラウドです。 次の図は、&rsquo;現在デプロイされているシステムと、近い将来にAzure Stackシステムに共通する物理的および論理的なレイヤーを示しています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/713db9d4-bf4c-4c06-a4e6-df6ec1ee0fff.png"><img alt="Logical and physical layering of an Azure Stack system deployed in a site. Site contains a datacenter or co-location facility. Datacenter contains a room or row that contains a rack. Rack contains an Azure Stack cloud. Cloud contains a region. Region contains a scale-unit. Scale-unit contains 4-16 nodes. Nodes contains applications and user data." border="0" height="350" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/58a839e2-9a94-418d-9609-76219a5c8ea3.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="200 Azure イメージ 3" width="614"></a>&nbsp;</p>


  <h3>アプリケーション所有者と一緒に各アプリケーションの目標復旧時間を定義する</h3>


  <p>システムがオフラインにされた場合のリスク許容度を明確に理解したので、アプリケーションの保護スキームを決定する必要があります。 正常なシステム上のアプリケーションとデータをすばやく復旧できる必要があります。 ハードウェア&rsquo;障害から保護するために可用性セットを使用して、アプリケーションがスケールユニット内で高可用性を実現するように設計されている点についてお話しします。 さらに、破損や誤削除が原因でアプリケーションがオフラインになる可能性も考慮する必要があります。 復旧は、アプリケーションのスケールアウトやバックアップからの復元と同じ方法で行います。</p>


  <p>システム全体の障害&rsquo;を乗り切るためには、各アプリケーションの可用性要件、障害が発生した場合にアプリケーションを実行できる場所、および復旧を有効にするために導入する必要があるツールを特定する必要があります。 アプリケーションを Azure で一時的に実行できる場合は、Azure Site Recovery や <a href="https://docs.microsoft.com/en-us/azure/site-recovery/azure-stack-site-recovery">Azure Backup サービスを</a>使用して<a href="https://azure.microsoft.com/en-us/blog/backup-your-applications-on-azure-stack-with-azure-backup/"></a>アプリケーションを保護できます。 もう 1 つのオプションは、追加のAzure Stackシステムを完全にデプロイし、運用可能にし、アプリケーションを実行する準備を整える方法です。 セカンダリ システムでアプリケーションを実行するために必要な時間は、目標復旧時間 (RTO) です。 この目的は、ユーザーとアプリケーション所有者の間で確立されます。 一部のアプリケーション所有者は最小限のダウンタイムのみを許容し、データが別の場所で保護されている場合は、複数日のダウンタイムで問題ないアプリケーション所有者もいます。 この RTO を実現する方法は、アプリケーションによって異なります。 次の図は、VM またはアプリケーション レベルで使用される一般的な保護スキームをまとめたものです。</p>


  <p>&nbsp;</p>


  <p>障害が発生した場合は、セカンダリ ロケーションに対してサービスのオンデマンドデプロイAzure Stack要求する時間はありません。 セカンダリ ロケーション&rsquo;に展開されたシステムが存在しない場合は、ハードウェア パートナーからシステムを注文する必要があります。 システムの配信、インストール、デプロイに必要な時間は数週間で測定されます。<a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/90ace75b-5aa9-41bd-bd3f-32d7ecdd61eb.png"><img alt="Recovery time objectives for applications on Azure Stack that need to be recovered on a different Azure Stack. Backup and restore recovery time is hours to days. Replication recovery and manual failover is minutes to hours.  Stateless and stateful applications in an active/active configuration have no downtime." border="0" height="374" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/501c46fe-f6b6-4da0-93a9-9da33c78f278.png" style="border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="200 4" width="735"></a></p>


  <h2>アプリケーションとデータ保護のオファリングを確立する</h2>


  <p>Azure Stack で保護する必要があるものと、各アプリケーションの&rsquo;リスク許容度がわかったので、IaaS VM で使用される特定のパターンを確認できます。</p>


  <h3>データ保護</h3>


  <p>IaaS VM にデプロイされたアプリケーションは、バックアップ エージェントを使用してゲスト OS レベルで保護できます。 データは、同じ IaaS VM、同じシステム上の新しい VM、または障害が発生した場合に別のシステムに復元できます。 バックアップ エージェントは、IaaS VM で次のような複数のデータ ソースをサポートします。</p>


  <ul>
   <li><strong>ディスク：</strong> これには、ゲスト OS に公開されている 1 つ、一部、またはすべてのディスクのブロックレベルのバックアップが必要です。 ディスク全体を保護し、ブロック レベルで変更をキャプチャします。</li>
   <li><strong>ファイルまたはフォルダー:</strong> これには、ゲスト OS に接続されている 1 つ、一部、またはすべてのボリューム上の特定のファイルとフォルダーのファイル システム レベルのバックアップが必要です。</li>
   <li><strong>OS の状態:</strong> これには、OS 状態を対象としたバックアップが必要です。</li>
   <li><strong>アプリケーション</strong>: これには、ゲスト OS にインストールされているアプリケーションと調整されたバックアップが必要です。 アプリケーション対応のバックアップには、通常、アプリケーションの一貫性のためにゲストに入力と出力を一貫性を保つ (たとえば、Windows OS の ボリューム シャドウ コピー サービス (VSS) など) が含まれます。</li>
  </ul>


  <h3>アプリケーション データ レプリケーション</h3>


  <p>もう 1 つのオプションは、ゲスト OS レベルまたはアプリケーション レベルでレプリケーションを使用して、別のシステムでデータを使用することです。 レプリケーションは、&rsquo;基になるインフラストラクチャにオフロードされるので&rsquo;、ゲスト OS 以上で処理されます。 1 つの例は、分散可用性グループSQL非同期レプリケーションをサポートするアプリケーションなどです。</p>


  <h3>高可用性</h3>


  <p>高可用性を実現するには、まず、アプリケーションのデータ永続化モデルを理解する必要があります。</p>


  <ul>
   <li><i>ステートフル ワークロード</i> は、1 つ以上のリポジトリにデータを書き込む。 致命的&rsquo;なイベントから復旧するには、アーキテクチャのどの部分でポイントインタイム データ保護と高可用性が必要か理解する必要があります。</li>
   <li><i>一方、</i> ステートレス ワークロードには、&rsquo;保護する必要があるデータは含め "されません"。 これらのワークロードは通常、オンデマンドのスケールアップとスケールダウンをサポートし、ロード バランサーの背後にあるスケールアウト トポロジ内の複数の場所にデプロイできます。</li>
  </ul>


  <p>1 つのシステム内でアプリケーション レベルの高可用性Azure Stack、複数の仮想マシンが可用性セットに <i>グループ化されます</i>。 可用性セットにデプロイされたアプリケーションは、受信トラフィックを複数の仮想マシンにランダムに分散するロード バランサーの背後に配置されます。</p>


  <p>システムAzure Stack、次の違いによって同様の方法が可能です。ロード バランサーは、両方のシステムまたは Azure の外部 (つまり、Traffic Manager) である必要があります。 可用性セットは、独立したシステム間Azure Stackではありません。</p>


  <h2>まとめ</h2>


  <p>IaaS VM ベースのアプリケーションを Azure と Azure Stack にデプロイするには、BC/DR 戦略を包括的に評価する必要があります。 &ldquo;クラウドのコンテキストでは&rdquo; 、通常どおりのビジネスでは十分ではありません。 Azure Stack には、基盤となるインフラストラクチャの保護スキームとは別に、アプリケーションの回復性、可用性、および回復性の要件を評価する必要があります。</p>


  <p>また、同意した Sla に基づいて、エンドユーザーの期待をリセットする必要があります。 Azure Stack に Vm をオンボードするお客様は、Azure Stack で可能な Sla に同意する必要があります。 たとえば、Azure Stack は、サイト間のストレージレベルの同期レプリケーションに依存する一部のミッションクリティカルなアプリケーションで必要とされる、データ損失の厳格な要件を満たしていません。 早い段階でこれらの要件を特定し、適切なレベルの保護とディザスターリカバリーによって Azure Stack する新しいアプリケーションをオンボードするための成功した追跡記録を構築しましょう。</p>


  <h3>詳細情報</h3>


  <ul>
   <li><a href="https://aka.ms/azurestackbcdrconsiderationswp">ビジネス継続性とディザスターリカバリーに関するホワイトペーパーの Azure Stack に関する考慮事項</a></li>
   <li><a href="https://aka.ms/backupazurestack">インフラストラクチャ バックアップ サービスを使用した Azure Stack のバックアップとデータの回復</a></li>
   <li><a href="https://aka.ms/azurestackbcdrpartners">Azure Stack の検証済みプランを持つすべての BC/DR パートナーの一覧 </a></li>
   <li><a href="https://aka.ms/azurestackmabs">Azure Stack の Azure Backup サポート</a></li>
   <li><a href="https://aka.ms/azurestackasr">Azure Site Recovery による Azure Stack のサポート</a></li>
   <li><a href="https://myignite.techcommunity.microsoft.com/sessions/66253">Microsoft Azure スタックでのビジネス継続性とディザスターリカバリーのアーキテクチャパターンとプラクティスについて</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/manage-availability">冗長性実現のために複数の仮想マシンを可用性セット内に構成する</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/azure-stack/azure-stack-key-features#high-availability-for-azure-stack">Azure Stack の可用性セット</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/tutorial-availability-sets">チュートリアル: 高可用性仮想マシンの作成と展開</a></li>
  </ul>


  <h3>このブログシリーズの記事</h3>


  <p>今後、このシリーズの記事を読むことをお待ちしております。 今後予定されているトピックの一部を次に示します。</p>


  <ul>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-one/" target="_blank">コアの Azure Stack は、サービスとしてのインフラストラクチャ (IaaS) プラットフォームです。</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-laas-part-two/" target="_blank">既存のものから始める</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-3/" target="_blank">IaaS の基礎</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-five/" target="_blank">自分で実行する</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-six/" target="_blank">使用した分の支払い</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-seven/" target="_blank">チームを取得する</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-seven-2/" target="_blank">頻繁に実行する場合は、自動化します。</a></li>
   <li><a href="https://azure.microsoft.com/en-us/blog/azure-stack-iaas-part-nine/" target="_blank">他のユーザーの成功に応じて構築する</a></li>
   <li><a href="https://azure.microsoft.com/en-ca/blog/azure-stack-iaas-part-ten/" target="_blank">PaaS への道のり</a></li>
  </ul>
