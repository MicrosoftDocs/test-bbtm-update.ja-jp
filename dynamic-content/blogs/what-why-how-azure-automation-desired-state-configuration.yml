### YamlMime:Yaml
ms.openlocfilehash: dc19a00adb9760663dd8603d2e34b0c62a519fec
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139910244"
Slug: what-why-how-azure-automation-desired-state-configuration
Title: Azure Automation Desired State Configuration (DSC) の内容、理由、および方法
Summary: 大規模な構成管理、マシンを組織のポリシーに合わせるか、継続的な展開を可能にするかにかかわらず、面倒でエラーが発生しやすいプロセスにすることができます。 現在一般公開されている Azure Automation DSC を使用すると、簡単に実行できます。
Content: "<p>大規模な構成管理、マシンを組織のポリシーに合わせるか、継続的な展開を可能にするかにかかわらず、面倒でエラーが発生しやすいプロセスにすることができます。 インフラストラクチャのフットプリントが増加するにつれて、次のような一般的な質問によって、この分野では問題が発生 &rsquo; します。</p>\n\n<ul>\n <li>すべてのコンピューターが目的の構成と一致し、正しい状態のままであることを操作方法しますか?</li>\n <li>ませんは、人間、プロセス、およびプログラムによって行われた変更が原因で、コンピューターの構成が目的の状態からできないようにします。操作方法</li>\n <li>新しいコンピューターが同じ役割内の既存のコンピューターの構成と一致するかどうかを操作方法しますか?</li>\n <li>コンピューターのすべてまたは一部に対して新しい必要な構成をシームレスに設定操作方法</li>\n <li>コンピューターまたはマシンロールの目的の構成を変更できるユーザーへのアクセスを制限操作方法</li>\n <li>稼働時間に影響を与えることなく構成の変更を調整操作方法</li>\n <li>オンプレミスのマシンとパブリッククラウドの間、および Windows と Linux で、上記のすべてを一貫して操作方法ますか。</li>\n</ul>\n\n<p><strong>Azure Automation Desired State Configuration (DSC)</strong>は、上記の問題に対処するための高可用性構成管理ソリューションを提供します。 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-overview/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">Automation DSC</a>を使用すると、クラウドから大規模にすべての IT リソースの望ましい状態を継続的にデプロイし、確実に監視し、自動的に更新することができます。 Automation DSC は、クラウドまたはオンプレミスの物理マシン、仮想マシン、Windows または Linux 全体で、マシンの構成を特定の状態に合わせることができます。これにより、一貫した制御で継続的なデプロイと IT サービスの配信が可能になります。 異種環境と複数のクラウドでの迅速な変更の管理が簡素化され、ビジネスのニーズをより柔軟に達成できるようになります。</p>\n\n<p>しかし、どのように動作するのでしょうか。 Automation DSC は、 <a href=\"https://msdn.microsoft.com/en-us/powershell/dsc/overview?f=255&amp;MSPPError=-2147217396\">PowerShell Desired State Configuration (DSC)</a>に導入された基本事項を基に構築されているため、より簡単に構成管理作業を行うことができます。 Automation DSC を使用すると、PowerShell DSC 構成の作成と管理、DSC リソースのインポート、DSC ノード構成 (MOF ドキュメント) の生成をすべてクラウドで行うことができます。 これらの DSC 項目は Automation DSC プルサーバー上に配置されるので、クラウドまたはオンプレミスのターゲットノード (物理および仮想マシン) はそれらを選択し、指定されている目的の状態に自動的に準拠して、対応について Automation DSC を報告することができます。</p>\n\n<p>たとえば、 &rsquo; &rsquo; log analytics と監視のために Microsoft &rsquo; <a href=\"https://www.microsoft.com/en-us/server-cloud/operations-management-suite/overview.aspx\" target=\"_blank\">Operations Management Suite</a> (OMS) に依存しているとします。 このような状況では、すべてのコンピューターに OMS エージェントがインストールされ、エージェントが常に実行されていることを確認する必要があります。 これよりも、クラウド環境とデータセンター環境の洞察や制御が失われることを意味します。</p>\n\n<p>Automation DSC を使用すると、意図した目的の状態にコンピューターを適合させることが非常に簡単になります。 まず、コンピューターが一致する必要のある状態を指定して、PowerShell DSC 構成 Automation DSC を作成してインポートします。 上記の OMS エージェントの例では、DSC 構成は次のようになります。</p>\n\n<pre class=\"prettyprint\">\nConfiguration MyConfiguration {\n    \n    # TODO: add your OMS workspace onboarding values here\n    $OmsWorkspaceId = &quot;FILL ME IN&quot;\n    $OmsWorkspaceKey = &quot;FILL ME IN&quot;\n\n    $OIPackageLocalPath = &quot;C:\\MMASetup-AMD64.exe&quot;\n    Import-DscResource -ModuleName xPSDesiredStateConfiguration\n\n    Node OMSServer {\n\n        #Service state\n        Service OIService {\n            Name = &quot;HealthService&quot;\n            State = &quot;Running&quot;\n            DependsOn = &quot;[Package]OI&quot;\n        }\n\n        xRemoteFile OIPackage {\n            Uri = &quot;https://opsinsight.blob.core.windows.net/publicfiles/MMASetup-AMD64.exe&quot;\n            DestinationPath = $OIPackageLocalPath\n        }\n\n        #Application\n        Package OI {\n            Ensure = &quot;Present&quot;\n            Path  = $OIPackageLocalPath\n            Name = &quot;Microsoft Monitoring Agent&quot;\n            ProductId = &quot;C318816D-D471-4F18-999A-7662DB906BC0&quot;\n            Arguments = &#39;/C:&quot;setup.exe /qn ADD_OPINSIGHTS_WORKSPACE=1 OPINSIGHTS_WORKSPACE_ID=&#39; + $OmsWorkspaceId + &#39; OPINSIGHTS_WORKSPACE_KEY=&#39; + $OmsWorkspaceKey + &#39; AcceptEndUserLicenseAgreement=1&quot;&#39;\n            DependsOn = &quot;[xRemoteFile]OIPackage&quot;\n        }\n    }\n}</pre>\n\n<p>この構成はネイティブでない PowerShell DSC リソース (xRemoteFile) に依存しているため、 &rsquo; その dsc リソースを含む <a href=\"https://www.powershellgallery.com/packages/xPSDesiredStateConfiguration/3.7.0.0?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">PowerShell モジュール</a> も Automation DSC にインポートする必要があります。 次に、Automation サービスで <a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-compile/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">構成をコンパイル</a> し、生成されたノード構成をマシンに割り当てます。 このノード構成をプルして、目的の状態に準拠するために常にオートコレクトを適用するか、または各コンピューターに設定した &rsquo; 構成モードに応じて、目的の状態に対するコンプライアンスを報告するだけです。 このコンプライアンス情報 &ldquo; &rdquo; は、Automation DSC ダッシュボードで確認できます。</p>\n\n<p><img alt=\"Automation-DSC-dashboard\" border=\"0\" height=\"310\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f7141ac7-2878-493c-abf1-3d9bf7513a70.png\" style=\"border-width: 0px; margin-right: auto; margin-left: auto; float: none; display: block;\" title=\"Automation-DSC-ダッシュボード\" width=\"480\"></p>\n\n<p>OMS エージェントがインストールまたは実行されていることを確認する方法は、Automation DSC を使用する方法の1つです。 もちろん、セキュリティポリシー、ファイアウォール規則、<a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-cd-chocolatey/\">アプリケーションコードの最新バージョンの存在</a>など、コンプライアンスを強制または報告する必要があるその他の &ldquo; さまざまな状態 &rdquo; があります。</p>\n\n<p>&rsquo;Automation DSC の基本について説明したので、 &rsquo; 最近<a href=\"https://azure.microsoft.com/en-us/updates/general-availability-azure-automation-desired-state-configuration/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">一般公開</a>されたリリースの一部として追加したサービスの新機能について説明します。 最初 &rsquo; に気付くのは、コンピューター上のどのリソースが目的の状態と一致しているかどうかを正確に判断するのに役立つ、新しい豊富なレポートインターフェイスです。 以前は、Automation DSC UI でコンピューターの DSC レポートをクリックすると、次のような内容が表示されます。</p>\n\n<p><img alt=\"DSC-report-for-a-machine\" border=\"0\" height=\"397\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/fc92dc3b-cadc-4092-b601-9bb3ebd8bc43.png\" style=\"border-width: 0px; margin-right: auto; margin-left: auto; float: none; display: block;\" title=\"DSC-レポート-コンピューター\" width=\"480\"></p>\n\n<p>コンピューターで WMF 5 RTM を実行している場合は、よりわかりやすいユーザーインターフェイスに同じ情報が表示されます。</p>\n\n<p><img alt=\"DSC-report-for-a-machine-running-WMF-5-RTM\" border=\"0\" height=\"336\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/60cae313-67fc-4f3e-b8b4-dd6fcf302f96.png\" style=\"border-width: 0px; margin-right: auto; margin-left: auto; float: none; display: block;\" title=\"DSC-----------------RTM\" width=\"480\"></p>\n\n<p>しかし、Automation DSC のもう1つのあまり知られていないレポート機能もあり &rsquo; ます。これ &ndash; は、Automation DSC 使用して、対応レポート専用のコンピューターをサポートすることです。 &nbsp;&rsquo;これで、コンピューターをオンボードして、Automation DSC 上のスクリーンショットのような対応情報をレポートすることができるようになりました。ただし、データセンター内から直接プッシュされた POWERSHELL DSC 構成から、必要な状態を引き続き受け取ることができます。 これにより、データセンター内のオンプレミスの PowerShell DSC 構成に依存しながら、クラウドで Automation DSC &rsquo; の豊富なレポート機能を活用するための選択肢と柔軟性が提供されます。</p>\n\n<p>ここ &rsquo; では、レポート専用マシンが Automation DSC でどのように見えるかの例を示します。 ご覧のように、レポート情報に関しては、他の管理対象コンピューターとまったく同じように見えます。 ただし、Automation DSC によって配信されていないため、ノード構成が割り当てられていません。</p>\n\n<p><img alt=\"Report-only-machine-in-Automation-DSC\" border=\"0\" height=\"220\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6adb2582-df0d-429e-8e87-f94a82810c56.png\" style=\"border-width: 0px; margin-right: auto; margin-left: auto; float: none; display: block;\" title=\"レポートのみ--Automation-DSC\" width=\"480\"></p>\n\n<p>Automation DSC にマシンをオンボードする方法の詳細については、 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-onboarding/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">こちら</a>を参照してください。</p>\n\n<p>Automation DSC のもう1つの興味深いユースケースは、 <a href=\"https://azure.microsoft.com/en-us/blog/azure-vm-scale-sets-public-preview/\">Azure Virtual Machine Scale Sets</a>です。 VM Scale Sets を使用すると、複数の Azure Vm を1つのセットとしてデプロイして管理し、負荷に応じてセットを簡単にスケールインまたはスケールアウトできます。 この機能の利点は、管理オーバーヘッドを削減しながら、パフォーマンスのニーズに合わせてスケールアップして、パフォーマンスのニーズが軽減される場合にコストを削減できるようにすることです。 ただし、VM Scale Sets のユーザーは、一般的に次のようになります。</p>\n\n<ul>\n <li>スケールセット内のマシンが同一であり、構成で同じままであることを確認する方法はありますか</li>\n <li>スケールセット内の既存のマシンと作成済みのコンピューターの構成を簡単に更新するにはどうすればよいですか。</li>\n</ul>\n\n<p>Automation DSC では、構成管理のこの側面に対する非常に単純なアプローチを提供します。 これで、Azure Virtual Machine Scale Sets を構成して、Automation DSC によって管理できるように、セット内のすべてのマシンが自動的にオンボードされるようになりました。 構成が Automation DSC で更新された場合、スケールセット内のすべてのマシンが新しい desired state に自動的に準拠します。スケールセットが拡大するたびに、新しい VM インスタンスも目的の状態に自動的に準拠します。 さらに、スケールセット内のいずれかのマシンが目的の状態から何らかのずれを行う場合は、自動的に修正されます。 また、構成を設定するために Azure Resource Manager テンプレートを更新したり、マシンにリモートで展開したりする必要がなくなります。 Automation DSC によって管理される VM スケールセットを設定する ARM テンプレートの例については、 <a href=\"https://azure.microsoft.com/en-us/documentation/templates/201-vmss-automation-dsc/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">こちら</a>を参照してください。</p>\n\n<p>ご覧のように、Automation DSC では、Windows または Linux 上で簡単にオンプレミスとクラウドのマシンを構成しています。 &rsquo;大規模な構成の管理に関する独自の問題を減らすために、試してみることをお勧めします。</p>\n\n<p>Automation DSC の詳細については、 以下のリンクを確認するか、この <a href=\"https://github.com/azureautomation/automation-packs/tree/master/102-sample-automation-setup\">Azure Resource Manager テンプレート</a> を使用して、Automation DSC によって管理用に事前に構成された仮想マシンを使用して、Azure にサンプル環境をすばやくデプロイします。</p>\n\n<ul>\n <li><a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-overview/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">Automation DSC の概要</a></li>\n <li><a href=\"https://azure.microsoft.com/en-us/pricing/details/automation/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">Automation DSC の価格</a></li>\n <li><a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-onboarding/?wt.mc_id=WW_CE_OMS_OO_BLOG_NONE\">Automation DSC による管理のためのマシンのオンボード</a></li>\n</ul>\n\n<p>Azure Automation を使い始めたばかりですか? <a href=\"https://aka.ms/Q2p1ap\">ここで</a>サービスについて説明し、最新のものについては、 <a href=\"https://twitter.com/AzureAutomation\">Twitter</a>の Azure Automation に従ってください。</p>\n\n<p>このブログ投稿は、最初に Microsoft ハイブリッドクラウド管理ブログで公開され <a href=\"https://blogs.technet.microsoft.com/systemcenter/2016/03/18/configuration-management-in-microsoft-operations-management-suite/\">ています</a>。 このサービスは、Microsoft Azure と Microsoft Operations Management Suite の両方のお客様が使用できるため、Azure の対象ユーザーに対して若干調整されています。</p>"
