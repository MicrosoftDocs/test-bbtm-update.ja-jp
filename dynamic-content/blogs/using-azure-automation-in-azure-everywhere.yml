### YamlMime:Yaml
ms.openlocfilehash: ebb9b80cf3ceb009c102d53969af8681740e818b
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139896364"
Slug: using-azure-automation-in-azure-everywhere
Title: Azure での Azure Automation の使用-あらゆる場所
Summary: 現在、Microsoft Azure のクラウドプラットフォームは、さまざまな国と、ほとんどの国内の複数のリージョンに存在しています。 これは、Microsoft Azure パブリッククラウドと呼ばれることがよくあります。
Content: "<p>現在、Microsoft Azure のクラウドプラットフォームは、さまざまな国と、ほとんどの国内の複数のリージョンに存在しています。 これは、Microsoft Azure パブリッククラウドと呼ばれることがよくあります。 さらに、中国および米国連邦政府のお客様をサポートするために、Microsoft では、これらの市場向けに、 <a href=\"https://www.windowsazure.cn/\">Azure 中国</a> と <a href=\"https://azure.microsoft.com/en-us/features/gov/\">Azure Government cloud</a>という名前の他のクラウドプラットフォームサービスを提供しています。</p>\n\n<p>Azure Automation サービスについては、Microsoft Azure パブリックとその他のクラウドプラットフォームの間で提供される機能に違いがあります。 これは主に、Azure portal によって提供されるものによって区別されます。 Microsoft Azure パブリッククラウドでは、Azure Automation が Azure サービス管理 (<a href=\"https://manage.windowsazure.com\" target=\"_blank\">ポータル</a>) と Azure Resource Manager (<a href=\"https://portal.azure.com\" target=\"_blank\">ポータル</a>) &ndash; の両方をサポートしており、両方のポータルに表示されるすべての機能がサポートされています。 ただし、Azure 中国および Azure Government クラウドでは、Azure Automation は Azure サービス管理と関連付けられているポータル &ndash; のみをサポートし、これらのポータルに表示される機能のみをサポートします。 たとえば、 <a href=\"https://azure.microsoft.com/en-us/blog/announcing-powershell-script-support-azure-automation-2/\">PowerShell スクリプト runbook</a>と <a href=\"https://azure.microsoft.com/en-us/documentation/articles/automation-dsc-overview/\">Azure Automation DSC</a> は、この記事の執筆時点では、Azure 中国と Azure Government クラウドではサポートされていません。</p>\n\n<p>runbook の作成に関しては、これらの Microsoft Azure パブリックとその他のクラウドプラットフォームの主な違いは、サービスエンドポイント (uri) です。 違いは、 <a href=\"https://manage.windowsazure.com/\" target=\"_blank\">azure パブリッククラウド</a>、azure 中国クラウド、 <a href=\"https://manage.windowsazure.us\" target=\"_blank\">Azure Government クラウド</a>など、Azure portal のようなもの &ndash; です。 管理エンドポイント、ストレージエンドポイントなども若干異なります。 Azure Automation Azure、Azure 中国、Azure Government cloud に出荷されている間、同じ Azure Automation runbook (PowerShell スクリプト/ワークフロー) を使用して、さまざまな Azure クラウドプラットフォームでリソースをターゲットにすることができますが、サービスエンドポイントの違いにより、エラーが発生しやすくなります。</p>\n\n<p>このブログ投稿では、 &rsquo; 各クラウドの違いと、Microsoft Azure がサポートする多くのクラウド間でシームレスに動作するように Azure Automation runbook を修正する方法について説明します。</p>\n\n<h2>使用される Uri はどのようなものですか。</h2>\n\n<p>次の表は、各 Azure クラウド内の同じサービスのさまざまな Uri を示しています。</p>\n\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" width=\"630\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><b><font size=\"1\">サービス</font></b></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><b><font size=\"1\">Azure</font></b></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><b><font size=\"1\">Azure China</font></b></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><b><font size=\"1\">Azure Government</font></b></p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><font size=\"1\">管理 API</font></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><font size=\"1\">management.core.windows.net</font></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><font size=\"1\">management.core.chinacloudapi.cn</font></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><font size=\"1\">management.core.usgovcloudapi.net</font></p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><font size=\"1\">Storage</font></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><font size=\"1\">core.windows.net</font></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><font size=\"1\">core.chinacloudapi.cn</font></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><font size=\"1\">core.usgovcloudapi.net</font></p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><font size=\"1\">Active Directory</font></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><font size=\"1\">login.windows.net</font></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><font size=\"1\">login.chinacloudapi.cn</font></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><font size=\"1\">login.windows.net</font></p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><font size=\"1\">Resource Manager API</font></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><font size=\"1\">management.azure.com</font></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><font size=\"1\">management.chinacloudapi.cn</font></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><font size=\"1\">management.usgovcloudapi.net</font></p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"154\">\n   <p><font size=\"1\">[ギャラリー]</font></p>\n   </td>\n   <td valign=\"top\" width=\"193\">\n   <p><font size=\"1\">gallery.azure.com</font></p>\n   </td>\n   <td valign=\"top\" width=\"150\">\n   <p><font size=\"1\">gallery.chinacloudapi.cn</font></p>\n   </td>\n   <td valign=\"top\" width=\"131\">\n   <p><font size=\"1\">gallery.usgovcloudapi.net</font></p>\n   </td>\n  </tr>\n </tbody>\n</table>\n\n<h2>Azure Automation runbook が異なる Azure クラウドを対象とするように構成するにはどうすればよいですか。</h2>\n\n<p>azure リソースを管理するために Azure Automation runbook を接続する方法としては、まず、azure アカウントとサブスクリプションを使用して Windows PowerShell セッションを認証する、 <b>azureaccount</b> PowerShell コマンドレットを使用します。 複数のサブスクリプションがある場合は、 <b>選択-azuresubscription</b> PowerShell コマンドレットを呼び出すことによって、使用するサブスクリプションを選択できます。 両方の呼び出しが成功すると、azure サブスクリプションに接続され、任意の Azure PowerShell コマンドレットを使用して azure リソースを管理できるようになります。 この方法は、すべての Azure クラウドで利用できる Azure サービス管理と連携して動作します。</p>\n\n<p>ただし、runbook のサンプルを Automation ギャラリーからダウンロードした場合や、スクリプトセンターなどの別のソースからダウンロードした場合、runbook のサンプルでは、credential パラメーターを含む、 <b>AzureAccount</b>に必要なパラメーターのみを使用している可能性が高くなります。 <b>AzureAccount</b>コマンドレットは、credential パラメーターのみを使用して、既定で Azure パブリッククラウド環境に設定されます。 そのため、Azure 中国または Azure Government クラウドでこれらの runbook のいずれかを使用している場合、runbook は正常に実行されません。</p>\n\n<p>Runbook を正常に動作させるには、 <b>環境</b> パラメーターも定義する必要があります。</p>\n\n<p>Azure 中国では、 <i>AzureChinaCloud</i> &rdquo; という &ldquo; 既定の環境が既に存在します。この既定の環境は、環境パラメーターを指定して<b>azureaccount</b>コマンドレットを呼び出すときに使用できます。</p>\n\n<p>コードの例:</p>\n\n<pre class=\"prettyprint\">\n    # Call to get the Azure Account to be available for Powershell\n    # The Environment &quot;AzureChinaCloud&quot; is required to indicate URIs specific to Azure China cloud \n    Add-AzureAccount -Credential $AzureOrgIdCredential -Environment &quot;AzureChinaCloud&quot;</pre>\n\n<p>Azure Government については、前に説明した Uri を使用して、 <b>Add AzureEnvironment</b> コマンドレットを使用して Azure Government uri を対象とする環境を作成する必要があります。 <b>AzureEnvironment</b>コマンドレットの Name パラメーター値をメモしておきます。 これは、環境パラメーターを指定して <b>AzureAccount</b> コマンドレットを呼び出すときに渡す必要があるのと同じ値です。</p>\n\n<p>コードの例:</p>\n\n<pre class=\"prettyprint\">\n    # Add an environment where the Azure Account and Subscription resides   \n    Add-AzureEnvironment `\n        -Name &quot;AzureGovernmentCloud&quot; `\n        -PublishSettingsFileUrl &quot;https://manage.windowsazure.us/publishsettings/index?client=xplat&quot; `\n        -ServiceEndpoint &quot;https://management.core.usgovcloudapi.net&quot; `\n        -ActiveDirectoryEndpoint &quot;https://login.windows.net/&quot; `\n        -ActiveDirectoryServiceEndpointResourceId &quot;https://management.core.usgovcloudapi.net/&quot; `\n        -GalleryEndpoint &quot;https://gallery.usgovcloudapi.net&quot; `\n        -ManagementPortalUrl &quot;https://manage.windowsazure.us&quot; `\n        -ResourceManagerEndpoint &quot;https://management.usgovcloudapi.net&quot; `\n        -StorageEndpoint &quot;core.usgovcloudapi.net&quot; \n   \n    # Call to get the Azure Account to be available for Powershell\n    Add-AzureAccount -Credential $AzureOrgIdCredential -Environment &quot;AzureGovernmentCloud&quot;</pre>\n\n<p>その後、単に runbook をテストします。 成功した場合、runbook は、 <b>AzureEnvironment</b> コマンドレットによって指定された Azure クラウドに正常に接続できます。</p>\n\n<p>上記を示す Automation Runbook の例を次に示します。</p>\n\n<ul>\n <li>Azure 中国: <a href=\"https://gallery.technet.microsoft.com/scriptcenter/Connect-to-an-Azure-VM-in-9576fe4a\">https://gallery.technet.microsoft.com/scriptcenter/Connect-to-an-Azure-VM-in-9576fe4a</a></li>\n <li>Azure Government： <a href=\"https://gallery.technet.microsoft.com/scriptcenter/Connect-to-an-Azure-VM-in-61b9e357\">https://gallery.technet.microsoft.com/scriptcenter/Connect-to-an-Azure-VM-in-61b9e357</a></li>\n</ul>\n\n<h2>証明書ベースの認証を使用する場合の考慮事項</h2>\n\n<p><b>AzureAccount</b>コマンドレットを使用せず、代わりに証明書ベースの認証を使用する場合は、 <b>Set azureaccount</b>コマンドレットと environment パラメーターを使用するときに、同じ環境パラメーターを指定してみることができます。</p>\n\n<p>簡単に言えば、Microsoft Azure パブリッククラウド向けに作成された azure サービス管理機能を対象とする Automation runbook は、azure 中国または Azure Government クラウドで、わずかな変更のみで動作できます。  試してみる</p>\n\n<p>Azure Automation を使い始めたばかりですか? <a href=\"https://aka.ms/Q2p1ap\">ここで</a>サービスについて説明し、 <a href=\"https://twitter.com/AzureAutomation\">Twitter</a>の Azure Automation に従います。</p>"
