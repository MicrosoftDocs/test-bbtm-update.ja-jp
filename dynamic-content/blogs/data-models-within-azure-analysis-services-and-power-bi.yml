### YamlMime:Yaml
ms.openlocfilehash: 5e70c70bb18b898d290695c7dc451260a2f467a4
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139904825"
Slug: data-models-within-azure-analysis-services-and-power-bi
Title: Azure Analysis Services と Power BI 内のデータモデル
Summary: セルフサービスと配信速度がどのレポート BI ソリューションでも重要な優先事項である場合、包括的かつ高性能なデータセマンティックモデルレイヤーを作成することの重要性が見落とされることがあります。
Content: >-
  <p>セルフサービスと配信速度がどのレポート BI ソリューションでも重要な優先事項である場合、包括的かつ高性能なデータセマンティックモデルレイヤーを作成することの重要性が見落とされることがあります。</p>


  <p>Azure SQL Database や Azure SQL Data Warehouse などのリレーショナルデータストアが適切に構成されていて、レポート層が reporting services または Power BI SQL Server であるかどうかを確認していますが、それでもパフォーマンスが期待どおりではないという状況が発生しています。</p>


  <p>データセマンティックモデルにドリルダウンする前に、データを理解し、データを提示してレポートする方法が重要であることを常にお勧めします。 データ体験を通じて最終的なコンシューマーを取得するレポートを作成することは、良好なレポートと悪いレポートの違いです。 レポートの設計では、使用しているユーザーと、レポートから実行する対象を考慮する必要があります。 たとえば、追加のメジャーまたは Kpi を使用して下位レベルの階層データを表示する必要があるコンシューマーの数が少ない場合は、最初のページでこれを視覚化することが適していない可能性があります。 コンシューマーの大部分では、より集計されたデータのビューを表示することが必要になる場合があります。 この例では、レポートの最初のページでデータが返されるまでに時間がかかる可能性があります。これにより、実行速度の遅いレポートがほとんどのコンシューマーに認識されます。 エクスペリエンスを向上させるために、データの処理を通じて、詳細レベルが上位レベルのデータポイントに影響しないことを確認することができます。</p>


  <p>適切なサービスレベルアグリーメントとパフォーマンスの期待値を設定することが重要です。 データが200万行の場合は、SLA を2秒未満に設定することをお勧めします。 しかし、20億行だったとしても、これは引き続き満たされますか。 実現できることを理解するには多くの要素があり、データセットのサイズはその1つです。 ネットワーク、コンピューティング、アーキテクチャパターン、データ階層、メジャー、Kpi、コンシューマーデバイス、コンシューマーの場所、およびリアルタイムのバッチレポートは、エンドコンシューマーへのパフォーマンスの認識に影響する可能性がある他の影響です。</p>


  <p>ただし、データセマンティックモデルレイヤーを作成または最適化すると、全体的なパフォーマンスに大きな影響を与えます。</p>


  <h2>基本</h2>


  <p>この質問は、より多くのコンピューティング能力と Azure の使用により、data lake または運用 SQL Server から直接レポートすることができないのはなぜですか。 回答として、データからのレポートは、オンライントランザクション処理 (OLTP) アプローチでのデータの書き込みと読み取りとは大きく異なります。</p>


  <p>キンボールによって開発されたディメンションモデリングは、データウェアハウスの実証済みの手法であり、過去20年間にわたって広く使用されています。 ディメンションモデリングの背後にある信条は、コンシューマーが計算を取得し、データを集計し、ビジネス Kpi を表示できる対話型のレポートを生成できるようにすることです。</p>


  <p>スタースキーマまたはスノーフレークスキーマ内でディメンションモデルを作成することにより、OLTP データベースの設計に関連付けられている読み取りおよび書き込みではなく、取得および読み取り用に設計されているスキーマにより、よりパフォーマンスの高い方法でデータを取得することができます。</p>


  <p>スタースキーマまたはスノーフレークスキーマでは、ファクトテーブルと多数のディメンションテーブルがあります。 ファクトテーブルには、ディメンションテーブルに関連付けられた外部キーと、メトリックおよび Kpi が含まれています。 ディメンションテーブルには、その特定のディメンションテーブルに関連付けられている属性が含まれています。 この例として、月、日、および年を属性として含む date ディメンションテーブルがあります。</p>


  <p>SQL Server や Azure SQL Data Warehouse などのデータウェアハウスのディメンションモデリングを作成することは、レポートソリューションから達成しようとしているものに役立ちます。 ここでも、従来の倉庫は過去20年間にわたって広く導入されています。 このアプローチでも、ウェアハウスの上にデータセマンティックモデルを作成すると、同時実行性を向上させたり、エンドユーザーとソースウェアハウスデータの間にセキュリティレイヤーを追加したりするなど、パフォーマンスを向上させることができます。 SQL Server Analysis Services と現在 Azure Analysis Services は、この目的のために設計されています。 基本的に、ウェアハウスから必要なデータを、次のように使用できるモデルに提供できます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6a9cb218-47e9-43f3-8b54-736722666e00.png"><img alt="image" border="0" height="188" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b4ed4595-07a6-476e-92cf-ae7f01aa861e.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="絵" width="582"></a></p>


  <p>これまで、アーキテクチャはまさにこれとまったく同じでした。 ウェアハウスから Analysis Services のインスタンスに置かれているキューブにデータを取り込み、キューブを処理して、SQL Server Reporting Services、Excel などに提供します。 データの取り込みのランドスケープは、過去 5 ~ 10 年にわたって変更されています。ビッグデータとエンドコンシューマーは、SQL、Spark、CSV、JSON など、さまざまなデータソースを使用することを希望しています。</p>


  <p>最新の BI レポートでは、このデータを取り込み、マッシュアップ、クリーンアップしてから、このデータを提示する必要があります。 そのため、データセマンティックレイヤーはアジャイルである必要がありますが、パフォーマンスにも配信される必要があります。 ただし、ディメンションモデリングに合わせたモデルを設計するための原則は引き続き重要です。</p>


  <p>Azure のデータサービスの世界では、Analysis Services と Power BI は、データウェアハウスのディメンションモデリングに基づくデータセマンティックモデルの構築に適しています。 これらのサービスの基本的な原則は、以前は Microsoft BI ソリューションの基礎を形成してきましたが、最新のメモリ内アーキテクチャを使用し、セルフサービスの機敏性を実現するようになりました。</p>


  <h2>Power BI と Analysis Services テーブルモデル</h2>


  <p>SQL Server Analysis Services テーブルモデル、Azure Analysis Services、および Power BI は、同じ下線の基本と原則を共有します。 これらはすべて、2012の SQL Server で最初にリリースされた表形式モデルを使用して構築されています。</p>


  <p>SQL Server Analysis Services 多次元は異なるアーキテクチャであり、インストールポイントの [サーバーの構成] セクションで設定されています。</p>


  <p>Analysis Service 表形式モデル (Power BI) は、VertiPaq エンジンを形成する、列形式のインメモリアーキテクチャに基づいて構築されています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4bbbd56c-1271-4cbb-a36f-0e3856e1eb4e.png"><img alt="image" border="0" height="182" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/77710497-d17f-433d-9164-737b30d4d925.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="絵" width="250"></a></p>


  <p>処理時にデータの行が列に変換され、エンコードされ、圧縮されて、より多くのデータを格納できるようになります。 データがメモリに格納されているため、分析レポートは、ディスクベースのシステムからデータを取得する場合と比較して、高パフォーマンスを実現します。 インメモリテーブルモデルの目的は、レポートのための読み取り時間を最小限に抑えることです。 ここでも、コンシューマーレポートの動作を理解することが重要です。テーブルモデルは、少数の列を取得するように設計されています。 ここでのバランスは、多数の列を取得する場合、エンジンはデータの行に戻り、計算に影響を与える圧縮を解除する必要があることです。</p>


  <h2>データモデリングのベストプラクティス</h2>


  <p>次のベストプラクティスは、特に SQL Server Analysis Services、Azure Analysis Services、または Power BI でデータセマンティックモデルを作成する場合に、過去数年間に見た主な観察事項を示しています。</p>


  <ul>
   <li>異なるソースのデータを取り込みしている場合でも、ディメンションモデルの星またはスノーフレークを作成します。</li>
   <li>ディメンションテーブルに整数の代理キーを作成していることを確認します。 自然キーはベストプラクティスではなく、後日変更する必要がある場合に問題が発生する可能性があります。 自然キーは一般に文字列であるため、他のテーブルに結合する場合は、サイズが大きくなり、パフォーマンスが低下する可能性があります。 テーブルモデルでのパフォーマンスに関して重要な点は、自然キーが圧縮に最適ではないことです。 自然キーを使用したプロセスは、次のようになります。
   <ul>
    <li>
    <ul>
     <li>エンコードされた、ハッシュ/ディクショナリエンコーディング。</li>
    </ul>

    <ul>
     <li>ディメンションテーブルに関連するファクトテーブルでエンコードされた外部キー (ハッシュ/辞書エンコード)。</li>
    </ul>

    <ul>
     <li>リレーションシップを作成します。</li>
    </ul>
    </li>
   </ul>
   </li>
   <li>これにより、パフォーマンスに影響が生じ、データの使用可能なメモリ量が減少します。この比率は、辞書エンコーディングに必要です。</li>
   <li>整数の代理キーまたは値のエンコードをモデルに取り込み、ディメンションテーブルの自然キーを除外します。</li>
   <li>ディメンションテーブルから、ファクトテーブルの外部キーまたは整数の代理キーのみをモデルに取り込みます。</li>
   <li>分析に必要な列をモデルに取り込むだけで、必要のない列を除外したり、データをフィルター処理して、分析されているデータのみを取り込むことができます。</li>
   <li>値の一意性を減らすことができるようにカーディナリティを減らして、圧縮を大幅に向上させます。</li>
   <li>日付ディメンションをモデルに追加します。</li>
   <li>可能であれば、コンピューティングレイヤーで計算を実行するのが理想的です。</li>
  </ul>


  <p>上記のベストプラクティスは、コンシューマーエクスペリエンスのパフォーマンスを向上させるために、一部または全体で使用されています。 ベストプラクティスに合わせてデータセマンティックモデルを作成した後は、パフォーマンスの予測をも判断、SLA &rsquo; に合わせることができます。 上記のベストプラクティスに重点を置いて、VertiPaq のメモリ内アーキテクチャを使用していることを確認します。 このような大きな部分は、データを可能な限り圧縮できるようにすることです。これにより、モデル内により多くのデータを格納できるだけでなく、効率的な方法でデータについてレポートすることもできます。</p>


  <p>次のブログでは、Microsoft Power BI がより多くの Analysis Services ネイティブ機能を公開し、データセマンティックモデルを統合できるようにする方法について説明します。</p>


  <ul>

  </ul>
