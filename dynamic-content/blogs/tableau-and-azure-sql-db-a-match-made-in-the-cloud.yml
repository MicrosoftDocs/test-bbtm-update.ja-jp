### YamlMime:Yaml
ms.openlocfilehash: 57f67b60371c12f32e8f6ba887dedc00b68fc962
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139892004"
Slug: tableau-and-azure-sql-db-a-match-made-in-the-cloud
Title: 'tableau と Azure SQL DB、クラウドでの一致 '
Summary: '私たちは、オンプレミスのアプローチをレプリケートするだけで、ほとんどのお客様が正常に機能していることを確認しています。 '
Content: >-
  <p style="margin: 0in 0in 8pt;">近年、Microsoft SQL と tableau Engineering のチームは緊密に連携して、2つのプラットフォームにより優れたユーザーエクスペリエンスを提供してきました。 本日は、Azure SQL DB と tableau の間の接続を最適化する方法について、いくつかのアドバイスを共有しています。</p>


  <p style="margin: 0in 0in 8pt;">私たちのチームは、以前に<a href="https://www.tableau.com/about/blog/2016/3/announcing-real-time-analytics-sql-server-2016-our-performance-test-results-51385">SQL Server 2016 の発表</a>と<a href="https://www.tableau.com/about/blog/2016/7/microsoft-azure-sql-data-warehouse-now-generally-available-and-integrated-tableau">Azure SQL Data Warehouse の起動</a>をチーム化しています。 現在、このパートナーシップは、最近の tableau cloud data Brief で詳述されているように、クラウドとオンプレミスの組み合わせで、tableau &rsquo; s の最も一般的なデータソースである SQL Server という事実に依存してい<a href="https://www.tableau.com/resources/CloudDataBrief">ます。 &nbsp; </a></p>


  <p style="margin: 0in 0in 8pt;"><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0e877048-6474-4c81-bbfc-58bc38fc026d.png"></p>


  <p style="margin: 0in 0in 8pt;">Microsoft のエンジニアリングベンチマークと複数のグローバルな顧客契約により、最適な接続性と、両方のプラットフォームの固有の製品を活用する方法について詳しく見ていきます。 このコンテンツを Tableau と共同で共有しています。 <a href="https://www.tableau.com/about/blog/2017/7/optimizing-your-tableau-and-azure-sql-db-connectivity-73451" target="_blank">こちらのブログを参照してください</a>。</p>


  <p style="margin: 0in 0in 8pt;">それ以上の ado を使用しない場合、主な学習は次のようになります。</p>


  <h2 style="margin: 0in 0in 8pt;">すぐに使用可能なエクスペリエンスがうまく機能する</h2>


  <p style="margin: 0in 0in 8pt;">私たちは、オンプレミスのアプローチをレプリケートするだけで、ほとんどのお客様が正常に機能していることを確認しています。 Azure SQL DB では SQL Server 2016 と同じドライバーが使用されるため、本質的に複雑さが軽減されます。 tableau Desktop UI では、オンプレミスまたは azure などのパブリッククラウドで実行されている azure SQL DB、Azure SQL Data Warehouse、または SQL Server 2016 用の1つの SQL Server コネクタがあります。</p>


  <p style="margin: 0in 0in 8pt;"><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/44886b47-1773-4eda-8483-d64d549edfa1.png"></p>


  <h2>Tableau ライブクエリで最適なパフォーマンスが得られる</h2>


  <p>ネットワーク帯域幅を許可することで、tableau のライブクエリモードでは、Azure SQL DB で大量の処理を実行できます。また、データを抽出するのではなく、tableau ユーザーに最新の情報を提供することもできます。 これは、さまざまな Azure SQL DB sku でサイズとパフォーマンスのテストを行うことを意味します。 この経験により、Azure SQL DB の待機時間とスループットは、最も厳しい tableau 要件を満たすことができます。</p>


  <p>たとえば、共同顧客が S0 (10 dtu) から P1 プレミアム (125 dtu) に移行することをお勧めします。これにより、待機時間の問題が即座に削除されます。 コストへの影響は、通常、ユーザーエクスペリエンスの向上と顧客満足度の向上によって相殺されます。</p>


  <h2>その他の Tableau のベストプラクティス</h2>


  <ul>
   <li><strong>日付計算の分離: </strong>可能な限り、事前に計算された情報があります。 Tableau は1回計算し、データベースがインデックスを使用できる場合があります。</li>
   <li><strong>ブール型フィールドを使用する:</strong>&rsquo;True および false のインジケーターとして0および1を使用し、ブール型のフィールドのみを使用します。 一般に高速です。</li>
   <li><strong>Don &rsquo; を変更しないでください</strong> &rsquo; 。値の大文字と小文字の区別がわかっている場合は、比較の中で [大文字/小文字を区別しないでください。&nbsp;</li>
   <li><strong>エイリアスを使用する:</strong> 可能であれば、計算ではなく、Tableau &rsquo; s エイリアス機能を使用してテキストにラベルを付けます。 &rsquo;別名はデータベース &nbsp; に送信されないので、より高速になる傾向があります。</li>
   <li><strong>可能な場合は、書式設定を使用します。</strong> 書式設定のみを使用できる場合は、文字列関数を使用しない &rsquo; でください。 次に、エイリアスを使用してフィールドにラベルを付けます。</li>
   <li><strong>If/ELSEIF を case に置き換えます。</strong>&rsquo;CASE ステートメントの方が一般に高速であるため、この方法をお勧めします。</li>
  </ul>


  <h2>クエリチューニング方法の使用</h2>


  <p>次の方法を使用して、ボトルネックを特定し、対処するために Tableau クエリを &nbsp; 分析しています。</p>


  <ol>
   <li>クエリストアを有効にする</li>
   <li>提供されたワークロードを実行する</li>
   <li>動的管理ビューを使用して DTU 消費を監視し、階層制限に達していないことを確認する</li>
   <li>インデックスの推奨事項と使用状況の確認</li>
   <li>最大実行時間に基づいてステートメントの優先順位を設定する</li>
   <li>上位のクエリと関連する実行プランを確認する</li>
   <li>提案の適用</li>
   <li>&hellip; 処理</li>
  </ol>


  <h2>Azure SQL DB の最適化のための主要なツール</h2>


  <p>一般に Azure SQL Database のお客様には、次のものを使用することをお勧めします。</p>


  <ul>
   <li><a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-query-performance">Azure SQL Database Query Performance Insight</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-advisor-portal">[SQL Database Advisor]</a></li>
  </ul>


  <h3>サービスレベルの制約を確認しています</h3>


  <p>ワークロードの DTU 制限に達しているかどうかを判断するには、次のクエリを実行します。</p>


  <p><code>SELECT [end_time], [avg_cpu_percent], [avg_data_io_percent],<br>

  &nbsp; &nbsp; &nbsp; &nbsp;[avg_log_write_percent], [avg_memory_usage_percent]<br>

  FROM [sys].[dm_db_resource_stats];</code></p>


  <p>これにより、過去1時間に15秒ごとに1行が返されます。 これを使用して、提供されたワークロードをテストし、次のレベルに進む必要があるかどうかを判断しました。 このデータの詳細なビューを表示するには、master データベースのカタログビューを使用し <strong>sys.resource_stats </strong>ます。</p>


  <h3>インデックスの推奨事項と使用状況の監視</h3>


  <p><em>欠落したインデックスの推奨事項を定期的に確認する</em></p>


  <p>さまざまなワークロード特性がある Tableau customer の場合は、欠落したインデックスの推奨事項を定期的に確認することをお勧めします。 &rsquo;すべての推奨事項を任意に追加することはお勧めしませんが、時間の経過と共に特定の推奨事項のコストとメリットを定期的に評価することをお勧めします。&nbsp;</p>


  <p><code>SELECT [migs].[group_handle], [migs].[unique_compiles], [migs].[user_seeks],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [migs].[user_scans], [migs].[last_user_seek], [migs].[last_user_scan],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [migs].[avg_total_user_cost], [migs].[avg_user_impact],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [migs].[system_seeks], [migs].[system_scans],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [migs].[last_system_seek], [migs].[last_system_scan],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [migs].[avg_total_system_cost], [migs].[avg_system_impact],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mig].[index_group_handle], [mig].[index_handle], [mid].[index_handle],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mid].[database_id], [mid].[object_id], [mid].[equality_columns],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mid].[inequality_columns], [mid].[included_columns],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mid].[statement]<br>

  FROM [sys].[dm_db_missing_index_group_stats] AS [migs]<br>

  INNER JOIN [sys].[dm_db_missing_index_groups] AS [mig]<br>

  ON ( [migs].[group_handle] = [mig].[index_group_handle] )<br>

  INNER JOIN [sys].[dm_db_missing_index_details] AS [mid]<br>

  ON ( [mig].[index_handle] = [mid].[index_handle] );</code></p>


  <p><em>時間の経過によるインデックスの使用状況の検証</em></p>


  <p>逆に、インデックスが長期間にわたって重みを取得していることを確認することをお勧めします。 インデックスによっては、長期間にわたって役に立たない場合があるため、次の該当する動的管理ビューを使用してインデックスの使用状況を確認することをお勧めします。&nbsp;</p>


  <p><code>SELECT OBJECT_NAME([s].[object_id]) AS [Table Name],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [i].[name] AS [Index Name], [s].[user_seeks], [s].[user_scans],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [s].[user_lookups], [s].[user_updates], [s].[last_user_seek],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [s].[last_user_scan], [s].[last_user_lookup], [s].[last_user_update],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [s].[system_seeks], [s].[system_scans], [s].[system_lookups],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [s].[system_updates], [s].[last_system_seek], [s].[last_system_scan],<br>

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [s].[last_system_lookup], [s].[last_system_update]<br>

  FROM [sys].[dm_db_index_usage_stats] AS [s]&nbsp;<br>

  INNER JOIN [sys].[indexes] AS [i]&nbsp;<br>

  ON [s].[object_id] = [i].[object_id]<br>

  AND [i].[index_id] = [s].[index_id]<br>

  INNER JOIN [sys].[objects] AS [o]<br>

  ON [i].[object_id] = [o].[object_id]<br>

  WHERE OBJECTPROPERTY([s].[object_id], &#39;IsUserTable&#39;) = 1<br>

  ORDER BY [s].[user_updates] DESC;</code></p>


  <h3>ベスト プラクティス</h3>


  <ul>
   <li>時間をかけて監視し、 <em>すべて </em>の代表的なワークロードがテスト期間にわたって実行されていることを確認せずに、インデックスを削除しないようにします。</li>
   <li>一意性を定義するために使用されるインデックスの削除については注意してください。 インデックスは、検査に使用することはできませんが、推定と適用のために必要になる場合があります。</li>
   <li>インデックスの使用状況を監視するための最適なシナリオは、インデックスが作成されたときに便利で使用できるかどうかが不明な場合です。 インデックスを追加し、ワークロードを実行して、sys.dm_db_index_usage_stats を確認することができます。 プランを確認することもできますが、ワークロードの規模が大きい場合は、DMV のチェックが高速になります。</li>
  </ul>


  <p>この機能が役立つことを願っています。また &rsquo; 、tableau と Azure SQL DB の使用方法に関するコメントやフィードバックをお寄せください。 また、 <a href="https://www.tableau.com/about/blog/2017/7/optimizing-your-tableau-and-azure-sql-db-connectivity-73451" target="_blank">Tableau&#39;s ブログ</a>を確認することもお勧めします。 このシナリオを初めて使用する場合は、<a href="https://www.tableau.com/products/trial">試用版のライセンスキー</a>で tableau を利用できます。 azure の<a href="https://azure.microsoft.com/en-us/free/">無料試用版</a>を試して、azure SQL DB に対して使用できる特典のロックを解除してください。 Tableau Server は、 <a href="https://azure.microsoft.com/en-gb/blog/tableau-server-in-the-azure-marketplace/">Azure Marketplace</a>ですぐに使用できるイメージとしても利用できます。</p>


  <p>&rsquo;より複雑なデプロイシナリオを検討していて、tableau と azure のスキルをアップグレードする場合は、 &rsquo; <a href="https://azure.microsoft.com/en-us/blog/announcing-integrated-cloudera-cdh-with-tableau-server-solution-on-azure/">Tableau と Cloudera のクイックスタートの azure テンプレート</a>を参照することをお勧めします。</p>


  <p>また、 <a href="https://twitter.com/AzureSQLDB">Twitter で Azure SQL DB チーム</a>に接続して接続することもできます。</p>


  <h2>謝辞</h2>


  <p>この記事では、複数の担当者の間のコラボレーションについて説明します。 Dan Cory (Tableau)、Caudron (Microsoft) &nbsp; 、Gil Isaacs (microsoft) に &nbsp; 感謝します。</p>


  <div>

  <div id="_com_1" uage="JavaScript">&nbsp;</div>

  </div>
