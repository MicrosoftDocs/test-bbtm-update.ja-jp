### YamlMime:Yaml
ms.openlocfilehash: 30cf5314d605585a1d7da4ab93efd0c27fc5a37e
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139909500"
Slug: the-top-10-things-to-know-when-running-sql-server-workloads-on-windows-azure-virtual-machines
Title: Azure Windows でワークロードを実行するときに知Windows 1 SQL Server 0 Virtual Machines
Summary: >-
  この記事は最新ではありません。 最新の情報については、「Azure SQL Server」および「Azure VM Virtual Machinesの価格の詳細SQL Serverを参照してください。

  の可用性を発表した時。
Content: >-
  <strong>この記事は最新ではありません。最新の情報については、「</strong>Azure SQL Server」の「Virtual Machines」と「<a href="https://msdn.microsoft.com/library/azure/jj823132.aspx">Azure VM</a> SQL Server<a href="https://azure.microsoft.com/en-us/pricing/details/virtual-machines/#sql-server">の価格の詳細」を参照してください</a>。

  <p class="Publishwithline">2012 年 6 月に Windows Azure Virtual Machines および Virtual Network プレビュー (これら 2 つのサービス セット <a href="https://azure.microsoft.com/en-us/home/scenarios/infrastructure-services/" target="_blank">Windows Azure Infrastructure Services</a> と呼ばれる) の可用性を発表すると、世界中の組織が Microsoft SQL Server ワークロードのテストを開始し、プレビューを制限にプッシュしました。 Azure Infrastructure Services を使用すると、Windowsを実行できます。 ハードウェアを調達して管理することなく、さまざまな種類の SQL Server ワークロードを低コストで実行できる仮想マシン (VM) を迅速にデプロイできる機能には、大きな魅力があります。 仮想ネットワークでの複雑なマルチ VM デプロイの実行、Active Directory (AD)のサポート、SharePoint のサポート、仮想プライベート ネットワーク (VPN) ゲートウェイを使用して仮想ネットワークをオンプレミス ネットワークまたはリモート マシンに接続する機能は、IT ショップや開発者向けのオフオンプレミス ホスティング環境としてさらに興味深いものになります。 Windows Azure インフラストラクチャ サービスは、組織が既存のワークロードの一部をクラウドに移行するために使用できる足がかりです。変更は加え"ない"一方で、ハイブリッドな方法で Windows Azure の最新の "サービスとしてのプラットフォーム" 機能を利用できます。 組織では、シンプルな開発とテスト、ワークロードのテストSQL Server複雑な分散ミッション クリティカルなワークロードまで、すべてを実行しているのを見ていました。 彼らの経験から学んだいくつかのことを次に示します。</p>


  <ol start="1">
   <li><strong><span style="text-decoration: underline;">SLA を知る:</span></strong>そのサーバーを取り外し、SQL Server ワークロードWindows Azure に移行する前に、関連するサービス レベル アグリー<a href="https://azure.microsoft.com/en-us/support/legal/sla/" target="_blank">メント (SLA</a>) を理解する必要があります。 注意する必要がある重要な点は、次のステートメントです。"同じ可用性セットに 2 つ以上のインスタンスがデプロイされているインターネットに接続している Virtual Machines の場合、少なくとも 99.95% の時間が外部接続を持つことが保証されます。"これは、データの観点からSQL Server意味しますか? つまり、この SLA の対象となるには、SQL Server を実行している複数の VM をデプロイし、それらをすべて同じ可用性セットに追加する必要があります。 詳細 <a href="https://azure.microsoft.com/en-us/manage/windows/common-tasks/manage-vm-availability/" target="_blank">については、「Virtual Machines</a> の可用性の管理」を参照してください。 また、可用性セット内のすべての仮想マシン間でデータベースが確実に同期されている場合は、<a href="https://msdn.microsoft.com/en-us/library/ms190202.aspx" target="_blank">SQL Server</a> 高可用性ソリューションを実装する必要があります。 要するに、これらのワークロードがオンプレミスで実行されている場合と同様に、クラウドで高可用性を確保するために何らかの作業を行う必要があります。 可用性セットを適切に構成すると、アップグレードやハードウェアの更新SQL Serverメンテナンス操作中でも、ワークロードが引き続き実行されます。</li>
   <li><strong><span style="text-decoration: underline;">サポート ポリシーを知る:</span></strong><strong><span style="text-decoration: underline;">
  </span></strong>Azure SQL Server Azure Windows でVirtual Machinesを実行する場合の美しいのは、他の場所で SQL Server実行するのと非常に似たことです。 それで機能します。 アプリケーションを変更したり、さまざまな機能がサポートされているかどうかを心配SQL Serverする必要はありません。 ほとんどのSQL Server機能は、いくつかの重要な例外を除き、Windows Azure Infrastructure Services で実行する場合に完全にサポートされます。 まず、バージョンのサポートSQL Serverしましょう。 Microsoft では、Azure Infrastructure Services SQL Server 2008 以降のバージョンに対してWindowsサポートを提供しています。 SQL Server 2005 以前でワークロードを実行している場合は、サポートを受け取るには、新しいバージョンにアップグレードする必要があります。 アップグレードする場合は、2012 年 2012 年SQL Server勧めしています。 管理ツール、開発ツール、および基になるデータベース エンジンで Windows Azure をネイティブでサポートする "クラウド対応" に設計されています。まず、高可用性について話し合います。 Azure Infrastructure Services での SQL Server デプロイ用の高可用性ソリューションの実装について心配する必要Windowsない場合は、もう一度考えてみます。 前のセクションで説明したように、SLA の対象となるには、仮想マシンの可用性セットに何らかの種類のデータベース冗長性を実装する必要があります。 ただし、高可用性機能に影響を与SQL Server制限があります。 まず、フェールオーバー <a href="https://msdn.microsoft.com/en-us/library/ms189134.aspx" target="_blank">クラスタリングSQL Serverは</a>サポートされていません。 <a href="https://msdn.microsoft.com/en-us/library/hh510230.aspx" target="_blank">AlwaysOn 可用性グループ</a> などの高可用性構成で SQL Server をデプロイする場合や、データベース ミラーリングやログ配布などのレガシ機能を使用する場合は、パニックに陥らないでください。<a href="https://msdn.microsoft.com/en-us/library/ms189852.aspx" target="_blank"></a> <a href="https://msdn.microsoft.com/en-us/library/ms187103.aspx" target="_blank"></a> 高可用性を実現するには、SQL Server 2012 の AlwaysOn 可用性グループ 機能を使用することをお勧めしますが、このルートに進む場合は注意する必要がある考慮事項があります。 <a href="https://msdn.microsoft.com/en-us/library/hh213417.aspx" target="_blank">可用性グループ リスナーは</a> 現在サポートされていませんが、近い将来にこのサポートを追加する予定です。 リスナーのサポートを待てないが、引き続き AlwaysOn 可用性グループを使用する場合は、回避方法があります。 代わりに <em>FailoverPartner</em> 接続文字列属性を使用できます。 この方法では、AlwaysOn 可用性グループ内の 2 つのレプリカ (1 つのプライマリと 1 つのセカンダリ) に制限され、読み取り可能なセカンダリの概念はサポートされていないことに注意してください。 詳細<a href="https://msdn.microsoft.com/en-us/library/ms175484.aspx" target="_blank">についてはConnect データベース ミラーリング セッションへのクライアントの接続に関</a>するページを参照してください。</li>

  </ol>

  次に、データベースのストレージを構成するときに適用される重要な考慮事項SQL Serverしましょう。 一般に、1 つのデータ ディスクを VM に接続し、それを使用してすべてのデータ ファイルとログ ファイルを格納することをお勧めします。 複数のデータ ディスクにデータ ファイルとログ ファイルを分散して、より多くのストレージ容量を取得したり、パフォーマンスを向上させる場合は、geo レプリケーションを <a href="https://blogs.msdn.com/b/windowsazurestorage/archive/2011/09/15/introducing-geo-replication-for-windows-azure-storage.aspx" target="_blank">有効にすべきではありません</a>。 geo レプリケーションは複数のディスク構成では使用できません。複数のディスク間の一貫した書き込み順序は保証されません。


  ここで説明する最後の側面は、レプリケーション、<a href="https://msdn.microsoft.com/en-us/library/bb522893.aspx" target="_blank">Service Broker</a>、分散トランザクション、分散クエリ、リンク サーバーなど<a href="https://msdn.microsoft.com/en-us/library/ms151198.aspx" target="_blank"></a>、SQL Server がサポートするさまざまな "<a href="https://msdn.microsoft.com/en-us/library/ms191440%28v=SQL.105%29.aspx" target="_blank"></a>分散" 機能です<a href="https://msdn.microsoft.com/en-us/library/ms188721%28v=SQL.105%29.aspx" target="_blank"></a>。 <a href="https://msdn.microsoft.com/en-us/library/ms188279.aspx" target="_blank"></a>これらのすべては、同じ仮想ネットワークにデプロイされている SQL Server VM 全体で問題ありませんが、その境界を越え始めたら (パブリック インターネットまたは仮想ネットワーク VPN ゲートウェイを使用して) 十分にテストする必要があります。 これらの機能は、パブリック インターネット全体ではなく、オンプレミスのデータ センター、LAN、および WAN で使用するように設計されています。


  詳細については、ハードウェア仮想化環境で実行Microsoft SQL Server製品のサポート ポリシーに関する<a href="https://support.microsoft.com/kb/956893" target="_blank">記事をご覧</a>ください。

  <strong></strong>

  <ul>
   <li><strong><span style="text-decoration: underline;">ライセンスを知る:</span></strong>Windows Azure Infrastructure Services で SQL Server デプロイのライセンスを取得する最初の (最も簡単な) 方法は、イメージ ギャラリーで事前構築済みの SQL Server プラットフォーム イメージのいずれかを使用して新しい仮想マシンを作成する方法です。 この方法を使用<a href="https://azure.microsoft.com/en-us/pricing/details/virtual-machines/">すると</a>、選択したサービスのエディション (SQL Server、Standard、または Web) に応Enterprise分の料金が支払います。 プロダクト キーやアクティブ化などについて心配する必要はありません。また、新しくプロビジョニングされた VM に数分SQL Serverアクセスできます。 1 分あたりに課金され、最小値は発生し"ない" 点に注意してください。 詳細<a href="https://azure.microsoft.com/en-us/manage/windows/common-tasks/install-sql-server/">については、「SQL Server Azure での仮想マシンWindowsプロビジョニング」</a>を参照してください。 Microsoft は VM 内を参照しないので、プラットフォーム イメージを使用してプロビジョニングされた VM から SQL Server をインストール解除した場合、VM を破棄しない限り、引き続き SQL Server の使用に対して課金されます。2 番目のオプションは、"独自の VM を持ち込む" 方法です。 これには、オンプレミスで独自の Hyper-V VM を構築し、SQL Serverを Azure にアップロードするWindowsがあります。 この<a href="https://azure.microsoft.com/en-us/manage/windows/common-tasks/upload-a-vhd/">方法のガイダンスについては、「</a>仮想ハード ディスクの作成とアップロード」をWindowsサーバー オペレーティング システムを含む仮想ハード ディスクの作成とアップロードに関するページを参照してください。 独自の VM を持ち込む場合、Windows Server オペレーティング システム ライセンスのコストは 1 時間のコンピューティング料金に組み込されますが、これは SQL Server などの他のサーバー製品では当てはめず、VM が Microsoft ライセンス ポリシーに準拠している必要があります。 既定では、SQL Server などのサーバー製品は、仮想化された構成または Azure Infrastructure Services などのホスティング環境で実行Windowsライセンスされません。 Microsoft では、SQL Serverワークロードを実行するか、開発/テスト ワークロードを実行するかに応じて、このシナリオに対してさまざまな種類のライセンス オプションを提供しています。</li>
  </ul>

  &nbsp;


  ワークロードに基SQL Server運用を実行するには、ソフトウェア メンテナンスを購入する必要があります。 詳細については <a href="https://www.windowsazure.com/en-us/pricing/license-mobility/">、「Microsoft ソフトウェア アシュアランスによるライセンス モビリティ</a> 」を参照してください。 ライセンスの観点からは、オンプレミスで必要SQL Serverのエディションと数と同じライセンスが必要になります。 たとえば、オンプレミスで SQL Server Standard または Enterprise Edition コア ベースのライセンスを使用する場合、ソフトウェア アシュアランス を使用して、これらのコア ライセンスを azure Windowsできます。 仮想マシンごとに少なくとも 4 つのコア ライセンスが適用されます。そのため、適切なサイズの仮想マシンを選択します。 オンプレミスのサーバーにライセンスを再割り当てする場合は、90 日間待機する必要があります。 ワークロードの開発/テストSQL Server実行する場合は、MSDN サブスクリプション、Pro、または Ultimate サブスクリプションプレミアム購入を検討する必要があります。MSDN サブスクリプションに含まれるソフトウェアの多く (SQL Server を含む) を VM に追加コストでインストールできます。詳細<a href="https://azure.microsoft.com/en-us/pricing/member-offers/msdn-benefits/">についてはWindows MSDN サブスクライバー向け Azure 特典に</a>関するページを参照してください。


  独自の SQL Server VM を作成する場合は、<strong>SysPrep</strong> ユーティリティを使用して SQL Server VM イメージの準備を大幅に簡略化する SQL Server 2012 SP1 への累積的な更新プログラムで発表された最近の機能強化に注意する必要があります。 詳細<a href="https://blogs.technet.com/b/scvmm/archive/2013/01/25/expanded-sysprep-support-in-sql-server-2012-sp1-cu2.aspx">については、「Expanded SysPrep Support in SQL Server 2012 SP1 CU2</a>」を参照してください。


  AlwaysOn SQL Serverデプロイの場合、"無料のパッシブ フェールオーバー インスタンス" ライセンス特典は、Windows Azure Infrastructure Services (または他のホスティング環境) で実行されている SQL Server デプロイには適用されません。 この利点は、オンプレミスのデプロイ (つまり、共有ホスティング環境を含むデプロイ) にのみ適用されます。 つまり、すべてのレプリカで、完全にライセンスされた SQL Server Enterprise Edition が必要になります。 これらのすべての詳細を確認する場合は、「SQL Server <a href="https://download.microsoft.com/download/7/3/C/73CAD4E0-D0B5-4BE5-AB49-D5B886A5AE00/SQL_Server_2012_Licensing_Reference_Guide.pdf">2012 ライセンス ガイド」を参照してください</a>。

  <ul>
   <li><strong><span style="text-decoration: underline;">ハードウェアとネットワークのStorage:</span></strong> このセクションでは、CPU、RAM、I/O、ネットワークの観点から Windows Azure Infrastructure Services のパフォーマンス特性を確認します。 Microsoft は、Windows Azure Infrastructure Services で非常に競争力のあるコストで優れたコンピューティングとストレージのパフォーマンスを提供する取<a href="https://www.windowsazure.com/en-us/pricing/details/virtual-machines/" target="_blank"></a>り組みです (詳細については、「仮想マシンの価格の詳細」を参照してください)。 ただし、クラウドの中核となる価値提案は、コストの高い専用のビッグ コアにスケールアップするのではなく、共有された低コストのコンピューティングとストレージ インフラストラクチャを使用してスケールアウトする必要があります。 多くの大規模な組織では、既に独自のプライベート クラウドで SQL Server ワークロードの一部またはすべてが仮想化されているが、一部のハードコア SQL Server はパフォーマンスと信頼性に対して依然として疑心的なままである。 レコードに対してだけSQL Server仮想化は完全にサポートされ、ここに残っています。 しかし、大きな高価なサーバーと記憶域サブシステムでスケールアップする場合に可能な VM を使用して、同じレベルのパフォーマンスを実現することはできません。Windows Azure Virtual Machines は共有クラスター内の商品サーバーでホストされ、Windows Azure ディスク (OS およびデータ ディスク) は、冗長性が組み込みの共有ストレージ サービスである Windows Azure Storage を使用して実装されます。 CPU の観点からは、仮想化の料金を支払います。 IO の観点からは、共有冗長ストレージの料金を支払います。 そのため、高度にチューニングされたミッション クリティカルな SQL Server OLTP ワークロードを Windows Azure Infrastructure Services にリフトアップする前に、パフォーマンス、スループット、待機時間に関するホームワークを行う必要があります。 計画とテストを十分に行う場合、一般的なワークロードの大部分SQL Serverは、Azure 仮想マシンWindows実行できます。 ただし、この種の環境に適したパフォーマンスに影響を受け取る "スケールアップ" ワークロードの割合は少なめです。</li>
  </ul>

  &nbsp;


  CPU から始めしましょう。 仮想コアのクロック速度や他の特性は、使用するホスト サーバーの種類によって多少異なる場合があります。 少なくとも中規模の VM インスタンス (A2) を使用する必要があります。この場合、SQL Server約 4 GB の RAM が必要になります。 A2 以上の VM では専用の仮想コアが提供されます。そのため、同じホスト上の他の VM と仮想コアを共有する必要がなさそう。 選択した VM サイズに応じて、2 つの仮想コア (A2) から 8 つの仮想コア (特大の A4 VM 以上) まで、どこからでも取得できます。


  次に、RAM を見てみしましょう。 ビッグ データ セットSQL ServerワークロードAnalysis Services読み取り集中型の読み取りには、多くの場合、そのすべてのデータを最適なパフォーマンスのためにメモリにキャッシュするために大量の RAM が必要です。 キャッシュ ヒット率が低下傾向SQL Server場合は、より大きな VM サイズに移行して RAM を多く取得できます。 中規模 (A2) VM 内の 3.5 GB の RAM から、高メモリ A7 VM の 56 GB RAM まで、任意の場所で取得できます。 コストを制御するには、VM のサイズを設定するときに控えめである必要があります。 小規模な VM でワークロードをテストし、パフォーマンスが許容される可能性を確認します。 必要に応じて、後でいつでも大きな VM サイズにアップグレードできます。


  次に、ストレージのパフォーマンスを調べしましょう。 前に説明したように、お使いの VHD (OS ディスクとデータ ディスクの両方) は Windows Azure ディスクを使用して実装されます。これは、共有ディスク サブシステム内のホスト サーバーにローカルにキャッシュされる特殊な種類の Windows Azure Storage ページ BLOB です。 ローカル冗長は組み込みであり、geo 冗長性は追加のオプションです。 ローカルにキャッシュされた VHD をバッキングするページ BLOB は、REST API の高速相互接続経由でアクセスされる共有ストレージ サービスにリモートで格納されます。 詳細については、「データシリーズ: Azure ドライブ、ディスク、イメージの Windows」をご覧ください。 ここまでで、Azure ディスク Windows のパフォーマンス特性、構成、および動作は、ローカルに接続されているストレージまたは san と大きく異なることを理解しておく必要があります。


  では、ストレージ容量についてはどうでしょうか。 まず、非常に小さい場合を除き、データベースを OS ドライブに保存しないでください。 データベース (tempdb を含む) に D: 一時ドライブを使用しないでください。再起動後にこのドライブに格納されているデータが失われ、一時ドライブで予測可能なパフォーマンスが得られない可能性があります。 1つのデータディスクを VM に接続し、それを使用してすべてのユーザーデータベースを格納することをお勧めします。 詳細については、「 <a href="https://azure.microsoft.com/en-us/manage/windows/how-to-guides/attach-a-disk/" target="_blank">データディスクを仮想マシンに接続する方法</a> 」を参照してください。 データディスクのサイズは最大 1 TB で、A4 またはそれ以上の VM で最大16台のドライブを使用できます。 データベースが 1 TB を超える場合は SQL Server<a href="https://msdn.microsoft.com/en-us/library/ms179316%28v=SQL.105%29.aspx" target="_blank">ファイルグループ</a>を使用して、複数のデータディスクにデータベースを分散させることができます。 また、Windows Server 2012 で<a href="https://technet.microsoft.com/en-us/library/hh831739.aspx" target="_blank">記憶域スペース</a>を使用して、複数のデータディスクを1つの大きなボリュームにまとめることもできます。 記憶域スペースは、Windows Azure Storage の追加専用の性質で正しく機能するため、レガシ OS ストライピングテクノロジよりも優れています。 前のセクション2で説明したように、複数のデータディスクを使用する場合は、geo レプリケーションを有効にしないでください。 1秒あたりの入力/出力操作 (IOPS) は、SQL Server ワークロードのディスクパフォーマンスを測定するために使用される重要なメトリックになる傾向があります。 Windows Azure ディスクで実行できる IOPS はいくつあるでしょうか。 その答えは、IOs のサイズとアクセスパターンによって異なります。 8 KB の IOs を実行している読み取り/書き込み率が60/40 の場合、ターゲットは、1つのディスクに対して最大 500 IOPS を提供することになります。 もっと大きくする必要がありますか。 データディスクを追加し、それらの間にデータベースワークロードを分散させます。 大規模なデータベースを作成または復元する場合は、 <a href="https://msdn.microsoft.com/en-us/library/ms175935%28v=SQL.105%29.aspx" target="_blank">ファイルの瞬時初期化</a> を使用して、パフォーマンスを向上させる必要があります。


  ネットワーク帯域幅と待機時間に関する最後のポイントです。 Vm には、サイズに基づいて一定量のネットワーク帯域幅が割り当てられます。 この割り当ては、データ転送とバックアップのパフォーマンスに影響を与える可能性があるため、データを大量に移動する場合は、より大きな VM サイズを使用することを検討してください。 パブリックエンドポイントまたは VPN ゲートウェイ経由で Vm に接続する場合は、インフラストラクチャがパブリックインターネット経由でアクセスされていることに注意することが重要です。 Vm は物理的な場所から離れており、高度なセキュリティオプションが有効になっているロードバランサーやゲートウェイなどの高度なネットワークインフラストラクチャの背後に置かれています。 これにより、ネットワーク待機時間が増加し、待機時間の短いネットワークに依存する多くの種類の操作に対して異なるアプローチが必要になります。 たとえば、大規模なデータベースをクラウドに移行すると、非常に長い時間がかかり、クラウド形式のネットワーク待機時間用に設計されていないクライアントアプリケーションが正常に動作しなくなる場合があります。 ネットワークについては、次のセクションで詳しく説明します。


  VM のサイズとオプションの詳細については、「 <a href="https://msdn.microsoft.com/en-us/library/dn197896.aspx" target="_blank">仮想マシンクラウドサービスのサイズ</a>」を参照してください。 パフォーマンスのベストプラクティスの詳細については、 <a href="https://go.microsoft.com/fwlink/?LinkId=306266" target="_blank">Windows Azure Virtual Machines の SQL Server のパフォーマンスに関するガイダンス</a>を参照してください。

  <ul>
   <li><strong><span style="text-decoration: underline;">まず、ネットワークを計画</span></strong>します。 Azure インフラストラクチャサービスでは、VM デプロイのためのさまざまなネットワーク接続オプションが提供さ Windows ます。 Vm を作成する前に、ネットワーク構成を計画しておく必要があります。これは、誤って作成した場合に最初から開始する必要がないようにするためです。 リモートデスクトップを使用して、デスクトップから個々の Vm に接続し、管理することができます。 詳細については<a href="https://azure.microsoft.com/en-us/manage/windows/how-to-guides/log-on-a-windows-vm/" target="_blank">、「Windows Server を実行する仮想マシンにログオンする方法</a>」を参照してください。 パブリックインターネットから Vm への接続を許可する場合は、エンドポイントを使用してポートを開くことができます。 詳細について <a href="https://azure.microsoft.com/en-us/manage/windows/how-to-guides/setup-endpoints/" target="_blank">は、「仮想マシンとの通信を設定する方法」を</a> 参照してください。 インターネット経由で SQL Server をリモートで管理する場合は、standard SQL Server ポート1433で VM へのアクセスを許可するエンドポイントを作成できますが、このポートはハッカーによく知られているため、SQL Server エンドポイントにはランダムなパブリックポートを使用することをお勧めします。 Vm のコレクション全体で、エンドポイントへの着信接続を自動的に負荷分散することができます。 詳細については、「 <a href="https://azure.microsoft.com/en-us/manage/windows/common-tasks/how-to-load-balance-virtual-machines/" target="_blank">負荷分散 Virtual Machines</a> 」を参照してください。 これは、フロントエンド web サーバーを複数の VMs.In 順にスケールアウトして vm 間の完全な接続を確立する場合などに便利です。最初に<a href="https://azure.microsoft.com/en-us/manage/windows/fundamentals/networking/" target="_blank">Windows Azure Virtual Network</a>を作成してから、新しい仮想ネットワーク内に vm を作成する必要があります。 新しい Vm には、仮想ネットワーク構成で指定された範囲を使用して IP アドレスが自動的に割り当てられますが、独自の DHCP サービスを実装する必要はありません。 仮想ネットワークには、組み込みの DNS が付属しています。または、独自の DNS サーバーをデプロイすることもできます。 詳細については、「Azure の名前解決の Windows」を参照してください。 続行する前に、名前解決を十分にテストする必要があります。 ネットワークに関する専門知識があまりない場合は、続行する前に同僚に構成をレビューしてください。そのため、ユーザーがコーナーに戻ってくることはありません。</li>
  </ul>

  &nbsp;


  これで、本当に興味深いものになります。 セキュリティで保護された VPN ゲートウェイを使用して、企業ネットワークと仮想ネットワークの間にサイト間接続を確立できます。 これを行うには、企業ネットワーク上に VPN デバイスが必要です。 VPN ゲートウェイを確立するときに、専用 VPN デバイスとソフトウェアベースのオプションの両方がサポートされています。 詳細については <a href="https://azure.microsoft.com/en-us/manage/services/networking/cross-premises-connectivity/" target="_blank">、「クロスプレミス接続用の Virtual Network を作成する</a> 」を参照してください。 また、コンピューターから仮想ネットワークへの VPN 接続を使用して、ポイント対サイト接続を確立することもできます。これは、リモートの場所から仮想ネットワークにアクセスする必要がある開発者や管理者にとって最適です。 詳細については、「管理ポータルでのポイント対サイト VPN の構成」を参照してください。


  ほとんどの Windows サーバーの展開では、通常、id とセキュリティに Active Directory (AD) が使用されます。 Windows Azure インフラストラクチャサービスでは、Active Directory デプロイオプションがすべてサポートされています。 仮想ネットワーク内の vm のみで使用されるスタンドアロン AD デプロイが必要な場合は、「 <a href="https://azure.microsoft.com/en-us/manage/services/networking/active-directory-forest/" target="_blank">Windows Azure に新しい Active Directory フォレストをインストール</a>する」を参照してください。 VPN ゲートウェイを実装する場合は、仮想ネットワーク内の VM を会社の Active Directory にドメイン参加させることができます。 このシナリオでは、パフォーマンスと信頼性を向上させるために、読み取り専用の AD ドメインコントローラーを仮想ネットワークに展開するのが理にかなっています。 これを行う方法については<a href="https://azure.microsoft.com/en-us/manage/services/networking/replica-domain-controller/" target="_blank">、「Windows Azure 仮想ネットワークにレプリカ Active Directory ドメインコントローラーをインストール</a>する」を参照してください。 また、Active Directory フェデレーションサービス (AD FS) や Windows Azure で実行されている他のクラウドサービスにまたがるハイブリッド id シナリオのサポートなど、さらに強力な AD 構成もサポートされています。 詳細については、Windows Azure Active Directory を参照してください。

  <ul>
   <li><strong><span style="text-decoration: underline;">Vm のタイムゾーンを UTC に設定する</span></strong> Vm のタイムゾーンを UTC に設定することを検討してください。 Windows Azure インフラストラクチャサービスでは、すべてのデータセンターとリージョンで UTC が使用されます。 UTC タイムゾーンを使用すると、将来的には発生する可能性のある夏時間の問題を回避することができます。 クライアントは、もちろんローカルタイムゾーンを使用します。</li>
   <li><strong><span style="text-decoration: underline;">データとバックアップ</span></strong>の SQL Server 圧縮機能を使用すると、CPU のオーバーヘッドを最小限に抑えながら i/o パフォーマンスを向上させるのに役立つ<a href="https://technet.microsoft.com/en-us/library/cc280449.aspx" target="_blank">データ圧縮</a>機能と<a href="https://technet.microsoft.com/en-us/library/bb964719.aspx" target="_blank">バックアップ圧縮</a>機能がサポートされます。 データとバックアップを圧縮すると Windows Azure Storage に対する i/o 操作が高速になり、データの容量が少なくなります。</li>
   <li>SQL Server 2012 Service Pack 1 の累積的な更新プログラム2の<strong><span style="text-decoration: underline;">ディスクではなく Blob Storage にバックアップする</span></strong>Windows Azure インフラストラクチャサービスで SQL Server デプロイを行うための便利な新しいバックアップシナリオが有効になりました。 バックアップを格納するために追加のデータディスクをプロビジョニングするのではなく、Windows Azure Blob Storage を使用してデータベースのバックアップと復元を行うことができます。 Blob ストレージは、無制限の容量を提供し、組み込みのローカル冗長性とオプションの geo 冗長性を提供します。 これにより、データディスク上の貴重な容量が解放され、データファイルとログファイルに専用の容量を確保できるようになります。 詳細については<a href="https://msdn.microsoft.com/en-us/library/jj919148.aspx">、「Windows Azure Blob Storage サービスを使用したバックアップと復元 SQL Server</a> 」を参照してください。 追加の利点として、不要なアップロードやダウンロード操作を実行する貴重な時間と帯域幅を無駄にすることなく、ストレージアカウントとリージョン間でバックアップ blob を非同期的にコピーすることができます。</li>
   <li><strong><span style="text-decoration: underline;">ハッキング</span></strong> <strong><span style="text-decoration: underline;">
  </span></strong> を受けないvm を適切にセキュリティで保護し Windows Azure インフラストラクチャサービスでデプロイを SQL Server して、承認されていないアクセスから保護することができます。 ハッカーは、インターネット上のセキュリティ保護されていないコンピューターを常に引き継ぎ、独自の目的で使用します。 ネットワーク DMZ の背後にあるオンプレミスの SQL Server のデプロイをセキュリティで保護するのと同じ方法で、Windows Azure インフラストラクチャサービスで SQL Server のデプロイをセキュリティで保護することをお勧めします。 RDP または TSQL のパブリックエンドポイントを開かないようにします。 代わりに、セキュリティで保護された VPN Gateway を設定し、データベースサーバーを直接管理します。 id とアクセス制御には Windows 認証を使用します。 SQL 認証を使用する必要がある場合は、SQL Server 管理用に別のアカウントを作成し、sysadmin ロールに追加して、強力なパスワードを設定してから、 <em>sa</em>アカウントを無効にします。 使用する予定がないサービスを停止して無効にすることで、攻撃対象を最小限に抑えます。 <a href="https://msdn.microsoft.com/en-us/library/bb934049.aspx" target="_blank">SQL Server Transparent Data Encryption (tde)</a>を使用して、保存データ、ログ、バックアップファイルを保護することを検討してください。 これらのファイルが VM の外部にコピーされた場合、これらのファイルは役に立ちません。</li>
   <li><strong><span style="text-decoration: underline;">PowerShell について学習</span></strong>するWindows azure 管理ポータルには、azure インフラストラクチャサービス Windows での VM デプロイのプロビジョニングと管理を行うための豊富なグラフィカルインターフェイスが用意されていますが、多くの仮想マシンをデプロイする必要がある場合は、PowerShell の学習に時間をかける必要があります。 Vm と仮想ネットワークをプロビジョニングおよび構成するための PowerShell スクリプトのライブラリを開発することにより、時間と労力を節約できます。 詳細については、「 <a href="https://blogs.technet.com/b/yungchou/archive/2013/05/20/automating-windows-azure-infrastructure-services-iaas-deployment-with-powershell.aspx" target="_blank">PowerShell を使用した Windows Azure インフラストラクチャサービス (IaaS) デプロイの自動化</a>」を参照してください。</li>
  </ul>

  &nbsp;


  いくつかの情報が表示されたので、Azure インフラストラクチャサービス Windows できるように準備されている SQL Server ワークロードの特定を開始することをお勧めします。 小規模なワークロードの一部を移行して、自信を持って自信を持って得られるようにし、より多くのワークロードに移行することができます。 互換性以外にも、Azure インフラストラクチャサービスでは、SQL Server デプロイの構成とメンテナンスをきめ細かく制御する (および必要な) Windows ことに注意してください。 これは多くの IT 組織を対象とした販売ポイントですが、他のユーザーがイノベーションに集中できるように、サーバーの保守業務を終了する必要があります。


  Windows Azure SQL Database は SQL Server テクノロジ上に構築され、サービスとして提供されます。 サーバーソフトウェアをインストールして管理する必要はありません。また、高可用性やディザスターリカバリーなどの高度な機能が組み込まれています。 また、既存のワークロードを移行するために Windows Azure インフラストラクチャサービスで SQL Server を実行する際に提供される互換性ときめ細かい制御を組み合わせることによって、新しいワークロード用に Windows Azure SQL Database の管理されたサービスの機敏性と利点を組み合わせることで、両方の長所を最大限に活用することができます。 Windows Azure のこのようなハイブリッド使用は完全にサポートされており、他のパブリッククラウドプロバイダーとの比較において、主な差別化要因の1つになっています。 これらすべての機能の詳細については、「 <a href="https://azure.microsoft.com/en-us/home/features/data-management/" target="_blank">データ管理</a> 」を参照してください。


  &nbsp;


  <a href="https://blogs.msdn.com/b/rdoherty" target="_blank">Roger Doherty</a> シニアプログラムマネージャー Microsoft カスタマーアドバイザリチーム
