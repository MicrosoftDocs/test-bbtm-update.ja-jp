### YamlMime:Yaml
ms.openlocfilehash: 525d68c289b489808cf0f66223a670dc139d859c
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139892204"
Slug: sql-server-alwayson-and-ilb
Title: AlwaysOn と ilb の SQL Server
Summary: Azure サービスの内部負荷分散 (ILB) は、2014年5月にプレビューされ、7月に一般提供が終了しました。 現在、両方のテクノロジを一緒に導入することが興奮しています。ilb で SQL Server AlwaysOn 可用性グループを実行できるようになりました。 可用性グループは、高可用性と障害復旧を目的とした SQL Server の主要なソリューションです。
Content: "Azure インフラストラクチャサービスでの SQL Server AlwaysOn 可用性グループは、2013年8月以降に<a href=\"https://blogs.technet.com/b/dataplatforminsider/archive/2013/08/12/alwayson-availability-groups-fully-supported-on-windows-azure-infrastructure-services.aspx\">サポート</a>されています。 Azure サービスの内部負荷分散 (ILB) は、2014年5月にプレビューされ、7月に <a href=\"https://azure.microsoft.com/en-us/updates/general-availability-internal-load-balancing/\">一般提供</a> が終了しました。 現在、両方のテクノロジを一緒に導入することが興奮しています。ilb で SQL Server AlwaysOn 可用性グループを実行できるようになりました。 可用性グループは、高可用性と障害復旧を目的とした SQL Server の主要なソリューションです。 可用性グループ リスナーによって、クライアント アプリケーションは、構成されているレプリカの数に関係なく、プライマリ レプリカにシームレスに接続できます。\n\nリスナー (DNS) 名は負荷分散された IP アドレスにマップされ、Azure の Load Balancer によって、着信トラフィックがレプリカ セットのプライマリ サーバーのみに送られます。 これまでは、この負荷分散された IP アドレスは、インターネットから到達可能なパブリック IP アドレスである必要がありました。 信頼されたエンティティにのみリスナーへのアクセスを制限する場合は、エンドポイントのアクセス制御リスト (Acl) を使用する必要がありました。 ただし、特定のシナリオでは通常、時間の経過と共に Acl を維持するのは煩雑な場合があります。\n\nこの点について非常に役立つように、Azure では SQL Server AlwaysOn (リスナー) エンドポイントの ilb サポートを発表しました。 リスナーのアクセシビリティを制御できるようになりました。また、Virtual Network (VNet) の特定のサブネットから負荷分散された <a>IP アドレス </a>を選択できます。 リスナーで ilb を使用することにより、SQL サーバーエンドポイント (例: server = tcp:<i>listenername</i>, 1433; Database =<i>DatabaseName</i>) は、次の方法でのみアクセスできます。\n<ul>\n <li>同じ仮想ネットワーク内のサービスと VM</li>\n <li>接続されたオンプレミス ネットワークのサービスと VM</li>\n <li>相互接続された Vnet のサービスと Vm</li>\n</ul>\n<a href=\"https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/30/ILB_SQLAO_NewPic.jpg\"><img style=\"padding-top: 0px; padding-left: 0px; padding-right: 0px; border-width: 0px;\" title=\"ILB_SQLAO_NewPic\" alt=\"ILB_SQLAO_NewPic\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ILB_SQLAO_NewPic_thumb.jpg\" width=\"644\" height=\"409\" border=\"0\" /></a>\n\n内部ロードバランサーは依然として Azure portal で公開されていないため、次に示すように powershell スクリプトで構成する必要があります。\n\n* 次の例では、サブネット \"Subnet-1\" を含む仮想ネットワークを使用しています。\n<pre class=\"prettyprint\"># Add Internal Load Balancer to the service \nAdd-AzureInternalLoadBalancer -InternalLoadBalancerName ILB_SQL_AO -SubnetName Subnet-1 -ServiceName SqlSvc\n\n# Add load balanced endpoints for ILB on each VM\nGet-AzureVM -ServiceName SqlSvc -Name sqlsvc1 | Add-AzureEndpoint -Name \"LisEUep\" -LBSetName \"ILBSet1\" -Protocol tcp -LocalPort 1433 -PublicPort 1433 -ProbePort 59999 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 –DirectServerReturn $true -InternalLoadBalancerName ILB_SQL_AO | Update-AzureVM \nGet-AzureVM -ServiceName SqlSvc -Name sqlsvc2 | Add-AzureEndpoint -Name \"LisEUep\" -LBSetName \"ILBSet1\" -Protocol tcp -LocalPort 1433 -PublicPort 1433 -ProbePort 59999 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 –DirectServerReturn $true -InternalLoadBalancerName ILB_SQL_AO | Update-AzureVM</pre>\nILB の詳細については、このトピックの MSDN ドキュメントまたは前の <a href=\"https://azure.microsoft.com/blog/2014/05/20/internal-load-balancing/\">ブログ投稿</a> を参照してください。"
