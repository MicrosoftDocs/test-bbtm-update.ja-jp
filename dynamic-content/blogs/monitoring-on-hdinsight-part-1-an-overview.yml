### YamlMime:Yaml
ms.openlocfilehash: 4b80be5cbe4f5baa3f494a81a2b6adf21bdb1f52
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139895343"
Slug: monitoring-on-hdinsight-part-1-an-overview
Title: 'Azure HDInsight の監視 (パート 1): 概要'
Summary: Azure HDInsight Hadoop、Spark、または Kafka クラスターを監視する方法がいくつか用意されています。  クラスターの正常性と可用性、リソースの使用率とパフォーマンス、ジョブの状態とログの 3 つの主要なカテゴリに分類できます。
Content: >-
  <p>Azure HDInsight Hadoop、Spark、または Kafka クラスターを監視する方法がいくつか用意されています。 HDInsight での監視は、主に次の 3 つのカテゴリに分類できます。</p>


  <ul>
   <li>クラスターの正常性と可用性</li>
   <li>リソース使用率とパフォーマンス</li>
   <li>ジョブの状態とログ</li>
  </ul>


  <p>Azure HDInsight には、すべての HDInsight クラスターに含まれる Apache Ambari と、すべての <a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-oms-log-analytics-tutorial#enable-azure-monitor-logs-by-using-the-portal" target="_blank">HDInsight</a> クラスターで有効にできる Azure Monitor ログとのオプションの統合という 2 つの主要な監視ツールが用意されています。 これらのツールには同じ情報がいくつか含まれていますが、各ツールには特定のシナリオでの利点があります。 これらのツールを使用して HDInsight クラスターのさまざまな側面を監視する最適な方法の概要については、以下を参照してください。</p>


  <h2>クラスターの正常性と可用性</h2>


  <p>Azure HDInsightは、冗長なゲートウェイ ノード、ヘッド ノード、ZooKeeper ノードを備え、HDInsight クラスターをスムーズに実行し続ける高可用性サービスです。 これにより、1 つの障害がクラスターの機能に影響を与えるのではなく、クラスターの正常性を監視して、問題が発生した場合にアラートを受け取る必要がある場合があります。 クラスターの正常性の監視とは、クラスター内のすべてのノードと、クラスターで実行されているコンポーネントが使用可能で正常に機能するかどうかを監視する方法を指します。</p>


  <p>Ambari は、特定の HDInsight クラスターの正常性を監視する場合に推奨されるツールです。 Ambari &ldquo; を使用したクラスターの可用性の監視の詳細については、<a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-high-availability-linux#how-to-check-on-a-service-status" target="_blank">HDInsight での Apache Hadoop</a> クラスターの可用性と信頼性に関するドキュメントを参照してください。&rdquo;</p>


  <p style="text-align: justify;"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d50e7bb9-8da9-4302-9b8a-378e283815b3.png"><img alt="ambari_components" border="0" height="564" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d290cc90-4291-4647-87be-d81bcd7874ab.png" style="border: 0px currentcolor; border-image: none; text-align: left; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="ambari_components" width="526"></a></p>


  <p style="text-align: center;"><em>ヘッド ノード上のすべてのコンポーネントの状態を示す Ambari ポータル ビュー</em></p>


  <h2>クラスター リソースの使用率とパフォーマンス</h2>


  <p>クラスターで最適なパフォーマンスを維持するには、リソース使用率を監視する必要があります。 これは、Ambari を使用して実行し、ログAzure Monitorできます。</p>


  <h3>Ambari を使用する</h3>


  <p>Ambari は、クラスター全体の使用率を監視するために推奨されるツールです。 Ambari ダッシュボードには、CPU、ネットワーク、YARN メモリ、HDFS ディスク使用量などのメトリックを表示する簡単に見やすいウィジェットが表示されます。 表示される特定のメトリックは、クラスターの種類によって異なります。 [ &ldquo;ホスト]&rdquo; タブには個々のノードのメトリックが表示されます。これにより、クラスターの負荷が均等に分散されます。</p>


  <p>YARN &ldquo;キュー マネージャーには&rdquo; 、Ambari 経由でもアクセスできます。 これにより、各ジョブ キューの容量を管理して、ジョブがジョブ間でどのように分散され、ジョブがリソースに制約されているかどうかを確認できます。 Ambari を使用してクラスターのパフォーマンスを監視する方法の詳細については、クラスターのパフォーマンスの監視に関する &ldquo;<a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-key-scenarios-to-monitor" target="_blank">ドキュメントを参照してください</a>。&rdquo;</p>


  <p style="text-align: justify;"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6060900a-3cfe-41fa-b22e-db89350e9626.png"><img alt="ambari_dashboard" border="0" height="298" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f2cb7497-6159-4acc-9f5f-8f44807d9369.png" style="border: 0px currentcolor; border-image: none; text-align: left; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="ambari_dashboard" width="650"></a></p>


  <p style="text-align: center;"><em>クラスター全体の使用率を一目で示す Ambari ポータル ダッシュボード</em></p>


  <h3>ログAzure Monitor使用</h3>


  <p>仮想マシン (VM) レベルでリソース使用率を監視するには、次のログAzure Monitorできます。 HDInsight クラスター内のすべての VM は、パフォーマンス カウンターを Log Analytics ワークスペースの Perf テーブルにプッシュします (CPU、メモリ、ディスク使用量など)。 他の Log Analytics テーブルと同様に、Perf テーブルに対してクエリを実行し、ビュー デザイナーを使用して視覚化を作成し、アラートを構成できます。 Azure Monitor ログの主な利点の 1 つは、複数の HDInsight クラスターから同じ Log Analytics ワークスペースにメトリックとログをプッシュし、1 か所で複数のクラスターを監視できるという利点です。 &ldquo; Azure Monitor ログでのパフォーマンス データの操作の詳細については、Log Analytics ログ検索を使用して収集されたデータの表示または分析に関するドキュメント<a href="https://docs.microsoft.com/en-us/azure/azure-monitor/learn/tutorial-viewdata#work-with-performance-data" target="_blank">を参照してください</a>。&rdquo;</p>


  <h2>ワークロードの情報とログ</h2>


  <p>HDInsight クラスターの監視のもう 1 つの重要な部分は、クラスターで実行されているワークロードに関する情報を監視し、デバッグに役立つ関連ログを表示する方法です。 たとえば、Kafka で受信データを監視したり、Spark ジョブがいつ失敗したのか把握することができます。</p>


  <h3>ログAzure Monitor使用</h3>


  <p>ワークロード情報とログを監視する推奨される方法は、Azure HDInsightログ <a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-oms-log-analytics-tutorial" target="_blank">をAzure Monitorです</a>。 HDInsight クラスターでは、ワークロード固有のメトリックとログを OSS コンポーネントから Log Analytics ワークスペースに出力できます。 たとえば、Spark/Hadoop クラスターでは、送信済み、保留中、失敗、および削除されたアプリの数を出力できます。Kafka クラスターでは、受信メッセージと受信/送信バイトの数を出力できます。 Log Analytics <a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-oms-log-analytics-use-queries" target="_blank">ワークスペース内の</a> テーブルに対してクエリを実行し、特定のメトリック <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-metric">が</a> 定義されたしきい値をAzure Monitorアラートが発生するアラートを設定できます。 たとえば、Spark ジョブが失敗するたびに、発生して電子メールを送信したり、他のアクションを実行したりするアラートを設定できます。</p>


  <h4>Azure HDInsight監視ソリューション</h4>


  <p>ワークロード固有の <a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-oms-log-analytics-tutorial#install-hdinsight-cluster-management-solutions" target="_blank">Azure HDInsightログ</a> 統合に基Azure Monitor監視ソリューションも利用できます。 これらのソリューションは、前述のワークロード固有のメトリックの視覚化を含む事前作成済みのダッシュボードの形式で提供されます。 たとえば、Spark ソリューションでは、保留中、失敗、および一連のアプリの削除など、メトリックのグラフが表示されます。 これらのソリューションは Log Analytics ワークスペースによってサポートされているので、視覚化には、ワークスペースにメトリックを出力するすべてのクラスターのデータが表示されます。 その結果、同じ種類の複数のクラスターからこれらのワークロード メトリックの視覚化が 1 か所で表示されます。</p>


  <p style="text-align: justify;"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f9a86415-dc00-4be9-9598-08a187b8b0e2.png"><img alt="spark_solution" border="0" height="609" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4b235095-c1b0-4cac-ac20-233eedd8a219.png" style="border-image: none; text-align: left; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="spark_solution" width="800"></a></p>


  <p align="center"><em>HDInsight Spark 監視ソリューション</em></p>


  <h3>Ambari を使用する</h3>


  <p>YARN ResourceManager UI で Spark/Hadoop クラスターからワークロード情報を表示することもできます。これは、Ambari ポータルからアクセスできます。 YARN UI には、すべてのジョブ送信とその状態に関する詳細情報が表示されます。さらにジョブをデバッグする必要がある場合は、Ambari ポータルに ResourceManager ログ ファイルへのリンクが表示されます。</p>


  <h3>クラスター上</h3>


  <p>クラスター上のログ ファイルに直接アクセスするには、HDInsight クラスター&quot;のログ<a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-log-management#step-3-manage-the-cluster-job-execution-log-files">の管理に関するドキュメントを参照してください</a>。&quot;</p>


  <h2>今すぐ HDInsight を試す</h2>


  <p>Apache Ambari と Azure Log Analytics 統合の間で、HDInsight には、HDInsight クラスターのすべての側面を監視するための包括的なツールが用意されています。 HDInsight での監視を完全に活用して、お客様が HDInsight を使用して何を構築Azure HDInsight。 <a href="https://azure.microsoft.com/en-us/blog/get-up-to-speed-with-azure-hdinsight-the-comprehensive-guide/" target="_blank">この開発者ガイドを読み</a>、<a href="https://docs.microsoft.com/en-us/azure/hdinsight/hadoop/apache-hadoop-linux-tutorial-get-started" target="_blank"></a>クイック スタート ガイドに従って、これらのパイプラインとアーキテクチャを Azure HDInsight に実装する方法について学習してください。 Twitter <a href="https://twitter.com/search?q=%23AzureHDInsight&amp;src=typd" target="_blank">#AzureHDInsight</a> と でフォロー Azure HDInsight最新情報と機能を最新の情報に更新してください <a href="https://twitter.com/search?q=%40AzureHDInsight&amp;src=typd" target="_blank">@AzureHDInsight</a>。 質問とフィードバックについては、 にお問い合わせください <a href="mailto:AskHDInsight@microsoft.com">AskHDInsight@microsoft.com</a>。</p>


  <h2>HDInsight について</h2>


  <p>Azure HDInsightは、Apache Hadoop、Spark、Kafka などの一般的なオープン ソース フレームワークを簡単に実行できる、オープンソース分析用の簡単でコスト効率の高いエンタープライズ レベルのサービスです。 このサービスは、36 のパブリック リージョンと、Azure Governmentクラウドで使用できます。 Azure HDInsightさまざまなセクターでミッション クリティカルなアプリケーションを提供し、ETL、ストリーミング、対話型クエリなどの幅広い用途を可能にしています。</p>
