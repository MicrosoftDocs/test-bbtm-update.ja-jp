### YamlMime:Yaml
ms.openlocfilehash: 70213ad8074ab5decf6aaf3e88a883aaf1cab7b8
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139891053"
Slug: 7-best-practices-for-continuous-monitoring-with-azure-monitor
Title: Azure Monitor を使用した継続的な監視のための7つのベストプラクティス
Summary: 開発者、SRE、IT オペレーションスペシャリスト、PM、または DevOps の専門家であるかにかかわらず、監視は十分に注意してください。 Azure Monitor は、アプリケーションとインフラストラクチャ間で完全にスタック可観測性を提供する Microsoft の統合された監視ソリューションです。 ハイブリッド/パブリッククラウドの監視戦略を成功させるためのベストプラクティスについて説明します。
Content: >-
  <p>開発者、サイト信頼性エンジニア、IT オペレーションスペシャリスト、プログラムマネージャー、DevOps の専門家による監視は、ご注意ください。 オンプレミスの世界から発展する最新のアプリケーションでは、ハイブリッドまたはマイクロサービスベースに進化しています。また、スキルセットを発展させ、ハイブリッド/パブリッククラウドでの監視戦略を成功させるためのベストプラクティスを採用する必要もあります。</p>


  <p><a href="https://azure.microsoft.com/services/monitor/">Azure Monitor</a> は、アプリケーションとインフラストラクチャ間で完全にスタック可観測性を提供する Microsoft &rsquo; の統合された監視ソリューションです。 現時点では、使用している hat に応じて、リソースの正常性をエンドツーエンドで可視化できます。また、実際のコード行についても、アプリケーションやインフラストラクチャの問題を修正して、数分で再デプロイすることで、問題の最も可能性の高い根本原因を掘り下げることができます。 堅牢な監視パイプラインを設定している場合は、顧客に影響を与え始める前に問題を見つけて修正することができます。</p>


  <h2>継続的な監視</h2>


  <p>DevOps 概念としての継続的インテグレーションと継続的デプロイ (CI/CD) は、多くの場合、ソフトウェアをより迅速かつ確実に提供し、ユーザーに継続的な価値を提供するのに役立ちます。 継続的監視 (CM) は、DevOps と IT 運用サイクルの各フェーズで監視を組み込むことができる新しいフォローアップの概念です。 これにより、アプリとインフラストラクチャの正常性、パフォーマンス、および信頼性が、開発者、運用環境、および顧客の間を流れるため、継続的に維持されます。</p>


  <p><img alt="Continuous Monitoring with Azure Monitor and Azure DevOps" border="0" height="308" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4775d0d3-aad0-4c19-9274-d9a21fa7b5e3.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="DevOps の継続的な監視" width="610"></p>


  <p>Azure Monitor は、ワークフロー全体の継続的な監視を実際に有効にできるツールの1つです。 開発とテストの際には、 <a href="https://visualstudio.microsoft.com/">Visual Studio と Visual Studio Code</a>とシームレスに連携します。また、配置と操作中にリリース管理と作業項目の管理のために<a href="https://azure.microsoft.com/services/devops/">Azure DevOps</a>と統合することもできます。 さらに、お客様の既存の IT プロセスにおける問題とインシデントを追跡するのに役立つ任意の ITSM ツールや SIEM ツールとも統合されます。</p>


  <h2>継続的な監視のための7つのベストプラクティス</h2>


  <h3><em>すべて</em>のアプリの監視を有効にする</h3>


  <p>Full 可観測性の最初の手順は、すべての web アプリとサービスにわたって監視を有効にすることです。 コードで作業している場合は、.net、Java、Node.js、またはその他のプログラミング言語で記述されたアプリに<a href="https://docs.microsoft.com/azure/azure-monitor/">Azure Monitor Application Insights sdk を追加</a>する必要があります。 これは、アプリやビジネスに関連するカスタムイベント、メトリック、またはページビューも指定できるようになったため、推奨される方法です。</p>


  <p>コードへのアクセス権を持っていない場合は、他にもさまざまな方法で監視を有効にでき &rsquo; ます。 <a href="https://docs.microsoft.com/azure/application-insights/app-insights-vsts-continuous-monitoring">Azure Pipelines のリリーステンプレート</a>、 <a href="https://azure.microsoft.com/features/devops-projects/">Azure DevOps プロジェクト</a>、 <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-monitor-performance-live-website-now?toc=/azure/azure-monitor/toc.json">Windows サーバー上の .net アプリのステータスモニター</a>、Azure vm の拡張機能、Azure アプリサービスなどがあります。 すべてのアプリで監視を有効にすると、すべてのコンポーネントにわたるエンドツーエンドのトランザクションと接続を簡単に視覚化できるようになります。</p>


  <h3>インフラストラクチャの <em>すべて </em>の関連コンポーネントの監視を有効にする</h3>


  <p>通常、アプリケーションスタックのどのコンポーネントに問題があるかを予測するのは困難なので、関連する <em>すべて</em> のコンポーネントを監視することが重要です。 Azure Monitor は、ハイブリッドインフラストラクチャ全体の正常性とパフォーマンスを追跡するのに役立ちます。これは、it vm、コンテナー、Storage、ネットワーク、またはその他の Azure サービスです。 プラットフォーム <a href="https://docs.microsoft.com/azure/monitoring/monitoring-data-collection?toc=/azure/azure-monitor/toc.json">メトリック、アクティビティログ、診断ログ</a> は、ほとんどの azure リソースから自動的に取得されます。また、azure Portal で簡単なボタンクリックを使用するか、サーバーにエージェントをインストールすることにより、 <a href="https://docs.microsoft.com/azure/monitoring/monitoring-vminsights-overview?toc=/azure/azure-monitor/toc.json">仮想マシン</a> または <a href="https://docs.microsoft.com/azure/monitoring/monitoring-container-insights-overview?toc=/azure/azure-monitor/toc.json">AKS クラスター</a> の監視をさらに強化できます。</p>


  <p>コードとしてのスケーラビリティとインフラストラクチャについては、DevOps プロジェクト、 <a href="https://docs.microsoft.com/azure/monitoring/monitoring-vminsights-onboard?toc=/azure/azure-monitor/toc.json">Azure policy、PowerShell、または ARM テンプレート</a>を利用して、大量のリソースに対する監視と<a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-create-metric-alerts-with-templates?toc=/azure/azure-monitor/toc.json">アラートの構成</a>を有効にすることをお勧めします。 お客様のインフラストラクチャ全体に対して監視を有効にすることは、完全な観測性を実現するのに役立つほか、何らかの障害が発生した際に考え得る根本的原因を検出しやすくするのに役立ちます。</p>


  <h3>リソースグループ内のバケット関連のリソース</h3>


  <p>現在、Azure の一般的なアプリケーションは、Vm/App Services にデプロイされたモノリシックアプリ、または Cloud Services、AKS クラスター、ACS、または Service Fabric でホストされているマイクロサービスで構成されています。 これらのアプリでは、タスクを完了するために、Event Hubs、Storage、SQL、Service Bus などの依存関係が頻繁に使用されます。 多くのお客様は、 <a href="https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview">リソースグループ</a> を使用して、アプリケーションを構成するすべてのリソースをバケット化しています。また、同じを使用すると <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/resource-group-insights">Azure Monitor</a> 、フルスタックアプリケーション全体の正常性とパフォーマンスを追跡するための簡単な方法が提供され、調査やデバッグを行うために個々のコンポーネントを掘り下げていくことができます。</p>


  <h3>継続的デプロイによって品質を確保する</h3>


  <p><a href="https://azure.microsoft.com/services/devops/pipelines/">Azure Pipelines</a>は継続的なデプロイを設定するための優れた方法であり、CI/CD テストが成功した場合にコードコミットから運用までのプロセス全体を自動化できます。 配置前または配置後の <a href="https://docs.microsoft.com/azure/devops/pipelines/release/approvals/gates?view=vsts">品質ゲート</a> の一部として監視を統合することで、アプリが開発者から運用環境に移行するときに、キーの正常性とパフォーマンスのメトリック (kpi) を追跡することができます。また、インフラストラクチャ環境やスケールの違いが kpi に悪影響を与えることはありません。</p>


  <p>また、開発、テスト、カナリア、運用などのさまざまなデプロイ環境間で <a href="https://docs.microsoft.com/azure/application-insights/app-insights-separate-resources">個別の監視インスタンス</a> を維持することもお勧めします。 そのため、関連付けられているアプリとインフラストラクチャ間でデータが関連したままになります。 関連付けを行うために必要な場合は、 <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-metric-charts?toc=/azure/azure-monitor/toc.json">メトリックスエクスプローラー</a> で複数のリソースのグラフを常に設計したり、 <a href="https://docs.microsoft.com/azure/log-analytics/log-analytics-cross-workspace-search">Log Analytics</a>でクロスリソースクエリを実行したりすることができます。</p>


  <h3>通知や修復によって実行可能なアラートをセットアップする</h3>


  <p>堅牢なアラートパイプラインを使用することは、あらゆる監視戦略に不可欠であり、予測可能なすべてのエラー状態に対してアクション可能な <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-alerts?toc=/azure/azure-monitor/toc.json">アラート</a> を設定することをお勧めします。 アラートは、静的または <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-alerts-dynamic-thresholds?toc=/azure/azure-monitor/toc.json">動的なしきい値</a> と、その上にセットアップアクションを使用して構成できます。 これらの <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-action-groups?toc=/azure/azure-monitor/toc.json">アクション</a> は、SMS、電子メール、プッシュ通知、または簡単な通知の音声通話のように簡単に行うことができます。 また、Webhook を使用して、既存の ITSM ツールやその他のアラート管理システムに接続することもできます。 可能であれば、Azure Automation の Runbook や、エラスティックワークロードの場合は <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitor-tutorial-autoscale-performance-schedule?toc=/azure/azure-monitor/toc.json">自動スケール</a> によって、修復を設計する方法があります。</p>


  <h3>レポート用のロールベースのダッシュボードとブックを準備する</h3>


  <p>会議のプレゼンテーションで大規模なユーザーのグループに質問した場合、そのいずれかが企業内の開発と運用で同じ監視ソリューションを既に使用していても、答えは overwhelmingly ネガです。 継続的な監視を成功させるためには、開発者と ops が同じテレメトリと同じツールにアクセスできることが不可欠です。 Azure Monitor は、チーム全体の統合監視ソリューションとして設計されており、一般的なメトリック &amp; ログに基づいて、<a href="https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-dashboards?toc=/azure/azure-monitor/toc.json">ロールベースのカスタムダッシュボード</a>を簡単に準備できます。</p>


  <p><a href="https://docs.microsoft.com/azure/application-insights/app-insights-usage-workbooks?toc=/azure/azure-monitor/toc.json">ブック</a> は、開発者と ops 間のナレッジ共有を支援するもう1つの便利な機能です。 これらは、メトリックチャートやログクエリを使用した動的レポートとして、または開発者によって準備されたトラブルシューティングガイドとして準備して、基本的な問題に対応するためにカスタマーサポートや ops を支援することができます。</p>


  <h3>ビルドメジャーを使用した &ldquo; 継続的な最適化-学習&rdquo;</h3>


  <p>お客様にとって適切なソリューションを構築することは、最初の段階では実現されず、多くの場合、反復的なプロセスです。 監視は、Kpi またはユーザーの行動メトリックを継続的に追跡し、イテレーションの計画によってそれらを最適化することを推奨する、基礎的な要素の人気 &ldquo; のある手法 &rdquo; の1つです。 Azure Monitor を使用すると、ビジネスに関連するすべての関連するカスタムイベント、メトリック、またはログを収集できます。また、何かが欠けている場合は、次の配置で新しいデータポイントを追加するのは非常に簡単です。</p>


  <p>Azure Monitor のさまざまなツールを使用して、正常性、可用性、パフォーマンス、信頼性を追跡して最適化することができます。また、 <a href="https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-users?toc=/azure/azure-monitor/toc.json">エンドユーザーの行動やエンゲージメント</a> を追跡して、カスタマーエクスペリエンスを最適化することもできます。 Azure Monitor によって、重要な Kpi に注目する領域の優先順位を決定するのに役立つ、 <a href="https://docs.microsoft.com/azure/application-insights/app-insights-usage-impact?toc=/azure/azure-monitor/toc.json">影響の相関関係</a> も提供されます。</p>


  <h2>次のステップ</h2>


  <p>お客様に最適なソリューションを提供することを目指しながら、DevOps と IT オペレーションプロセス全体で、アプリとインフラストラクチャの継続的な監視パイプラインを利用することができます。</p>


  <p>Azure Monitor の詳細については、こちらの <a href="https://aka.ms/MonitoringDocs">ドキュメント</a>を参照してください。また、 <a href="https://aka.ms/AzMonOverview">Azure Portal の Azure Monitor の概要</a> に記載されている、適切なチュートリアルとビデオをご覧ください。これらのプラクティスの一部を詳細に実装するのに役立ちます。</p>
