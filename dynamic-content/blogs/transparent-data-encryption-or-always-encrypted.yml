### YamlMime:Yaml
ms.openlocfilehash: 201ad8c56645d008d7e8d3f24e81f837778edcf2
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139895272"
Slug: transparent-data-encryption-or-always-encrypted
Title: Transparent data encryption または always encrypted?
Summary: Transparent Data Encryption (tde) と Always Encrypted は、SQL Server と Azure SQL Database によって提供される2つの異なる暗号化テクノロジです。 一般に、暗号化は、さまざまなシナリオで不正アクセスからデータを保護 Always Encrypted 保護します。
Content: >-
  <h2>Azure SQL Database または SQL Server に適した暗号化テクノロジを選択する方法</h2>


  <p><a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption?view=sql-server-2017" target="_blank">Transparent Data Encryption (tde)</a>と<a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/always-encrypted-database-engine?view=sql-server-2017" target="_blank">Always Encrypted</a>は、SQL Server と Azure SQL Database によって提供される2つの異なる暗号化テクノロジです。 一般に、暗号化は、さまざまなシナリオで不正アクセスからデータを保護します。 これらは補完的な機能であり、このブログの投稿では、どのテクノロジを選択するか、およびそれらを組み合わせて多層セキュリティアプローチを実現する方法を決定するのに役立つ、並列比較を示します。</p>


  <p><br>

  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/392999cc-f49f-4e26-895b-b03175618699.png"><img alt="TDE_or_AE" border="0" height="672" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c107adfe-2f90-4a54-a2ba-41b75c63e32e.png" style="margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="TDE_or_AE" width="935"></a></p>


  <h2>透過的なデータ暗号化</h2>


  <p>TDE は、保存データをオフラインアクセスから raw ファイルまたはバックアップに保護するためのセキュリティレイヤーを追加することを目的としています。一般的なシナリオには、データセンターの盗難や、ディスクドライブやバックアップテープなどのハードウェアやメディアのセキュリティで保護されていない廃棄などがあります。 データ、ログファイル、スナップショット、コピーまたはバックアップ、および tde のベストプラクティスについては、「<a href="https://blogs.msdn.microsoft.com/sqlsecurity/2016/10/05/feature-spotlight-transparent-data-encryption-tde/" target="_blank">機能のスポットライト: Transparent Data Encryption (tde)</a> 」を参照して、盗用されたデータベースを悪意のある人物が回復しようとするリスクから保護する方法について詳しく説明します。&nbsp;</p>


  <p>データベースで TDE を有効にすると、保存時にデータを暗号化する必要があるさまざまな業界で確立された多くの法律、規制、およびセキュリティガイドラインに準拠することができます。 SQL データベースに格納されているデータに保護要件がまったくない場合を除き、tde を無効にする理由はありません。 &nbsp;ただし、TDE は保存データの保護レイヤーを1つだけ追加し、残りのリスクについては OS ファイルシステムとハードウェアレイヤーで対処する必要があることを認識することが重要です。詳細については、 <a href="https://docs.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview" target="_blank">Bitlocker のドキュメント</a>を参照してください。</p>


  <p>TDE は AES 暗号化アルゴリズム &rsquo; を使用してデータベース全体を暗号化しますが、アプリケーション開発者は既存のアプリケーションに変更を加える必要がありません。 TDE は、データとログ ファイルの I/O 暗号化と複合化をリアルタイムで実行します。 データベースがメモリに読み込まれると、データは SQL Server (sysadmin、db_owner) および Azure SQL Database (クラウド) の管理者の管理者 (dba) がアクセスできるようになり、データベースにアクセスできるすべてのロールとアプリケーションで使用できるようになります。 データベースに特定の列の機密データが含まれていて、管理者ロールから保護する必要があり、メモリで暗号化された状態を維持する必要がある場合は、TDE に加えて Always Encrypted を使用して評価する必要があります。</p>


  <p>TDE には、暗号化キー管理、サービス管理キー、およびユーザー管理キーの2つのオプションが用意されています。 サービス管理キーの場合、TDE プロテクターはサーバーの master データベースに格納されている証明書です。 ユーザーが管理するキーの場合、TDE プロテクターは EKM モジュールまたは <a href="https://azure.microsoft.com/en-us/services/key-vault/" target="_blank">Azure Key Vault</a>によって保護される非対称キーです。 独自のキーを使用して tde を Azure SQL Database 使用 &nbsp; する場合<a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql?view=azuresqldb-current" target="_blank">(byok)</a> 、tde プロテクターは key vault を離れることはありません Azure SQL Database が、データの暗号化解除と暗号化に使用されるデータベース暗号化キー (dek) の暗号化解除と暗号化のために key vault にアクセスする必要があります。 暗号化された dek が暗号化解除のために key vault に送信されると、key vault の tde プロテクターが削除されるか、SQL Database へのアクセスが取り消されるまで、暗号化されていない dek がメモリに格納されます。 この場合、データベースは24時間以内にオフラインになり、DEK はメモリから削除されます。</p>


  <h2>Always Encrypted</h2>


  <p>Always Encrypted は、データベース管理者 (SQL Server sysadmin ロールまたは db_owner ロールのメンバー)、SQL Server インスタンスをホストしているコンピューターの管理者など) によるアクセスから、Azure SQL Database または SQL Server データベースに格納されている機密データを保護するために設計された機能です。Azure SQL Database (クラウド) 管理者。 コンピューター全体がマルウェアなどによって侵害された場合でも、データベースに格納されているデータは保護されます。 Always Encrypted は、クライアント側の暗号化を活用します。アプリケーション内のデータベースドライバーは、データをデータベースに送信する前に、データを透過的に暗号化します。 同様に、ドライバーはクエリ結果で取得された暗号化データの暗号化を解除します。</p>


  <p>Always Encrypted では、クライアント側での暗号化操作によって、データベースエンジン (SQL Database または SQL Server) に漏れることのないキーが使用されます。 Always Encrypted には、次の2種類のキーがあります。</p>


  <ul>
   <li>列の暗号化キーは、データベース内のデータを暗号化するために使用されます。 これらのキーは、暗号化された形式でデータベースに格納されます (プレーンテキストではありません)。</li>
   <li>列のマスターキーは、列の暗号化キーを暗号化するために使用されます。 これらのキーは Windows 証明書ストア、Azure Key Vault またはハードウェアセキュリティモジュールなどの外部キーストアに格納されます。 &nbsp;Azure Key Vault に格納されているキーの場合、TDE とは異なり、クライアントアプリケーションのみがキーにアクセスできますが、データベースにはアクセスできません。</li>
  </ul>


  <p>Always Encrypted の固有のセキュリティ上の利点は、使用 &rdquo; &ndash; 中のデータ &ldquo; を保護することです。つまり、計算に使用されるデータは、SQL Server プロセスのメモリで暗号化されたままになります。 その結果、Always Encrypted は、SQL Server プロセスのメモリのスキャンやメモリダンプファイルからのデータの抽出を含む攻撃からデータを保護します。</p>


  <p>重要な権限を持たない &ldquo; ユーザーからデータを保護することで、 &rdquo; Always Encrypted データを所有しているユーザーとデータを管理するユーザー (ただし、アクセス権を持たないユーザー) を分離することができます。 これにより、お客様は、機密データをクラウドに安全に格納したり、オンプレミスのデータベース管理をサードパーティに委任したり、独自の DBA スタッフのセキュリティクリアランス要件を軽減したりすることができます。</p>


  <p>TDE とは異なり、これはアプリケーションに対して部分的にのみ透過的です。 クライアントドライバーはデータを透過的に暗号化および復号化しますが、Always Encrypted の要件や制限に準拠するようにアプリケーションを変更する必要がある場合があります。 たとえば、Always Encrypted は、暗号化されたデータベース列に対して非常に限定的な操作のみをサポートします。 これは、選択したデータベース列内の真の機密データを保護するために Always Encrypted を使用することをお勧めする理由の1つです。</p>


  <p>ここでは、クライアント側でデータを暗号化することによって、暗号化された列に格納されているデータを保存中および転送中に保護することによって、データを保護 Always Encrypted ことができます。 ただし、使用中の機密データを保護することが目的である場合を除き、TDE は保存時の暗号化に推奨される選択肢であり、転送中のデータを保護するために TLS を使用することをお勧めします。 実際には、Always Encrypted、TDE、および TLS を一緒に使用することをお勧めします。</p>


  <ul>
   <li>TDE (および一般的なコンプライアンス要件を満たす) として、保存されているデータベース全体を暗号化します。</li>
   <li>TLS。データベースへのすべてのトラフィックを保護します。</li>
   <li>データベース環境において、高い特権を持つユーザーとマルウェアから機密性の高いデータを保護する Always Encrypted ます。</li>
  </ul>


  <p>次に、上記の機能を並べて比較します。</p>


  <table border="1" cellpadding="1" cellspacing="0">
   <tbody>
    <tr>
     <td valign="top">&nbsp;</td>
     <td valign="top">Always Encrypted</td>
     <td valign="top">TDE</td>
    </tr>
    <tr>
     <td valign="top"><strong>SQL Server のバージョン</strong></td>
     <td valign="top">SQL Server 2016 以降。Azure SQL Database</td>
     <td valign="top">SQL Server 2008 以降。Azure SQL Database</td>
    </tr>
    <tr>
     <td valign="top"><strong>SQL Server Enterprise エディションが必要です</strong></td>
     <td valign="top">いいえ (SQL Server 2016 SP1 以降)</td>
     <td valign="top">はい</td>
    </tr>
    <tr>
     <td valign="top"><strong>Azure SQL Database で無料</strong></td>
     <td valign="top">はい</td>
     <td valign="top">はい</td>
    </tr>
    <tr>
     <td valign="top"><strong>保存データを保護します</strong></td>
     <td valign="top">はい</td>
     <td valign="top">はい</td>
    </tr>
    <tr>
     <td valign="top"><strong>使用中のデータを保護する</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
    <tr>
     <td valign="top"><strong>SQL 管理者と管理者からデータを保護します</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
    <tr>
     <td valign="top"><strong>データは、クライアント側で暗号化または暗号化解除されます。</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
    <tr>
     <td valign="top"><strong>データはサーバー側で暗号化または暗号化解除されます。</strong></td>
     <td valign="top">いいえ</td>
     <td valign="top">はい</td>
    </tr>
    <tr>
     <td valign="top"><strong>列レベルで暗号化</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ (データベース全体を暗号化します)</td>
    </tr>
    <tr>
     <td valign="top"><strong>アプリケーションに対して透過的</strong></td>
     <td valign="top">部分的</td>
     <td valign="top">はい</td>
    </tr>
    <tr>
     <td valign="top"><strong>[暗号化のオプション]</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
    <tr>
     <td valign="top"><strong>暗号化キーの管理</strong></td>
     <td valign="top">顧客管理キー</td>
     <td valign="top">サービスまたはユーザーが管理するキー</td>
    </tr>
    <tr>
     <td valign="top"><strong>使用中のキーを保護する</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
    <tr>
     <td valign="top"><strong>ドライバーが必要です</strong></td>
     <td valign="top">はい</td>
     <td valign="top">いいえ</td>
    </tr>
   </tbody>
  </table>


  <h2>詳細情報:</h2>


  <ul>
   <li><a href="https://docs.microsoft.com/en-us/sql/sql-server/editions-and-components-of-sql-server-2016?view=sql-server-2017" target="_blank">エディションと SQL Server 2016 のサポートされる機能</a></li>
   <li>Always Encrypted を含む Channel 9 プレゼンテーションについては、「 <a href="https://channel9.msdn.com/events/DataDriven/SQLServer2016/AlwaysEncrypted" target="_blank">Always Encrypted を使用した機密データのセキュリティ保護</a>」を参照してください。</li>
   <li><a href="https://blogs.msdn.microsoft.com/sqlcat/2016/06/20/sqlsweet16-episode-1-backup-compression-for-tde-enabled-databases/" target="_blank">SQLSweet16!、エピソード 1: TDE が有効なデータベースのバックアップ圧縮</a></li>
  </ul>
