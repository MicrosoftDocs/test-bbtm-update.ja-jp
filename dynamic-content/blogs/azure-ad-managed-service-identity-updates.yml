### YamlMime:Yaml
ms.openlocfilehash: 4f7885f368804a82d7aa11a3300bcb9e49874d09
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139896254"
Slug: azure-ad-managed-service-identity-updates
Title: Azure AD サービス ID の更新プログラム
Summary: Azure ADマネージド サービス ID は数か月間プレビューされています。 サービスの新機能に関する更新プログラムを提供したいと考えたのです。
Content: >-
  <p><em>この投稿&nbsp;は、Azure Identity Services の Program Manager である Arturo Lucatero によって作成されました。 </em></p>


  <p>Azure ADマネージド サービス ID は数か月間プレビューの中にあるので、何が起こっているかに関する更新プログラムを提供したいと考えたのです。</p>


  <h2>2 種類のマネージド ID</h2>


  <p>マネージド ID には次の 2 種類があります。</p>


  <ol>
   <li>
   <p><strong>システム割り当て:</strong> これは、9 月に導入したマネージド ID の種類です。 Azure リソース (VM など) と 1 対 1 の関係を持ち、同じライフ サイクルを共有します。 リソースを削除すると、ID が自動的にクリーンアップされます。</p>
   </li>
  </ol>


  <ol start="2">
   <li>
   <p><strong>ユーザー割り当て:</strong> この新しい種類のマネージド ID は、独自のライフサイクルを持つスタンドアロンの Azure リソースです。 これにより、1 つ以上の Azure リソースで使用できる ID を持つ可能性があります。 言及する価値のある注意事項を次に示します。</p>

   <ul>
    <li>
    <p>現在、ユーザー割り当てマネージド ID は、ユーザー割り当てとVirtual MachinesでのみVirtual Machine Scale Sets。 その他のリソースの種類は間もなくオンボードされます。</p>
    </li>
    <li>
    <p>ユーザー割り当てマネージド ID をリソースに割り当てる API は、近い将来変更される予定です。 現在、割り当てられた ID は、 の配列プロパティに一覧表示Azure Resource Manager。 これは、PATCH セマンティクスをサポートするディクショナリに変更されます。</p>
    </li>
    <li>
    <p>ポータルで&rsquo;ユーザー割り当て ID を作成および管理するには、まだできません。 すぐにプレビューの準備に取り組み、お楽しみにしてください。</p>
    </li>
   </ul>
   </li>
  </ol>


  <h2>Azure AD Azure Friday でのマネージド サービス ID の追加</h2>


  <p>最近、Azure Friday にアクセスし、Donovan Brown Azure ADマネージド サービス ID について説明しました。 以下を確認してください。</p>


  <p><iframe allowfullscreen="" frameborder="0" height="270" src="https://channel9.msdn.com/Shows/Azure-Friday/Azure-AD-Managed-Service-Identity/player" width="480"></iframe></p>


  <h2>Virtual Machines および Virtual Machine Scale Sets でのトークン要求のエンドポイント更新</h2>


  <p>次&#39;のマネージド ID トークン要求のエンドポイントを変更Virtual MachinesしましたVirtual Machine Scale Sets。</p>


  <p>VM と仮想マシンVM Scale Sets、Azure Instance Metadata Service (IMDS) を使用してトークンを要求します。 IMDS は、既知の未送信 IP アドレスで VM 内からのみアクセスできる REST エンドポイントです。</p>


  <p>VM 内でトークンを要求する HTTP 呼び出しのサンプル:</p>


  <table border="1" cellpadding="2" cellspacing="0">
   <tbody>
    <tr>
     <td valign="top">IMDS 経由</td>
     <td valign="top"><code>GET &#39;https://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https://management.azure.com/&#39; HTTP/1.1 Metadata: true</code></td>
    </tr>
    <tr>
     <td valign="top">VM 拡張機能経由</td>
     <td valign="top"><code>GET &#39;https://localhost:50342/oauth2/token?resource=https://management.azure.com/&#39; HTTP/1.1 Metadata: true</code></td>
    </tr>
   </tbody>
  </table>


  <p>トークン要求に IMDS を使用すると、いくつかの利点があります。</p>


  <ul>
   <li>
   <p>Azure IaaS Windows&nbsp;サポートされている Linux OS&rsquo; とすべてのユーザーがマネージド ID を使用できます。</p>
   </li>
   <li>
   <p>マネージド ID によって保護された下で使用される資格情報は、VM でホストされなくなりました。 これらは、Azure VM のホストでホストされ、セキュリティで保護されています。</p>
   </li>
  </ul>


  <ul>
   <li>
   <p>VM でマネージド ID を有効にすると、より簡単かつ高速になります。 VM 拡張機能は不要です。</p>
   </li>
  </ul>


  <p>Azure インスタンスメタデータ サービスの詳細&#39;についてはInstance Metadata Service Azure <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service">Instance Metadata service のドキュメントを参照してください</a>。</p>


  <h2>仮想マシン拡張機能の非推奨</h2>


  <p>マネージド ID トークン要求に IMDS を使用する利点を考慮して、既存の VM 拡張機能を非推奨とします。 マネージド ID のプレビュー フェーズでは、この拡張機能は非常に役立ちますが、一定の制限があり、一般提供プランには含めずにすることを決定しました。 制限事項の一部を次に示します。</p>


  <ul>
   <li>
   <p>サポートされているのは、特定の Linux ディストリビューションのみです。 サポートするディストリビューションごとに拡張機能を開発、変更、テストする必要があります。</p>
   </li>
   <li>
   <p>VM 拡張機能を使用すると、トークンの要求に使用される資格情報が VM に格納されます。 VM を正常に侵害した攻撃者は、資格情報を取り出す可能性があります。</p>
   </li>
   <li>
   <p>マネージド ID を使用して VM をデプロイすると、VM 拡張機能をプロビジョニングする必要が生じ、パフォーマンスに影響します。</p>
   </li>
   <li>
   <p>VM 拡張機能では、VM ごとに 32 のユーザー割り当てマネージド ID のみをサポートできます。 IMDS を使用すると、大幅に高い制限をサポートできます。</p>
   </li>
  </ul>


  <p>2019 年 1 月まで、VM 拡張機能をプレビュー 形式でサポートする予定です。 2019 年 1 月の終わりに、VM 拡張機能のサポートを停止し、IMDS エンドポイントがトークンを要求する唯一のメカニズムになります。</p>


  <h2>Azure Storageサポート</h2>


  <p>Azure Storage認証と RBAC 統合のプレビュー Azure AD発表しました。 これで、マネージド ID を使用して Azure Storage に直接認証できます。 詳細については、「チュートリアル: Linux VM を使用してマネージド ID&#39;を使用して仮想マシン<a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-service-identity/tutorial-linux-vm-access-storage">にアクセスする」をAzure Storage</a>。</p>


  <h2>VSTS でのビルドエージェントとリリース エージェントのサポート</h2>


  <p>Visual Studio Team Servicesエージェントのマネージド ID ベースの認証をサポートする機能が追加されました。 詳細については、「Azure 内のエージェント VM から認証を効率化する」を <a href="https://docs.microsoft.com/en-in/vsts/release-notes/2018/may-30-vsts">参照Azure Resource Manager</a>。</p>


  <h2>App ServiceとAzure Functionsサポート</h2>


  <p>システム割り当てマネージド ID と App Services Azure Functionsの統合が一般提供されています。 詳細については、「 <a href="https://blogs.msdn.microsoft.com/appserviceteam/2018/06/26/announcing-general-availability-and-sovereign-cloud-support-of-managed-service-identity-for-app-service-and-azure-functions/">Announcing General Availability and Sovereign Cloud Support of Managed Service Identity for App Service and Azure Functions」を参照</a>してください。</p>


  <h2>リッスン&#39;する必要があります</h2>


  <p>ここまでお読みありがとうございます。 チームは、VM と VM スケール セットのマネージド ID の最後のタッチに取り組むのに苦労しています。</p>


  <p>この 2 分間の調査を通Azure ADマネージド サービス ID に関するフィードバック<a href="https://aka.ms/managedidentitysurvey">をお寄</a>せください。 お客様のフィードバックは、お客様の好みと改善できる場所を知る上で非常に役立ちます。</p>


  <p>いつものように、ドキュメント&rsquo;内の問題<a href="https://stackoverflow.com/questions/tagged/azure-msi">Stack Overflow</a><a href="https://feedback.azure.com/forums/169401-azure-active-directory/category/164757-developer-experiences">、Azure</a> フィードバック、GitHubに関する情報をリッスン<a href="https://aka.ms/azuremsi">しています</a>。</p>
