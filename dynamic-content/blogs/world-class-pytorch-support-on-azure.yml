### YamlMime:Yaml
ms.openlocfilehash: d7f1aa35272a61b3281ec94fb4c8f46e04e4e4b1
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139889622"
Slug: world-class-pytorch-support-on-azure
Title: Azure での世界クラスの PyTorch のサポート
Summary: 2016年10月の PyTorch の最初のリリースからの過去2年間に、研究機関、業界、AI コミュニティの大規模なディープラーニングフレームワークの迅速で自然な導入が促進ました。
Content: "<p>現在、Azure で PyTorch をサポートするためのコミットメントを強化することが期待されています。これは、 <a href=\"https://azure.microsoft.com/en-us/services/machine-learning-service/\" target=\"_blank\">Azure Machine Learning</a>のパブリックプレビューの更新で魅力的な新機能を備えています。 さらに、PyTorch のサポートは、AI プラットフォームの多くのサービスやツールの中でも大幅に拡張されています。これについては、以下で説明します。</p>\n\n<p>過去2年間、2016年10月の PyTorch&#39;s リリース以降、促進は研究機関、業界、AI コミュニティの大規模なディープラーニングフレームワークを迅速かつ自然に採用してき&#39;ました。 PyTorch&#39;s の Python 優先の統合と命令型のスタイルは、調査担当者の間でフレームワークを利用していましたが、最新の <a href=\"https://code.fb.com/ai-research/facebook-accelerates-ai-development-with-new-partners-and-production-capabilities-for-pytorch-1-0\" target=\"_blank\">PyTorch 1.0 リリース</a> は、プロトタイプ作成から運用まで、完全なエンドツーエンドのディープラーニングプラットフォームにするために必要な運用レベルの準備とスケーラビリティをもたらします。</p>\n\n<h2>Azure で PyTorch を使用する4つの方法</h2>\n\n<h3>Azure Machine Learning service</h3>\n\n<p>Azure Machine Learning (Azure ML) サービスはクラウドベースのサービスであり、データ科学者は、データの準備とトレーニングからモデルの管理とデプロイまで、エンドツーエンドの機械学習ワークフローを実行できます。 サービス&#39;s rich Python SDK を使用すると、Jupyter notebook やコードエディターなどの任意の Python 開発環境から簡単に PyTorch モデルをトレーニング、ハイパーパラメーター調整、デプロイすることができます。 azure ML&#39;のディープラーニングトレーニング機能を使用すると、ローカルコンピューター上の PyTorch モデルのトレーニングからシームレスに移行して、azure クラウドへのスケールアウトを行うことができます。</p>\n\n<p>この単純な行を使用して、Python SDK をインストールできます。</p>\n\n<pre>\npip install azureml-sdk</pre>\n\n<p>azure ML サービスを使用するには、azure<a href=\"https://azure.microsoft.com/en-us/free/\" target=\"_blank\">アカウント</a>と azure サブスクリプションへのアクセスが必要です。 最初に必要なのは、Azure Machine Learning ワークスペースを作成することです。 ワークスペースは、他の Azure リソースとトレーニングの実行を管理する一元化されたリソースです。</p>\n\n<pre>\nws = Workspace.create(name=&#39;my-workspace&#39;,\n                       subscription_id=&#39;&lt;azure-subscription-id&gt;&#39;,\n                       resource_group=&#39;my-resource-group&#39;)</pre>\n\n<p>PyTorch を最大限に活用するには、トレーニング用に少なくとも1つの GPU と、より複雑なモデルと大規模なデータセットのためのマルチノードクラスターにアクセスする必要があります。 Python SDK を使用すると、単一ノードおよび分散 PyTorch トレーニングのための Azure compute を簡単に利用できます。 次のコードスニペットでは、自動スケール、GPU 対応 Azure Batch AI クラスターが作成されます。</p>\n\n<pre>\nprovisioning_config = BatchAiCompute.provisioning_configuration(vm_size=&quot;STANDARD_NC6&quot;,\n                                           autoscale_enabled=True,\n                     cluster_min_nodes=0,\n                     cluster_max_nodes=4)\ncompute_target = ComputeTarget.create(ws, provisioning_config)</pre>\n\n<p>ここから必要なのは、トレーニングスクリプトだけです。 次の例では、Azure ML 実験を作成して、実行を追跡し、分散型の4ノード PyTorch トレーニング実行を実行します。</p>\n\n<pre>\nexperiment = Experiment(ws, &quot;my pytorch experiment&quot;)\n\npt_estimator = PyTorch(source_directory=&#39;./my-training-files&#39;,\n                  compute_target=compute_target,\n                  entry_script=&#39;train.py&#39;,\n                  node_count=4,\n                  process_count_per_node=1,\n                  distributed_backend=&#39;mpi&#39;,\n                  use_gpu=True)\n\nexperiment.submit(pt_estimator)</pre>\n\n<p>モデル&#39;s のパフォーマンスをさらに最適化するために、Azure ML には、ハイパーパラメーターのさまざまな組み合わせをスイープする<a href=\"https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-tune-hyperparameters\" target=\"_blank\">ハイパーパラメーターのチューニング</a>機能が用意されています。 Azure ML では、トレーニングジョブのスケジュールを設定します。これにより、問題のある実行が早期に終了し、チューニングプロセスの豊富な視覚化が提供されます。</p>\n\n<pre>\n# parameter sampling\nparam_sampling = RandomParameterSampling(\n      &quot;learning_rate&quot;: loguniform(-10, -3),\n      &quot;momentum&quot;: uniform(0.9, 0.99)\n)\n\n# early termination policy\npolicy = BanditPolicy(slack_factor=0.15, evaluation_interval=1)\n\n# hyperparameter tuning configuration\nhd_run_config = HyperDriveRunConfig(estimator=my_estimator,\n                           hyperparameter_sampling=param_sampling,\n                           policy=policy,\n                           primary_metric_name=&#39;accuracy&#39;,   \n                           primary_metric_goal=PrimaryMetricGoal.MINIMIZE,\n                           max_total_runs=100,\n                           max_concurrent_runs=10,\n)\nexperiment.submit(hd_run_config)</pre>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3294a408-eb95-46b6-83f7-e315d5c2c28f.png\"><img alt=\"hyperdrive\" border=\"0\" height=\"1212\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0831bfca-90cd-43cf-8114-5aea30218dc7.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"ハイパードライブ\" width=\"1520\"></a></p>\n\n<p>最後に、データ科学者とエンジニアは、Python SDK を使用して、トレーニング済みの PyTorch モデルを Azure Container Instances または Azure Kubernetes Service にデプロイします。</p>\n\n<p>Azure Machine Learning&#39;s 完全なオファリングの<a href=\"https://azure.microsoft.com/en-in/blog/what-s-new-in-azure-machine-learning-service/\" target=\"_blank\">包括的な概要</a>を確認できます。また、Azure ML での PyTorch モデルのトレーニングとデプロイに関する<a href=\"https://github.com/Azure/MachineLearningNotebooks\" target=\"_blank\">完全なチュートリアル</a>もご覧いただけます。</p>\n\n<h2>データ サイエンス仮想マシン</h2>\n\n<p>Azure では、データサイエンス実験専用のカスタマイズされた VM である <a href=\"https://docs.microsoft.com/azure/machine-learning/data-science-virtual-machine/overview\" target=\"_blank\">Data Science Virtual Machine</a> (dsvm) も提供しています。 DSVM は、PyTorch などの一般的なデータサイエンスおよびディープラーニングツールの包括的なセットと共に事前に構成され、プレインストールされています。 DSVM は、PyTorch を使用してモデルを構築するときに、競合のない開発エクスペリエンスが必要な場合に最適なオプションです。 PyTorch のすべての機能を利用するには、GPU ベースの DSVM を使用できます。これは、必要な GPU ドライバーと PyTorch の GPU バージョンと共にプレインストールされます。 DSVM は、最新の安定した PyTorch 0.4.1 リリースと共にプレインストールされており、PyTorch 1.0 preview に簡単にアップグレードできます。</p>\n\n<h2>Azure Notebooks</h2>\n\n<p>Azure Notebooks は、ブラウザーで対話形式でコーディングするために使用できる、クラウドでホストされた無料の Jupyter Notebook ソリューションです。 Azure Notebooks コンテナーにプレインストールされているので、フレームワークをインストールしたり、独自の notebook サーバーをローカルで実行したりしなくても、PyTorch を試してみることができます。 さらに、Azure Notebooks に関する公式の最新の PyTorch チュートリアルの管理された <a href=\"https://notebooks.azure.com/pytorch\" target=\"_blank\">ライブラリ</a> が用意されています。 PyTorch の使用は、Azure アカウントの作成と、独自のライブラリへのチュートリアルノートブックの複製と同様に簡単です。ラーニング</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4bdc95be-7fe6-468c-8b48-6119cf08091d.png\"><img alt=\"1977\" border=\"0\" height=\"1260\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4df3e74d-f7df-4c1f-a99c-af7afd176bca.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"1977\" width=\"1849\"></a></p>\n\n<h3>Visual Studio Code Tools for AI</h3>\n\n<p>Visual Studio Code (VS Code) は、一般的で軽量なソースコードエディターです。 <a href=\"https://visualstudio.microsoft.com/downloads/ai-tools-vscode/\" target=\"_blank\">VS Code Tools for AI</a>は、IDE を使用するデータ科学者や開発者向けのディープラーニングおよび AI 実験機能を提供するクロスプラットフォーム拡張機能です。 AI 用ツールは Azure Machine Learning サービスと緊密に統合されているため、Azure compute に PyTorch ジョブを送信し、実験の実行を追跡し、トレーニング済みのモデルをすべて VS Code 内からデプロイできます。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9e3ae3ea-e9bf-42ab-ade0-af7062fc5224.png\"><img alt=\"vscodetoolsforai\" border=\"0\" height=\"1392\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/36f1a0b0-5fc8-4125-abc6-256c1e6a6e01.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"vscodeツール forai\" width=\"2233\"></a></p>\n\n<p>また、 <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-toolsai.vscode-ai#overview\">Tools FOR AI</a> 拡張機能には、構文の強調表示の豊富なセット、IntelliSense による自動コード補完、PyTorch api 用の組み込みのドキュメント検索が用意されています。</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/975c5fbe-0a91-4ab9-8e0b-0cd3d7937617.png\"><img alt=\"vscodetoolsforai2\" border=\"0\" height=\"1394\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/29812ca3-0b83-478f-95b7-a410b0e66bfb.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"vscodetoolsforai2\" width=\"2233\"></a></p>\n\n<h2>PyTorch に対する Microsoft の投稿</h2>\n\n<p>最後に、PyTorch の開発者のすばらしいコミュニティに、PyTorch プラットフォームに対するイノベーションや機能強化に貢献しています。 すぐに予定されている一部の投稿では、PyTorch データの読み込みと処理が改善されています。これには、パフォーマンスの向上、Markov モデル Toolkit のデータ読み取りサポート、音声データセット用のデータローダー、Azure Blob Storage 用のデータローダーが含まれます。 さらに、PyTorch Windows サポートのための完全なパリティと、ONNX 標準に準拠した完全な ONNX カバレッジを実現することに取り組んでいます。 また、MSR イノベーションを PyTorch に組み込むために、Microsoft Research (MSR) と密接に連携しています。</p>\n\n<p>Microsoft では、このようなオープンソースの AI テクノロジの進歩に注力し、貢献することを専門としています。 1年前に、 <a href=\"https://onnx.ai/\" target=\"_blank\">Open ニューラルネットワーク Exchange</a> (ONNX) で Facebook との共同作業を開始しました。これにより、ONNX モデル表現標準を使用したニューラルネットワークのフレームワークの相互運用性と共有の最適化が促進されます。 Microsoft では、Azure での PyTorch の取り組みにより、AI オファリングのエコシステムを継続的に拡張し、研究と業界での豊富な開発を可能にします。</p>"
