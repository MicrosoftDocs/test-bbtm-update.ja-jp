### YamlMime:Yaml
ms.openlocfilehash: 8e4c20d2edaad4cab9ae5f83474f568c6ead5459
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139909807"
Slug: how-azure-security-center-detects-a-bitcoin-mining-attack
Title: Azure Security Center が Bitcoin マイニング攻撃を検出する方法
Summary: Azure Security Center は、グローバルな脅威インテリジェンスによってサポートされる高度な分析を使用して、お客様が脅威の myriads を処理するのに役立ちます。 さらに、多くの場合、セキュリティ研究者のチームは...
Content: >-
  <p>Azure Security Center は、グローバルな脅威インテリジェンスによってサポートされる高度な分析を使用して、お客様が脅威の myriads を処理するのに役立ちます。 さらに、多くの場合、セキュリティ研究者のチームは顧客と直接連携して、Microsoft Azure の顧客に影響するセキュリティインシデントについての洞察を得ることができます。また、Security Center の検出機能とアラート機能を絶えず向上させることが目標となります。</p>


  <p>前のブログ記事 &nbsp; &quot; では、Azure Security Center によって<a href="https://azure.microsoft.com/en-us/blog/how-azure-security-center-helps-reveal-a-cyberattack/">局面</a> &quot; がどのように公開されるかを説明しています。セキュリティ研究者は、Security Center によって検出されたブルートフォース攻撃と、攻撃を調査して修復するために実行する手順について詳しく説明しています。 この記事 &rsquo; では、Cryptonight という名前の既知の暗号コインマイニングアルゴリズムを使用して、調査担当者がマイニングアクティビティのリングを検出するための Azure Security Center 検出に焦点を当てます。</p>


  <p>詳細に進む前に、 &rsquo; このブログ全体に表示される &rsquo; いくつかの用語について簡単に説明します。 &ldquo;Cryptocoin マイナー &rdquo; は、特殊なソフトウェアクラスであり、マイニングアルゴリズムを使用して、デジタル通貨の形式である cryptocoin を生成または &ldquo; 採掘 &rdquo; します。 多くの場合、マイニングソフトウェアは、中央処理装置 (CPU) やグラフィックスプロセッシングユニット (GPU) のようなシステムハードウェアリソース、および影響を受けるホストのネットワーク帯域幅をハイジャックなどするため、悪意のあるものとしてフラグが設定されます。 Cryptonight は、ホスト &rsquo; の CPU に特に依存するマイニングアルゴリズムの1つです。 この調査では、悪意のあるダウンロード、悪意のあるリンクを使用した電子メール、既にインストールされているマルウェアによってダウンロードされた添付ファイル、ピアツーピアのファイル共有ネットワーク、およびクラックされたインストーラー/browserify を含む、さまざまな手法を使用して、cryptocoin マイナーをインストールしまし &rsquo; た。</p>


  <h2>初期 Azure Security Center アラートの詳細</h2>


  <p>次のような疑わしいプロセスの実行が検出され、アラートが作成されると、最初の調査が開始されました Azure Security Center。 アラートには、検出されたアクティビティの日付と時刻、影響を受けたリソース、サブスクリプション情報などの詳細が表示され、この場合に検出されたハッカーツールに関する詳細なレポートへのリンクが含まれています。</p>


  <table border="0" cellpadding="2" cellspacing="0" width="999">
      <tbody>
          <tr>
              <td valign="top" width="499"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c89aed15-ffd5-4594-a750-972dfa7548b5.png"><img alt="Suspicious process executed" border="0" height="438" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d8c54e24-6aab-44d4-82dd-e9d454b275d7.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="疑わしいプロセスの実行" width="321"></a></td>
              <td valign="top" width="499"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5b1ba836-0a52-4f87-8d77-33156f12daab.png"><img alt="Threat summary" border="0" height="426" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/fd5f79f1-e8a9-4d4f-938d-03843e6214d0.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="脅威の概要" width="328"></a></td>
          </tr>
      </tbody>
  </table>


  <p>HackTool: Win32/Ssh-keygen &quot; として &ldquo; 検出された疑わしいダウンロードによって最初の侵害が明らかになった、より詳細な調査を開始しました。 &nbsp;このボックスの管理者の1人が、通常は一部のソフトウェアキーの修正または &quot; クラック &quot; に使用するツールをダウンロードしようとしています。 多くの場合、マルウェアはこれらのツールと共にインストールされるため、攻撃者はバックドアを使用して箱にアクセスできます。</p>


  <ul>
      <li>ログ分析に基づいて、攻撃は<em>* server $ &rdquo; という名前 &ldquo; </em>のユーザーアカウントの作成によって開始されました。</li>
      <li><em>* Server $ &rdquo; アカウントによって、 &ldquo; </em> ngm &rdquo; という &quot; スケジュールされたタスクが作成されます。 このタスクは、 &quot; C:\ Windows \temp\ngmtx &quot; フォルダーにあるkit.bat&rdquo; という名前 &quot; のバッチスクリプトを起動しました。</li>
      <li>次に、cryptonight 関連のパラメーターを使用して、 <em>servies.exe</em> &ldquo; &nbsp; という名前 &quot; のプロセスを起動しました。</li>
      <li><u>注</u>: <em>bond 007.01</em> &rsquo; は &lsquo; 、このアクティビティ &lsquo; の背後にある cryptocoin ユーザー &rsquo; アカウントを表し、x &rsquo; はパスワードを表します。</li>
  </ul>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/aa230f28-4341-4f76-b99d-fbc21c3587c9.png"><img alt="Image 1" border="0" height="212" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8b25670e-79c3-4f19-95f4-21aeb390801a.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="画像1" width="611"></a></p>


  <p>2日後に、異なるファイル名で同じアクティビティを確認したことになります。 次のスクリーンショットでは、sst.bat が kit.bat 置き換えられ、mstdc.exe が servies.exe に置き換えられました。 バッチファイルとプロセス実行の同じサイクルが定期的に確認されました。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5a258c57-bb4b-4958-ab97-c8aad431b16e.png"><img alt="Image 2" border="0" height="249" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a8090a9e-c18d-49ef-8e36-7ce0e2f7d6f8.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="画像2" width="601"></a></p>


  <p>これらの .bat スクリプトは、crypto net プール (XCN またはサメのコイン) への接続の作成に使用され、スケジュールされたタスクによって起動され、約1時間ごとにこれらの接続を再起動します。</p>


  <p><strong>その他の監視:</strong>Cryptocoin サービスに接続して cryptocoin を生成するために使用されるダウンロードされた実行可能ファイルは、元の、32.exe または 64.exe から、それぞれmstdc.exe&rdquo; および &ldquo;servies.exe&rdquo; に &ldquo; 変更されます。 これらの実行可能ファイル &rsquo; の名前付けスキームは、悪意のあるバイナリを簡単に隠しようとしている攻撃者によって使用される従来の手法に基づいています。 この手法では、ファイルの Windows ファイル名が正しくない形式になるようにファイルを作成しようとします。</p>


  <ol>
      <li><strong><u>Mstdc.exe:</u></strong> &ldquo;<em>mstdc.exe</em> &rdquo;Windows システムの正当な実行可能ファイルである<em>msdtc.exe</em> &rdquo; のようなもの &ldquo; です。つまり、microsoft Exchange やクラスターにインストールされている SQL Server などのさまざまなアプリケーションで必要とされる microsoft 分散トランザクションコーディネーターです。</li>
      <li><u><strong>Servies.exe:</strong></u>同様<em>services.exe</em> &rdquo; に、 &ldquo; 正当なサービスコントロールマネージャー (SCM) は、Windows NT ファミリのオペレーティングシステムで特別なシステムプロセスであり、Windows サービスプロセスを開始、停止、および操作します。 ここでも、攻撃者は同様のバイナリを使用して非表示にしようとしています。 &ldquo;<em>Servies.exe</em> &rdquo;<em>services.exe</em> &rdquo; 、非常によく似て &ldquo; いますよ &rsquo; ね。 攻撃者が使用する優れた戦術。</li>
  </ol>


  <p>タイムラインのログ分析と同様に、VBScript &rdquo; を使用して &ldquo;test.zip&rsquo; を実行<em> &lsquo; </em>する wscript.exe を含むその他のアクティビティについても説明しました。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e014a477-b785-4db7-a0df-8eb61f6ff95b.png"><img alt="Image 3" border="0" height="306" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d5886ee6-6cd1-4e6f-823d-ecc8e922a1c2.png" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="画像3" width="733"></a></p>


  <p>抽出時に、韓国で IP アドレスと通信していた<em>iissstt &rsquo; ファイルが明らか &lsquo; </em>になりました。 mofcomp.exeコマンドを実行すると、 <em> &lsquo; iisstt ファイルが WMI に登録されます。 &rsquo; </em> mofcomp.exe コンパイラは、MOF ステートメントを含むファイルを解析し、ファイルで定義されているクラスとクラスのインスタンスを WMI リポジトリに追加します。</p>


  <h2>推奨される修復手順と軽減策</h2>


  <p>最初のセキュリティ侵害は、コンピューターが完全に侵害される原因となったインストーラー/browserify によるマルウェアのインストールの結果でした。 そのため、可能であれば、まずコンピューターを再構築することをお勧めします。 ただし、これはすぐには実行できないことを理解しているため、次の修復手順を実装することをお勧めします。</p>


  <p>1. <u>パスワードポリシー</u>: 影響を受けるホストのすべてのユーザーのパスワードをリセットし、パスワードポリシーがベストプラクティスを満たしていることを確認します。</p>


  <ul>
      <li><a href="https://technet.microsoft.com/en-us/library/ff741764.aspx">パスワードポリシーを適用するためのベストプラクティス</a>&nbsp;</li>
      <li><a href="https://msdn.microsoft.com/en-us/library/cc875839.aspx">セキュリティで保護されたパスワードの選択</a></li>
      <li><a href="https://msdn.microsoft.com/en-us/library/ms851492(v=winembedded.11).aspx">強力なパスワードの使用</a></li>
  </ul>


  <p>2. <u>Defender scan</u>: Microsoft Antimalware または別のソリューションを使用して、マルウェア対策スキャンを実行します。これにより、潜在的なマルウェアにフラグを付けることができます。</p>


  <p>3. <u>ソフトウェア更新プログラムの考慮事項</u>: OS とアプリケーションが最新の状態に保たれていることを確認します。 Azure Security Center は、重要な OS とセキュリティ OS の更新プログラムが不足している仮想マシンを特定するのに役立ちます。</p>


  <p>4. <u>OS の脆弱性 &amp; バージョン</u>: os 構成と、最も強化されたバージョンの os に推奨される規則を揃えます。 たとえば、パスワードの保存を許可しません。 クラウドサービスのオペレーティングシステム (OS) のバージョンを、OS ファミリで使用可能な最新バージョンに更新します。 Azure Security Center を使用すると、これらの推奨事項に適合しない OS 構成や、Cloud Services の実行中の OS バージョンを特定するのに役立ちます。</p>


  <p>5. <u>バックアップ</u>: 定期的なバックアップは、ソフトウェア更新管理のプラットフォーム自体だけでなく、更新されるサーバーにも重要です。 更新が失敗した場合のロールバック用構成を確保できるように、必ずシステムを定期的にバックアップしてください。</p>


  <p>クラックされた6. <u>ソフトウェアの使用を避ける</u>: 悪意のあるソフトウェアを使用すると、マルウェアや海賊版ソフトウェアに関連するその他の脅威によって、自宅や業務に不要なリスクが生じます。 マイクロソフトは、お客様の組織によって推奨されているように、ひび割れされたソフトウェアの使用と、法的なソフトウェアポリシーの evading を強く推奨します。</p>


  <p>詳細については、以下を参照してください。</p>


  <ul>
      <li><a href="https://www.microsoft.com/en-us/piracy/industryinfo.aspx">ソフトウェアの不正コピーのリスクについて教育</a>します。</li>
      <li>詳細については、「SIRv13」を参照してください。<a href="https://blogs.technet.microsoft.com/mmpc/2012/10/09/sirv13-be-careful-where-you-go-looking-for-software-and-media-files/">ソフトウェアとメディアファイル</a> &rdquo; を探す場所に注意して &ldquo; ください。&nbsp;</li>
  </ul>


  <p>7. <u>電子メール通知</u>: 最後に、このような脅威が検出された場合に電子メール通知を送信するように Azure Security Center を構成します。</p>


  <ul>
      <li>[防止] セクションの [ポリシー] タイルをクリックします。</li>
      <li>[セキュリティポリシー] ブレードで、電子メール通知を構成するサブスクリプションを選択します。</li>
      <li>これにより、[セキュリティポリシー」ブレードが表示されます。 電子メールアラートを構成するには、[電子メール通知] オプションをクリックします。</li>
  </ul>


  <p>Azure Security Center からの電子メールアラートは次のようになります。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9e750a52-c47a-4947-b4ff-ae9f964991da.jpg"><img alt="Notification" border="0" height="465" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9f691664-9152-4485-9238-0a67c542ee99.jpg" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" title="通知 " width="324"> </a> Azure Security Center の詳細については、以下を参照してください。</p>


  <ul>
      <li><a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-detection-capabilities">Azure Security Center の検出機能</a> &mdash; Azure Security Center &rsquo; の高度な検出機能について説明します。</li>
      <li>Azure Security Center &mdash; <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts">でのセキュリティの警告の管理と対応</a>セキュリティの警告を管理し、対応する方法について説明します。</li>
      <li>Azure Security Center &mdash; <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-recommendations">でのセキュリティに関する推奨事項の管理</a>推奨事項が Azure リソースの保護にどのように役立つかについて説明します。</li>
      <li>Azure Security Center &mdash; <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-monitoring">でのセキュリティ正常性の監視</a>Azure リソースの正常性を監視する方法について説明します。</li>
      <li>Azure Security Center &mdash; <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-partner-solutions">を使用したパートナーソリューションの監視</a>パートナーソリューションの正常性状態を監視する方法について説明します。</li>
      <li><a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-faq">AZURE SECURITY CENTER FAQ</a> &mdash; サービスの使用に関してよく寄せられる質問を紹介します。</li>
      <li><a href="https://blogs.msdn.com/b/azuresecurity/">Azure セキュリティブログ</a> &mdash; Azure のセキュリティに関する最新のニュースと情報を入手できます。</li>
  </ul>
