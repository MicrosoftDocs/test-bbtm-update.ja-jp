### YamlMime:Yaml
ms.openlocfilehash: f8f1954fbebb0cf342076ff6d7cd850484d17df2
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139893260"
Slug: app-insights-app-map-and-profiler
Title: Application Insights 診断のプレビュー
Summary: この記事では、Application Insights の2つの新機能のプレビューについて説明します。上位のエラーウィンドウが表示された新しいマルチサービスアプリケーションマップと新しい Application Insights Profiler です。これにより、遅い要求のトレース例の詳細を確認できます。
Content: >-
  <p><strong>これらの機能は一般公開されているので、この投稿の内容は古くなっています。最新情報については、 <a href="https://docs.microsoft.com/azure/application-insights/app-insights-profiler">Profiler のドキュメント </a>と <a href="https://docs.microsoft.com/azure/application-insights/app-insights-app-map"><u>アプリケーションマップのドキュメント</u></a> を参照してください。</strong></p>


  <p>最近の Connect () イベントでは、 <a href="https://azure.microsoft.com/en-us/blog/general-availability-of-azure-application-insights/">Application Insights の一般公開が発表</a>されました。一般に使用できる機能が多数用意されています。 この記事では、Application Insights するために準備されている2つの新しい診断機能のプレビューをご紹介 &rsquo; します。</p>


  <ul>
   <li>複数のコンポーネントの正常性状態を確認し、ピンポイントの問題を検出し、例外を簡単に見つけられるようにする<a href="https://aka.ms/AIAppMapPreview">アプリケーションマップの機能強化</a>。</li>
   <li>新しい<a href="https://aka.ms/AiProfilerPreview">Application Insights Profiler</a>。遅い要求のトレース例を詳しく確認し、コードの詳細な分析を掘り下げて、最も時間がかかっている場所を確認できます。</li>
  </ul>


  <p>これらの機能のクイックツアーは、 <a href="https://channel9.msdn.com/Events/Connect/2016/201">Connect () のビデオ</a>をご覧ください。</p>


  <p><iframe allowfullscreen="" frameborder="0" height="540" src="https://channel9.msdn.com/Events/Connect/2016/201/player" width="960"></iframe></p>


  <h2>エラーウィンドウが表示されるマルチコンポーネントアプリケーションマップ</h2>


  <p>アプリケーションマップを使用して、サービスの全体的な正常性を把握し、問題のある箇所を特定して、トリアージと根本原因に関する問題を解決するのに役立つ豊富な情報を取得します。 Application insights では、Application Insights にデータを送信する Azure コンピューティングリソースとしてコンポーネントを参照します。各コンポーネントは、送信するテレメトリに対して異なるインストルメンテーションキーを使用します。 このマップでは、サービスが複数のコンポーネントで構成されている場合でも、一度に1つのコンポーネントに関する情報のみが表示されるようになりました。また、マップから詳細な例外情報に至るまでに多数のクリックがかかっていました。 このエクスペリエンスを向上させるために、プレビュー版では次の機能強化が行われています。</p>


  <ul>
   <li>同じアプリケーションマップに複数のコンポーネントが表示されるようになりました。</li>
   <li>コンポーネントをクリックすると、エラーウィンドウが表示され、上位のエラーの概要が表示されます。エラーをクリックすると、詳細な例外情報に直接ジャンプできます。</li>
  </ul>


  <p>Application Insights によって監視されている複数のコンポーネントがある場合は、これらのすべてのコンポーネントを同じマップに表示し、それらの間の呼び出しを表示できます。 .NET と Node.js Sdk の両方で、コンポーネント間の呼び出しを検出する作業が完了しまし &rsquo; た。その結果、Node.js web アプリケーションと .Net WEB API バックエンドの両方を同じマップに表示できます。 次の図では、 <i>teamスタンドアップ-web</i> は Node.js web コンポーネントであり、 <i>teamスタンドアップ api</i> は .net REST API コンポーネントです。</p>


  <p>&nbsp;</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0b4b498b-a493-4c6f-ae9f-255308f2eb10.png"><img alt="Multiple service nodes on the application map" border="0" height="546" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d07e79a4-2eb8-496d-8437-8c025e615f6f.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="アプリケーションマップ上の複数のサービスノード" width="1481"></a></p>


  <p>マップには、現在選択されているコンポーネントの着信呼び出しと発信呼び出しが反映されます。 上記の web ブラウザーでは、 <i>teamスタンドアップ web</i> コンポーネントを呼び出すことができます。 また、右側にはエラーウィンドウが表示され、そのコンポーネントで発生したエラーが操作名 (つまり URL) とエラーが発生した関数でグループ化されています。</p>


  <p><i>Teamスタンドアップ api</i>コンポーネントをクリックすると、.net api からの出力方向のデータベース呼び出しを確認できます。また、<i>事後チェックイン</i>メソッドで23個の例外がスローされていることがわかります。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4a0e31af-6190-416c-9635-4e3cb81777da.png"><img alt="Error pane and exception details blade" border="0" height="893" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/31ae9f1a-d185-473f-97ba-fc6b05370e38.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="エラーウィンドウと例外の詳細ブレード" width="1471"></a></p>


  <p><i>System.argumentnullexception</i>をクリックすると、再設計された例外の詳細ブレードが表示されるため、例外の名前とメッセージを簡単に確認できます。 ここから、例外に関連するログの検索、新しい作業項目の作成、または web の検索などのクイックアクションを実行できます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f4bec611-50ab-41bc-ba6b-0136690c5b9b.png"><img alt="Jump from exception details to log search" border="0" height="681" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/89839953-dd6e-4acb-bb5a-e2e94fbd8d3d.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="例外の詳細からログ検索へのジャンプ" width="1107"></a></p>


  <p>これは、問題を簡単に見つけて、サービスの上位のエラーにドリルダウンできるよう &rsquo; にするための簡単なツアーでした。 これらの機能を試してフィードバックをお寄せいただくには、Application Insights SDK を更新する手順 (マルチコンポーネントマップに必要) とポータルでのこれらの機能の有効化について、 <a href="https://aka.ms/aiappmappreview">Application Insights アプリケーションマップのプレビュー</a>を &nbsp; 確認してください。</p>


  <h1>Application Insights Profiler</h1>


  <p>運用環境で実行されている場合は、低速な要求の予期しない原因が多数存在する可能性があります。 多くの場合、最も時間のかかる要求がありますが、速度が低下することがあります。</p>


  <p>新しい Application Insights Profiler はオーバーヘッドが低く、実行中のサービスで定期的にプロファイリングを有効にし、興味深い問題が発生した場合にアプリケーションのパフォーマンストレースの詳細な例を収集します。 これは、さまざまな問題について、詳細なプロファイル (要求の実行時間のコードレベルの内訳) に関する興味深い問題の例があることを意味 &rsquo; し &rsquo; 、時間がかかる場所を特定するために必要な詳細を説明します。 私たちは、最も低速な要求 (95<sup>パー</sup> センタイルのロングテールでも) を特定してトリアージし、記録された例を使用して要求の速度を低下させていることを特定するために、プロファイラーが役に立つと考えています。</p>


  <p>プロファイラーから結果にアクセスするには、[パフォーマンス] ブレードの [例] 列をクリックして、特定の操作の例を確認します。</p>


  <p>&nbsp;</p>


  <p>&nbsp;</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2e99471f-5a42-4baa-927b-604a41598d49.png"><img alt="Performance blade shows 95th percentile and examples column" border="0" height="615" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1dc70e52-0ff2-427d-970f-74521579553c.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="[パフォーマンス] ブレードに、95パーパーセンタイルと例の列が表示されます。" width="853"></a></p>


  <p>このテーブル<sup>に95パーセンタイル</sup> 列を追加しました。これにより、各要求の通常のパフォーマンスと長いテールのパフォーマンスを比較することができます。 例をクリックすると新しいページが表示され、さまざまな応答パーセンタイルで要求の一覧が表示されます。既定では、最も低速なものを選択します。</p>


  <p align="left"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/929028f1-ec7e-404d-bad2-184353953ae7.png"><img alt="See sample requests in various percentile buckets" border="0" height="785" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/431943dc-c6dd-48a5-9e77-07f4675e1f2e.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="さまざまな百分位バケットのサンプル要求を参照してください" width="462"></a></p>


  <p>各要求について、その要求中に呼び出された関数のコールツリーと、各関数に費やされた経過時間が示されます。 右側のグラフは、コードの時間の経過と共に視覚エフェクトを提供します。</p>


  <p align="center"><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8f035aa3-6e48-42dd-84b9-db27015ebdb9.png"><img alt="Call tree shows where time is being spent in each function" border="0" height="459" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e34adb86-31e4-4873-84be-7dba6964babf.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="コールツリーは、各関数で時間が費やされている場所を示します。" width="1369"></a></p>


  <p align="left">Azure App Service で実行されているサービスがあり、そのパフォーマンスを向上させる方法を知りたい場合は、アカウントでプロファイラーを有効にし、フィードバックを送信する<a href="https://aka.ms/AiProfilerPreview">Application Insights Profiler を有効にする方法</a>を確認してください。</p>


  <h2>まとめ</h2>


  <p>&rsquo;これらの新しい診断機能を早期にプレビューして、実稼働アプリケーションの問題をより適切に診断および修正できるようにします。</p>


  <p><a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-get-dev-support#4-feedback-to-the-application-insights-team">Azure portal からフィードバックを送信する</a>か、この投稿にコメントを残して、ご意見をお聞かせください。</p>
