### YamlMime:Yaml
ms.openlocfilehash: f3067700c7b73dd8ae7ffc24cf39e422a9ebf4ce
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139910824"
Slug: detecting-fileless-attacks-with-azure-security-center
Title: Azure Security Center を使用した fileless 攻撃の検出
Summary: 攻撃の検出によってセキュリティソリューションが向上するにつれて、攻撃者は、検出を避けるために stealthier メソッドを利用することがますます高まっています。 Azure では、fileless 攻撃をターゲットにしています。
Content: >-
  <p>攻撃の検出によってセキュリティソリューションが向上するにつれて、攻撃者は、検出を避けるために stealthier メソッドを利用することがますます高まっています。 Azure では、顧客 &rsquo; のエンドポイントを対象とする fileless 攻撃を定期的に確認しています。 従来のウイルス対策ソフトウェアや他のファイルシステムベースの検出メカニズムによって検出されないように、攻撃者は悪意のあるペイロードをメモリに挿入します。 攻撃者のペイロードこっそりは、侵害されたプロセスのメモリ内に保持され、さまざまな悪意のあるアクティビティを実行します。&nbsp;</p>


  <p>Security Center &rsquo; s Fileless の攻撃検出の<a href="https://azure.microsoft.com/en-us/blog/strengthen-your-security-posture-and-protect-against-threats-with-azure-security-center/" target="_blank">一般提供</a>を発表します。 Fileless 攻撃検出を使用すると、自動化されたメモリフォレンジック手法によって、Fileless 攻撃ツールキット、手法、および動作が特定されます。 Fileless 攻撃検出は、実行時にコンピューターを定期的にスキャンし、セキュリティクリティカルなプロセスのメモリから直接洞察を抽出します。 悪用、コードの注入、悪意のあるペイロードの実行の証拠を見つけます。 ファイルレス攻撃の検出により、アラートのトリアージ、相関関係、およびダウン ストリームの応答時間を高速化するための詳細なセキュリティ アラートが生成されます。 このアプローチは、 <a href="https://www.microsoft.com/en-us/windowsforbusiness/windows-atp" target="_blank">Windows Defender ATP</a>などのイベントベースの EDR ソリューションを補完して、より多くの検出範囲を提供します。&nbsp;&nbsp;</p>


  <p>この記事では、Security Center &rsquo; s Fileless の攻撃検出によって、対象となる exploit payload または shellcode から、マルチステージ攻撃のさまざまな段階がどのように検出されるかについて詳しく説明します。 また、実際の検出に基づくアラートの例についても説明します。&nbsp;</p>


  <h2>検出 (シェルコードを)</h2>


  <p>脆弱性を悪用した後、攻撃者は通常、シェルコードと呼ばれる少数のアセンブリ命令を使用して、より多くの機能を持つペイロードを取得して読み込みます。 &nbsp; アドレス空間レイアウトのランダム化 (ASLR) が原因で、シェルコードは、追加のペイロードを取得/読み込みして実行制御を転送するために必要なオペレーティングシステム関数のアドレスをまず見つける必要があります。 一般的なシェルコードワークフローには次のようなものがあります。プロセス実行ブロックにアクセスする (peb)、インメモリ順序モジュールの一覧を走査して必要な機能を備えた os モジュールを特定し、PE イメージヘッダーとイメージのエクスポートディレクトリを解析して特定の os 機能のアドレスを検索します。</p>


  <p>さらに、シェルコードは、ペイロードの展開/暗号化解除、アクセス許可と特権の操作、アンチデバッグの手法の実行、コード実行制御のハイジャックなど、その他のアクティビティも実行します。&nbsp;</p>


  <p>上記のパターンは、メモリフォレンジック手法を使用して特定できます。 Fileless 攻撃検出は、一般的な対象プロセスの動的に割り当てられたコードセグメントにあるマシンコードを読み取ります。 その後、Fileless 攻撃検出はマシンコードを逆アセンブルし、静的な分析とターゲットのエミュレーション手法の両方を使用して悪意のある動作を識別します。&nbsp;</p>


  <h2>より複雑なペイロードの検出</h2>


  <p>また、Fileless 攻撃検出では、より複雑なペイロードも検出されます。これにより、任意の数の悪意のあるアクティビティを実行できます。 一般的な例としては、ユーザーの偽装、追加のソフトウェアの脆弱性による特権の拡大、アカウントの資格情報の盗難、証明書と秘密キーへのアクセス、奪取の新しいコンピューターへの移動、機密データへのアクセスなどがあります。 これらの機能は、攻撃者 &rsquo; の目的で再利用および変更できる既製のツールキットで利用できます。 Red teams と攻撃者が使用しているこれらの種類のツールキットを見てきました。&nbsp;</p>


  <p>Fileless の攻撃検出は、挿入されたモジュール、難読化されたモジュール、セキュリティに依存するオペレーティングシステムの機能への参照、既知の Fileless 攻撃ツールキットのインジケーターなど、多数のシグナルに対して動的に割り当てられたコードセグメントをスキャンすることで、このようなペイロードを識別します。 分類器は、これらのシグナルを分析し、適切な重要度のアラートを生成します。 また、分類器は、正当なセキュリティおよび管理ソフトウェアからの信号を除外します。多くの場合、fileless マルウェアと同様の手法を使用して、重要なシステム機能を監視します。</p>


  <h2>Fileless 攻撃検出の例のアラート</h2>


  <p>実際の検出に基づくアラートの例を次に示します。&nbsp;</p>


  <p>下図に示すように、Fileless 攻撃の検出によって toolkit: &ldquo; <a href="https://github.com/rapid7/metasploit-framework/wiki/Meterpreter" target="_blank">meterpreter</a>が識別されています。 &rdquo;Toolkit 名の下には、感染したプロセスのメモリに存在する特定の手法と動作の一覧が表示されます。 攻撃者が新規または不明なマルウェアを使用している場合でも、Fileless の攻撃の検出では、ペイロードから検出された技法と動作を強調するアラートが生成されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0097d944-cf53-4c95-901e-4c120320bd4f.png"><img alt="FilelessAttackTechnique" border="0" height="820" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3beeba64-31be-4b71-8f83-00941513d025.png" style="margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="FilelessAttackTechnique" width="845"></a></p>


  <p>このアラートには、侵害されたプロセスに関連付けられているメタデータも表示されます。 この場合、winlogon.exe で感染が発生したため、アカウントの資格情報を処理する実行時間の長いシステムプロセスが実行されています。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/867db291-6f3a-4a5f-b694-6e446799157d.png"><img alt="winlogon" border="0" height="305" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/77b78e07-f33b-4fda-a47e-0021bb3e7d0b.png" style="margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="winlogon" width="873"></a></p>


  <p>上記のメタデータのみに基づいて、プロセスは非常に通常のように見えます。 プロセスパス、コマンドラインパラメーター、または親/子プロセスの関係だけを調べるツールでは、セキュリティ侵害を特定するための十分な手掛かりは得られません。</p>


  <p>ただし、メモリフォレンジック手法を使用することで、存在する疑わしいコードセグメントの数、コードセグメントに存在する機能、動的に割り当てられたセグメントからコードを実行しているスレッドの検索、およびアラートへのその情報の出力を行うことができます。 プロセスにアクティブなネットワーク接続がある場合、リモート IP アドレスや開始時刻などの情報も表示されます。</p>


  <p>また、Log Analytics を使用して、悪意のあるアクティビティが最初に検出されたタイミングと場所を説明する、複数のプロセスやコンピューターからのアラートデータのビューを作成することもできます。 また、Log Analytics を使用して、ユーザーログオンデータなどの他のデータソースとこれらのアラートを関連付け、どのアカウントの資格情報が危険にさらされるかを判断することもできます。 この機能は、セキュリティ侵害の性質と範囲を決定するときに非常に役立ちます。</p>


  <h2>Security Center &rsquo; s Fileless 攻撃検出の概要</h2>


  <p>Fileless 攻撃検出では、Azure IaaS Vm と、他のクラウドまたはオンプレミスで実行される仮想マシンの両方がサポートされています。 サポートされているオペレーティングシステムには、Windows Server 2008 R2 以降、および Windows 7 クライアント以降があります。&nbsp;&nbsp;</p>


  <p>さまざまな種類の fileless 攻撃の詳細については、こちらの <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/fileless-threats" target="_blank">ドキュメント</a>を参照してください。</p>


  <p>Fileless 攻撃検出の使用を開始するには、サブスクリプションの <a href="https://azure.microsoft.com/en-us/services/security-center/" target="_blank">Standard レベルの Security Center</a> を有効にします。</p>
