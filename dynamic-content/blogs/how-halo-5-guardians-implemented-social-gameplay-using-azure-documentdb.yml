### YamlMime:Yaml
ms.openlocfilehash: b58ad62886fb4b522efee6730a3ba8d99ddd3981
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139893482"
Slug: how-halo-5-guardians-implemented-social-gameplay-using-azure-documentdb
Title: Halo 5 が Azure Cosmos DB を使用してソーシャルプレイゲームを実装した方法
Summary: 'halo 5 が halo: Spartan 企業コミュニティで Azure Cosmos DB 使用して何百万もの新しいゲーマーを処理する方法について説明します。'
Content: >-
  <p><em>chio、ソフトウェアエンジニア、Halo の Bing で共同作成します。</em></p>


  <div>&nbsp;</div>


  <div><img alt="" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/halo-1980x1080.jpg" style="width: 720px; height: 405px; margin-right: auto; margin-left: auto; float: none; display: block;"></div>


  <p>Franchises を超える6500万ユニットを使用すると、 <a href="https://www.halowaypoint.com/" target="_blank">ハロー</a> は常に最も人気のあるゲームの1つです。 最新のゲームで、 <a href="https://www.xbox.com/games/halo-5-guardians/" target="_blank">halo 5: ガーディアン</a> (リリース 10/27/2015) のソーシャルマルチプレーヤーゲームをサポートするために、halo 開発チームは <a href="https://www.halowaypoint.com/spartan-companies" target="_blank">Halo: Spartan 企業</a> プラットフォームを実装しました。 データ層のスケーラビリティのニーズに対応し、新しい機能の反復的な迅速な開発をサポートするために、 <a href="https://azure.microsoft.com/services/documentdb/" target="_blank">Azure Cosmos DB</a>を選択しました。</p>


  <p>Halo 5: ガーディアンは、シングルプレーヤーゲームとマルチプレーヤーゲームの両方をサポートする <a href="https://www.xbox.com" target="_blank">Xbox</a>上のファーストプレイヤーゲームです。 マルチプレーヤーゲームでは、人気のある機能として、グループや <a href="https://en.wikipedia.org/wiki/Clan_(video_games)" target="_blank">企業</a> を作成して友人と参加させたり、競争力のあるゲームやゲームの志向のない Halo プレーヤーと結合したりすることができます。 Spartan 企業は、Halo 内で企業を簡単に作成し、それらのユーザーが作成した企業 &nbsp; を Twitter や Facebook などのソーシャルメディアと簡単に統合 &nbsp; し、バッジと統計情報を追跡し、会社のメンバーシップを管理できるようにするために発表<a href="https://www.gamespot.com/articles/halo-5s-clan-system-spartan-companies-launches-tod/1100-6431534/" target="_blank">されました</a>。</p>


  <p><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/spartanCompanies.PNG" style="width: 720px; height: 301px; margin-right: auto; margin-left: auto; float: none; display: block;"></p>


  <h2>Azure Cosmos DB を使用する理由</h2>


  <p>Halo 開発チームには、企業、会社のメンバーシップ、および会社の招待という3つの主要なエンティティが格納されています。 各企業は、会社 ID (社内ガイド)、表示名、オプションのソーシャルメディアハンドル (Twitter、Facebook、Twitch.TV、YouTube)、会社の状態、モットー、授与されたバッジ (0 になる可能性があります)、お気に入りのゲーム (再試行回数はゼロ)、作成時間を追跡する必要がありました。</p>


  <p>会社のメタデータに対して大規模な操作をサポートする必要がありました。</p>


  <ul>
   <li>複数の属性を使用した企業のリアルタイムクエリと検出 (表示名、ソーシャルメディアハンドル、メンバーシップ)</li>
   <li>ゲームプレイ中にアチーブメントと統計を使用して企業を更新し、 <a href="https://www.halowaypoint.com" target="_blank">halowaypoint.com</a> ポータルからカスタマイズする</li>
   <li>特定のルールに基づいて会社の状態を更新する (非アクティブからアクティブ)</li>
  </ul>


  <p>各会社内で、データベースは、特定の会社に対する招待または参加要求に対して効率的な操作をサポートする必要がありました。</p>


  <ul>
   <li>招待の有効期限など、会社への参加/招待に関するデータを格納する</li>
   <li>招待の状態を保留から受理、または拒否に更新する</li>
   <li>招待 Id、招待元 Id、会社 Id、状態、招待の種類、およびこれらの識別子の組み合わせに対して参照を実行します</li>
  </ul>


  <p>Halo 開発チームは、データプラットフォームのさまざまな NoSQL テクノロジを検討しましたが、最終的には、<a href="https://azure.microsoft.com/documentation/articles/documentdb-indexing">自動インデックス作成</a>機能によって提供される速度と柔軟性によって<a href="https://azure.microsoft.com/services/documentdb/">Azure Cosmos DB</a>が選択されました。 Cosmos DB、Halo: Spartan 企業 &rsquo; のサービスでは、スキーマまたはセカンダリインデックスを設定して管理することなく、クエリをサポートすることができました。</p>


  <p>Halo の会社のメンバーシップと招待のパーティション分割方法は、次のゲームでは、会社 ID でハッシュのパーティション分割を使用して、「 <a href="https://azure.microsoft.com/blog/the-walking-dead-no-mans-land-game-soars-to-1-with-azure-documentdb/">No Man&#39;s</a> 」に記載されている同様の設計に従っています。 また、Halo チームは、次の設計パターンを使用して、Cosmos DB コレクション内に企業のビジネスルールを実装しています。</p>


  <ul>
   <li><strong>ポイント読み取り &quot; の &quot; 複合 ID プロパティ: </strong>Cosmos DB &quot; では、id プロパティを使用したポイント読み取り &quot; と<a href="https://msdn.microsoft.com/en-us/library/azure/microsoft.azure.documents.client.documentclient.readdocumentasync.aspx">readdocumentasync</a>は、 <a href="https://azure.microsoft.com/blog/azure-documentdb-bids-fond-farewell-to-self-links/">id ベースのルーティング</a>のリリースでパフォーマンスを向上させることができます。 1 KB ドキュメントの読み取りは1ミリ秒未満で完了し (ネットワーク待機時間を除く)、大量の並列要求を許可する1つの要求ユニット (ユニット) のみを使用します。 Halo チームは、招待ドキュメント用に (InviteType, InviteID, InviterID) から連結した複合 ID プロパティを実装して、ID 参照のパフォーマンス向上を活用します。</li>
   <li><strong>ID 以外のプロパティに対する一意性のトリガー: </strong>Halo チームでは、会社 ID と表示名の両方がグローバルに一意である必要があります。 これをサポートするために、企業固有のメタデータ (1 つのコレクション内に収まる) を格納し、 <a href="https://azure.microsoft.com/documentation/articles/documentdb-programming/#trigger">Cosmos DB トリガー</a>を使用して一意性を適用します。 Cosmos DB は、コレクションのスコープに対するトランザクションをサポートしているので、会社のドキュメントのすべての書き込みでは、同じ名前の他の会社を照会するポストトリガーが使用されており、更新プログラムが見つかった場合はロールバックします。 これにより、ユーザーに別の名前を選択するようにというエラーが表示されます。 Cosmos DB で利用可能なトランザクションサポートをテストするには、 <a href="https://github.com/Azure/azure-documentdb-net/tree/master/samples/code-samples/ServerSideScripts">GitHub</a>でサンプルを実行するか、<a href="https://azure.microsoft.com/documentation/articles/documentdb-programming/" target="_blank">ドキュメント</a>を参照してください。</li>
   <li><strong>非ネイティブ JSON 型の表現: </strong>企業および会社のデータモデルは、複数の場所で使用された DateTimes を招待します。 日付に対して効率的なストレージ、フィルター処理、および並べ替えをサポートするために、Halo チームは <a href="https://en.wikipedia.org/wiki/Unix_time">Unix の時刻</a> 表現を使用していました。 Cosmos DB 内に<a href="https://azure.microsoft.com/en-us/blog/working-with-dates-in-azure-documentdb-4/">DateTimes を格納するさまざまな方法</a>と、関連するトレードオフについて説明します。</li>
  </ul>


  <h2>次の手順</h2>


  <p>&rsquo;次の革新的なゲームまたはモバイルアプリのニーズに対応できるバックエンドデータベースを探している場合は、<a href="https://azure.microsoft.com/pricing/free-trial/" target="_blank"><u>無料試用版を使用して Cosmos DB</u></a>試すか、 <a href="https://azure.microsoft.com/documentation/articles/documentdb-community/#contact-the-team" target="_blank"><u>Cosmos DB エンジニアリングチームとの1:1 チャット</u></a>をスケジュールしてください。 また、 <a href="https://www.halowaypoint.com/en-us/games/halo-5-guardians">ハロー 5: ガーディアン </a>を Spartan にして、お気に入りの <a href="https://www.halowaypoint.com/spartan-companies">会社</a>に参加することを忘れ&#39;ます。</p>
