### YamlMime:Yaml
ms.openlocfilehash: 6ac935a33c741c062ad9c213a272f4538e6ad684
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139891188"
Slug: azure-automation-graphical-and-textual-runbook-authoring
Title: 'Azure Automation: グラフィカルおよびテキスト形式の Runbook 作成'
Summary: 新Azure Automationでは、グラフィカルAzure portal作成エクスペリエンスを使用して Runbook を作成できます。
Content: >-
  <p>新Azure Automationでは、Azure portalツールとグラフィカル プログラミング モデルを使用して Runbook を作成できます。コードはほとんど、または必要ありません。 ライブラリからキャンバスにアクティビティを挿入し、それらをワークフローにリンクし、IT プロセスを自動化する便利な Runbook を作成するためにプロパティを構成します。&nbsp;Orchestrator System Centerのユーザーは、この直感的な方法でビジュアル Runbook を作成する方法を理解している必要があります。</p>


  <p>さらに、ネイティブの PowerShell または PowerShell ワークフロー スクリプトを作成するユーザーの場合、テキスト作成ワークスペースには、大きな編集ウィンドウと、グラフィカル作成と共有されるライブラリとテストエクスペリエンスがあります。 グラフィカルおよびテキストの作成ツールは補完的であり、要件に応じていずれかのツールまたは両方を使用できます。</p>


  <p>この投稿では、この記事のグラフィカルおよびテキストの作成エクスペリエンスを強調表示する <a href="https://portal.azure.com/" target="_blank">機能についてAzure portal</a>。</p>


  <h1>グラフィカル作成</h1>


  <p>System Center Orchestrator を使用して Runbook を作成する方、またはビジュアル ワークフローを直感的に構築できるエディターを好む方のために、Automation チームは、Azure Automation 用の最初のクラウドベースのグラフィカル Runbook エディターとグラフィカル プログラミング モデルをリリースしました。</p>


  <p>グラフィカル作成ワークスペースは、次の 4 つの主要なコンポーネントを含む、全画面のブラウザー内エクスペリエンスです。</p>


  <ul>
   <li>ライブラリ: コマンドレット、Runbook、グローバル資産が簡単に見つかる場所</li>
   <li>キャンバス: ワークフローを構築する場所</li>
   <li>構成ウィンドウ: 各アクティビティとリンクのプロパティとパラメーターを構成する場所</li>
   <li>テスト ウィンドウ: 作成中に Runbook をテストおよびデバッグする場所</li>
  </ul>


  <p><img alt="Graphical Authoring Workspace" border="0" height="326" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f9c5348e-c24b-4242-a589-f24054eeaca2.png" style="border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="グラフィカル作成ワークスペース" width="610"></p>


  <h2>ライブラリ</h2>


  <p>作成ワークスペースの左側にあるライブラリには、Runbook のビルドに使用するアクティビティが含まれている。 ライブラリでは、Automation アカウントのすべてのコマンドレット、Runbook、およびグローバル資産にアクセスできます。 さらに、ライブラリには、グラフィカル作成ツールキットを完了するのに役立ついくつかの主要な Runbook 制御アクティビティが提供されています。 ライブラリを参照して必要なアクティビティを見つけたり、アクティビティの名前または一部がわかっている場合は、検索してすばやく見つけたりできます。 アクティビティをクリックするだけで、キャンバスに追加できます。</p>


  <p>ライブラリ内の項目は次のとおりです。</p>


  <h4>コマンドレット</h4>


  <ul>
   <li>これらはライブラリ内のコア オブジェクトであり、PowerShell モジュールや PowerShell モジュールを持つ任意のサービスまたはシステムREST API管理できます。</li>
   <li>PowerShell モジュールをライブラリにインポートして、統合できるシステムの数を拡張できます。</li>
   <li>モジュール名、コマンドレット名で整理</li>
  </ul>


  <h4>Runbooks</h4>


  <ul>
   <li>これらは、より高いレベルの Runbook を作成するために使用できる再利用可能でモジュール形式の方法でカスタム タスクをカプセル化した場所です。</li>
   <li>タグ (まだ使用できません) と [すべて] カテゴリで&ldquo;整理&rdquo;</li>
  </ul>


  <h4>アセット</h4>


  <ul>
   <li>これらは、Runbook で使用する変数、資格情報、接続、証明書を格納する Automation 資産です。</li>
   <li>すべての資産について、資産&ldquo;の値&rdquo;を取得できます。変数資産の場合は、[値&nbsp;&ldquo;の設定] を&rdquo;選択できます。</li>
   <li>資産の種類、次に資産名で整理されます。</li>
  </ul>


  <h4>Runbook の制御</h4>


  <ul>
   <li>これらは、重要なシナリオを可能にAzure Automationによって提供される特別なアクティビティです。</li>
  </ul>


  <h4>ジャンクション</h4>


  <ul>
   <li>ジャンクション アクティビティは、ワークフローの次のアクティビティに進む前に、すべての受信ブランチが完了するまで待機します。</li>
  </ul>


  <h4>ワークフロー スクリプト</h4>


  <ul>
   <li>これは、PowerShell ワークフロー スクリプトを Runbook に挿入できる汎用アクティビティです。</li>
   <li>これは、カスタム スクリプトが必要な状況に役立ちます。たとえば、InlineScript ブロックを含むアクティビティを構成できます。</li>
  </ul>


  <p><img alt="Authoring Library Cmdlets" border="0" height="360" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/736ea60c-835b-4b77-9afa-cf9d31556089.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="オーサリング ライブラリ コマンドレット" width="168"></p>


  <p>&nbsp;</p>


  <p><img alt="Authoring Library Detail" border="0" height="360" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/eae3cbc2-3be4-4d8d-bc4a-20362aeaa4a5.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="オーサリング ライブラリの詳細" width="265"></p>


  <p>&nbsp;</p>


  <p><img alt="Authoring Library Search" border="0" height="360" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c49b778d-f4ea-4ad6-9127-03fe40493b2f.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="オーサリング ライブラリ検索" width="216"></p>


  <h2>キャンバス</h2>


  <p>グラフィカル作成の主な機能の 1 つは、グラフィカル作成ワークスペースの中央にあるオーサリング キャンバスです (上の最初のスクリーンショットを参照)。 キャンバスは、Runbook のパーツを組み立てる場所です。</p>


  <p>キャンバスを使用すると、次の機能を使用できます。</p>


  <ul>
   <li>アクティビティを追加する</li>
   <li>アクティビティを移動する</li>
   <li>アクティビティをリンクする</li>
   <li>アクティビティとリンクを削除する</li>
   <li>構成のアクティビティまたはリンクを選択する</li>
   <li>アクティビティとリンクのグループを選択する</li>
   <li>垂直方向および水平方向にスクロールする</li>
   <li>拡大または縮小</li>
  </ul>


  <h2>アクティビティの構成</h2>


  <p>グラフィカル作成ワークスペースの右側にある構成ウィンドウは、Runbook 内の各アクティビティとリンクを構成する場所です。 ここでは、グラフィカル Runbook を作成するときに多くの時間を費やします。そのため、可能な限りシンプルで直感的に作成されています。</p>


  <p>基本的なアクティビティ構成には、キャンバス内のアクティビティにカスタム テキストが表示されるラベルと、Runbook 内のアクティビティの一意の識別子であるラベルと、このアクティビティの使用方法を文書化するために使用できるコメントが含まれます。</p>


  <p>アクティビティに対して次の構成を行う方法も可能です。</p>


  <ul>
   <li>アクティビティの名前付き入力パラメーターの値を設定する</li>
   <li>PowerShell 共通パラメーターなど、追加のパラメーターの値を設定する</li>
   <li>何らかの条件が満たされるまでアクティビティを再試行してください</li>
   <li>アクティビティの完了後に Runbook をチェックポイント処理する</li>
  </ul>


  <p><img alt="Graphical Runbook Activity Configuration" border="0" height="382" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/908dd9cf-6108-4dba-8b5a-b0c204b5828a.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="グラフィカル Runbook アクティビティの構成" width="610"></p>


  <p>アクティビティの入力パラメーター値を簡単に構成できます。 アクティビティにパラメーター セットがある場合は、まず、使用するパラメーター セットを選択します。 次に、使用に合ったパラメーターを構成します。 UX では、各パラメーターの型、必須か省略可能か、および既定値を持つかどうかを確認できます。</p>


  <p>アクティビティ入力パラメーターごとに、パラメーターの種類に応じて、データ ソースの大きな一覧から選択できます (下のスクリーンショットを参照)。</p>


  <ul>
   <li>定数値: 使用するカスタム値を設定します。</li>
   <li>Runbook 入力: Runbook に入力されたパラメーター値を選択します。</li>
   <li>アクティビティの出力: Runbook で以前のアクティビティの出力を使用する場合に選択します。</li>
   <li>資産: Automation 変数、資格情報、接続、または証明書資産の値を使用します。</li>
   <li>PowerShell 式: これは、パラメーターの入力として任意の PowerShell スクリプトからの出力を使用できる柔軟なオプションです。</li>
   <li>空の文字列または Null: 必要に合ってパラメーター値として設定することもできます。</li>
  </ul>


  <p><img alt="Activity Configuration Data Sources" border="0" height="360" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c0d7f0e6-301a-4608-96fb-a9d3fc9c59fe.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="アクティビティ構成データ ソース" width="298">&nbsp;</p>


  <h2>リンクの構成</h2>


  <p>Runbook 内のアクティビティを接続するリンクごとに、重要な構成を行います。 リンクをパイプラインまたはシーケンスの種類にするかどうか、およびリンク全体のデータ フローの条件を定義する必要があるかどうかを決定できます。 また、後で参照する場合はコメントを残しておきます。</p>


  <p>リンクの種類は、アクティビティ出力データの使用可能な方法と、前のアクティビティからの出力が次のアクティビティのアクションに与える影響に影響を与えるので、選択するリンクの種類は非常に重要です。</p>


  <h4>パイプライン リンク</h4>


  <ul>
   <li>次のアクティビティは、前のアクティビティの出力オブジェクトごとに 1 回実行されます</li>
   <li>前のアクティビティからの出力がない場合、次のアクティビティは実行されません</li>
   <li>個々のオブジェクトとして使用できる以前のアクティビティからの出力</li>
  </ul>


  <h4>シーケンス リンク</h4>


  <ul>
   <li>次のアクティビティは常に 1 回だけ実行されます</li>
   <li>オブジェクトの配列として使用できる以前のアクティビティからの出力</li>
  </ul>


  <p>リンクで設定できるもう 1 つの便利な構成は、条件です。 Condition 式内に、true または false を返す PowerShell スクリプト ステートメントを記述します。</p>


  <ul>
   <li>条件が true と評価された場合:
   <ul>
    <li>ダウンストリーム アクティビティが実行されます</li>
    <li>ダウンストリーム アクティビティは、アップストリーム アクティビティからのデータにアクセスできます</li>
   </ul>
   </li>
   <li>条件が false に評価される場合:
   <ul>
    <li>ダウンストリーム アクティビティは実行されません</li>
   </ul>
   </li>
  </ul>


  <p>既定では、リンク条件を設定しない場合、リンクは true に評価される条件がある場合と同じように動作します。</p>


  <p><img alt="Graphical Link Configuration" border="0" height="347" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/07bf91b7-b14e-457f-9cc8-d2a8cb63220b.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="グラフィカル リンクの構成" width="360"></p>


  <h2>Runbook の入力パラメーター</h2>


  <p>Runbook の入力パラメーターを定義する準備ができたら、上部のコマンド バーの [<strong></strong>入力と出力] をクリックできます。 各入力パラメーターに対して、それぞれに対して名前と型 (string、int32、int64、decimal、Boolean、datetime、または object) を定義できます。 また、パラメーターが必須か省略可能かを定義し、既定値を設定することもできます。 &nbsp; ドキュメントについては、各パラメーターの説明を入力してください。</p>


  <p><img alt="Graphical Runbook Input Parameters" border="0" height="480" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/232c0775-b4ed-4abd-b551-65ac3ed12bfc.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="グラフィカル Runbook の入力パラメーター" width="423"></p>


  <h1>テキストの作成</h1>


  <p>PowerShell または PowerShell ワークフロースクリプトを使用して runbook を作成しようとしているユーザーのために、Azure Automation には、オンライン作成作業を支援するテキスト作成ワークスペースが用意されています。 含まれるのは、統合されたテストエクスペリエンスに加えて、大規模な編集ウィンドウ、コマンドレット、runbook、および資産の統合ライブラリです。</p>


  <h2>編集ウィンドウ</h2>


  <p>編集ウィンドウを使用すると、行番号、コンテキストの強調表示、一部の intellisense、および大規模な編集ウィンドウでの検索が可能になり、スクロールしなくてもスクリプトを表示できます。</p>


  <p><img alt="Textual Authoring Workspace" border="0" height="327" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a57d93a1-d4f4-4d05-b524-b07bc500ed53.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="テキスト作成ワークスペース" width="610"></p>


  <h2>ライブラリ</h2>


  <p>テキスト作成ワークスペースは、ライブラリコンポーネントをグラフィカル作成と共有します。 ライブラリから、システムにあるコマンドレット、runbook、およびアセットを検索し &nbsp; 、必要なものをテキストエディターに挿入できます。</p>


  <h1>テストエクスペリエンス</h1>


  <p>グラフィックとテキストの作成は、同様のテストエクスペリエンスを共有します。 主な機能は次のとおりです。</p>


  <ul>
   <li>テストの実行間で値を保持するパラメーター値入力ペイン。テストウィンドウを開いたままにしておくと、各テストでパラメーター値を再入力する必要がなくなり &rsquo; ます。</li>
   <li>標準の PowerShell 形式を使用した大規模なテスト出力ウィンドウ</li>
   <li>ワークフローデータストリームのカラーコーディング: 出力、詳細、警告、エラー</li>
   <li>テストブレードが閉じている場合でも、テストは続行されます。また、このブレードを再び開くと、出力状態が維持されます。</li>
   <li>Start、Stop、Suspend、Resume コマンド</li>
   <li>Azure またはハイブリッド runbook worker でテストを実行するオプション</li>
  </ul>


  <p>グラフィカル作成では、活動レベルのトレース (runbook の構成で設定) を有効にして、各活動の開始時刻、終了時刻、入力データ、出力データを表示し、runbook の問題のトラブルシューティングに役立てることもできます。</p>


  <p><img alt="Authoring Test Pane" border="0" height="386" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/bcb9d30d-ddbe-4602-88d5-cec89fd56e01.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="テストウィンドウの作成" width="610"></p>


  <p>&nbsp;</p>


  <p><img alt="Tracing in Graphical Runbook Test" border="0" height="373" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9a2abf1b-a971-4000-ae09-28a198e1e68e.png" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="グラフィカル Runbook テストでのトレース" width="610"></p>


  <h1>グラフィカルおよびテキスト作成モデル</h1>


  <p>グラフィカルなオーサリングモデルとテキスト作成モデルは異なりますが、それぞれに次のような重要な特性があります。 どちらか一方を優先し、シナリオに応じて両方を利用します。 一般に、グラフィカル Runbook は、複数の特定のアクティビティを結合し、ワークフローを視覚化できるようにする、高レベルのプロセスに最適です。 テキスト形式の runbook (PowerShell Runbook と PowerShell Workflow Runbook) は、PowerShell 言語の詳細を操作するのに役立ちます。</p>


  <h2>グラフィカル</h2>


  <ul>
   <li>視覚的な insert-link-configure 作成モデル</li>
   <li>プロセスを介したデータの流れに専念</li>
   <li>IT プロセスおよび影響を受けるシステムを視覚化する</li>
   <li>生産性向上のための高いレベルの言語</li>
   <li>必要に応じて PowerShell スクリプトを含める</li>
   <li>Orchestrator ユーザーの System Center に慣れています</li>
   <li>デザイナーはクラウドベース</li>
  </ul>


  <h2>順</h2>


  <ul>
   <li>PowerShell または PowerShell ワークフロースクリプト作成モデル</li>
   <li>より汎用性の高い言語</li>
   <li>既存の PowerShell スクリプトを使用できます</li>
   <li>PowerShell ユーザーに慣れている</li>
   <li>デザイナーはクラウドベースまたはクライアント (ISE) です。</li>
  </ul>


  <h1>知っておくべきこと</h1>


  <p>役に立つヒントと既知の問題を以下に示します。 Automation の更新プログラムを継続的にリリースしています。そのため、時間の経過と共に問題が解消されます。</p>


  <h3>ヒント</h3>


  <ul>
   <li>グラフィカル作成エクスペリエンスの PowerShell 式エディターでは、次のような前のアクティビティの出力を参照できます。
   <pre class="prettyprint">
  $ActivityOutput[&lsquo;activity label&rsquo;]

  $ActivityOutput[&lsquo;activity label&rsquo;].Property1

  </pre>
   </li>
   <li>同様に、次のように runbook の入力パラメーターを参照することもできます。
   <pre class="prettyprint">
  $InputParameterName</pre>
   </li>
   <li>グラフィカル作成では、パイプラインとシーケンスリンクの種類の違いを理解することが重要です。
   <ul>
    <li>パイプライン
    <ul>
     <li>次のアクティビティは、前のアクティビティからのオブジェクト出力ごとに1回実行されます。 前のアクティビティが出力を生成しない場合、次のアクティビティは実行されません。</li>
     <li>個々のオブジェクトとして使用可能な前のアクティビティからの出力</li>
    </ul>
    </li>
    <li>シーケンス
    <ul>
     <li>次のアクティビティは、1回だけ実行されます。</li>
     <li>オブジェクトの配列として使用できる前のアクティビティからの出力</li>
    </ul>
    </li>
   </ul>
   </li>
   <li>グラフィカル runbook の出力は、runbook の最後のアクティビティからの出力です。 この動作は、runbook の出力が runbook の任意のアクティビティから送信されるテキスト形式の runbook の場合と異なります。</li>
  </ul>


  <h3>発行</h3>


  <ul>
   <li>子 runbook を含む PowerShell ワークフローベースの runbook のジョブは、実行状態になるまでに数分かかることがあります。 これは、PowerShell ワークフローが実行前に runbook をコンパイルする方法に関する問題です。 テキスト形式の runbook の場合、ネイティブ PowerShell runbook を作成することによってこれを回避できます。グラフィカルな runbook の場合は、修正に取り組んでいます。 Automation の使用状況と請求書には、ジョブの開始時刻が含まれていません。ジョブが実際に実行されている時間のみです。</li>
   <li>グラフィカル runbook での設計により、分岐点活動には複数の受信シーケンスリンクを含めることができますが、受信パイプラインリンクは1つだけです。 ただし、現在のキャンバスでは、デザイン時に警告が表示されることなく、複数のパイプラインリンクを分岐点にフックできます。 ここでは、デザイン時の警告の提供に取り組んでいます。</li>
   <li>並列分岐で子 runbook を実行することはできません。 PowerShell ワークフローベースの runbook では、子 runbook が別の子 runbook、コマンドレット、またはアクティビティと並行して実行されている場合、予期しない出力動作が検出されました。 これは、Automation ではなく PowerShell ワークフローに関する問題です。 このため、ここでは、作成を支援するために、スタートアップ時に runbook を失敗させるグラフィカル runbook のチェックを追加しました。この場合、便利なエラーメッセージが表示されます。</li>
   <li>作成時に、runbook の入力パラメーターの定義を変更した後、変更をテストするには、下書きを保存し、テストウィンドウを閉じて再度開き、変更されたパラメーターがテストウィンドウに表示されることを確認する必要があります。</li>
  </ul>


  <h1>まとめ</h1>


  <p>ここでは、新しい Azure portal の Azure Automation での、グラフィカルでテキスト形式の runbook 作成エクスペリエンスの概要を説明しました。 これらのツールを使用すると、プロセスを自動化するために使用する runbook を効率的に作成できます。 自動化チームは、価値を高め、使いやすさを向上させる新機能により、作成エクスペリエンスの向上を続けています。</p>


  <p>Azure Automation は、すべてのクラウド (Azure、AWS、その他) とオンプレミスの IT 管理用の単一の Automation ポータルです。</p>


  <p>Azure Automation を使い始めたばかりですか? <a href="https://aka.ms/Q2p1ap" target="_blank">ここで</a>サービスについて説明し、Twitter の<a href="https://twitter.com/AzureAutomation" target="_blank">Azure Automation</a>に従います。</p>
