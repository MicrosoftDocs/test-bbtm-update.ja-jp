### YamlMime:Yaml
ms.openlocfilehash: c2f5d8757d01b0895f6f9c3b788aa701e17aa307
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139910680"
Slug: new-management-api-for-windows-azure-traffic-manager
Title: 新Management APIのWindows Azure Traffic Manager
Summary: Azure 開発者ポータルのポータルでWindowsお気付きのように、最近、Azure 開発者ポータル用の新しい管理 API をWindows Azure Traffic Manager。&nbsp;新しい API では、 を許可Traffic Managerのパフォーマンスが向上します。
Content: '<p>Azure 開発者ポータルのポータルでWindows<a target="_blank" href="https://azure.microsoft.com/en-us/?WT.mc_id=cmp_pst001_blg_post0039">お</a>気付きのように、最近、Azure 開発者ポータル用の新しい管理 API をWindows Azure Traffic Manager。&nbsp;新しい API は、開発者Traffic Manager IT プロフェッショナルがサービスとの対話をスクリプト化し、プログラムでサービスとやり取りできるようにすることで、サービスのパフォーマンスを向上します。</p>  <p>&rsquo;Windows Azure Traffic Manager に慣れ親しんだユーザーには、異なるデータセンターでホストされているサービス間でトラフィックを分散する方法を制御できます。 Traffic Manager顧客のトラフィックを最も近いデータセンターに送信することで、アプリケーションの認識されるパフォーマンスが向上し、ダウンしているホストされたサービスにトラフィックを送信しないという信頼性が向上します。</p>  <p>新しい API のリリースにより、開発者は、プロファイルの最初からの作成など、Traffic Manager ポリシーの管理と作成にフル アクセスできます。&nbsp;この投稿では、新しい&rsquo; API を使用してプロファイルを作成、更新、管理する方法について説明します。 &nbsp;REST API のTraffic Managerについては、こちらを参照<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758255.aspx">してください</a>。<br> <br> ポータルで一般的な構成を見て、API を使用して同じ構成を実現する方法を確認しましょう。 開始する前に、新しいサービスをWindows Azure Traffic Manager場合は、続行する前にサービスのしくみの概要を読むことをお勧めします。<br> <br> 参考までに、パフォーマンス負荷分散方法を使用して、米国中北部データセンターのアプリケーション エンドポイント セットアップと北ヨーロッパ データセンターの間でトラフィックを分散する、セットアップした構成のスクリーンショットを含めておきます。 <br> <br> <b>図 1: Traffic Manager ポリシー ページ</b><br><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5314.TM1.png" alt="" border="0"></p>  <p>[ポリシー Traffic Manager編集] ダイアログでは、1 つの画面Windows Azure Traffic Managerポリシーを構成できます。 背後には、開発者が認識する必要があるこのポリシー構成を表す複数のエンティティをユーザーに代わって作成する複数の API 呼び出しがあります。<br> <br> では、プログラムで同じ構成を実行するにはどうすればよいですか? <br> <br> エンティティを理解するのが最初の手順です。 上で表したポリシーは、ドメイン名を指定したプロファイルで構成され、少なくとも 1 つの定義で構成されます。負荷分散方法、DNS TTL、エンドポイント、監視構成などです。</p>  <p><b>図 2: Traffic Managerエンティティ</b><br> <br> <img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3755.TM2.png" alt="" border="0"><br> <br> 各プロファイルには、複数の定義を関連付けできます。 ただし、一度にアクティブにできる定義は 1 つのみです。 現在、複数の定義の作成はポータルでは公開されません。 複数の個別の定義を定義し、それらを再構築せずに切り替える機能を提供することができます。<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758254.aspx"></a></p>  <p><a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758254.aspx">プロファイル API の作成</a></p>  <table border="0" cellpadding="0">  <tbody>  <tr>  <td>  <p>POST</p>  </td>  <td>  <p>https://management.core.windows.net/&lt;subscription-id&gt;/services/WATM/profiles</p>  </td>  </tr>  </tbody>  </table>  <p><b>図 3: プロファイル要求パラメーターの作成<br> </b></p>  <p><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0081.TM3.png" alt="" border="0"></p>  <p>プロファイルの作成 API では、プロファイル名とドメイン名を指定Traffic Manager必要があります。 ドメイン名は、DNS プレフィックス (ホスト名) と .trafficmanager.net で構成されます。 管理ポータルには、プロファイル名の場所が表示されません。これは、ポータルを使用するときに自動的に生成されます。 これは、プログラムでプロファイルを作成する場合には当てはめではありません。 プロファイル名の生成方法は、開発者として理解することが重要です。 ポータルからプロファイルを作成すると、指定するドメイン名のホスト名を取得し、-trafficmanager-net を追加することで、名前が生成されます。 たとえば、指定したドメイン名が woodgrove.trafficmanager.net プロファイルの内部名は woodgrove-trafficmanager-net です。 プログラムでプロファイルを作成する場合、プロファイル名はプロファイルの作成 API に渡す名前です。 <a href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758257.aspx"> </a></p>  <p><a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758257.aspx">定義 API の作成</a></p>  <table border="0" cellpadding="0">  <tbody>  <tr>  <td>  <p>POST</p>  </td>  <td>  <p><a target="_blank" href="https://management.core.windows.net/%3Csubscription-id%3E/services/WATM/profiles/%3Cprofile-name%3E/definitions">https://management.core.windows.net/&lt;subscription-id&gt;/services/WATM/profiles/&lt;profile-name&gt;/definitions</a></p>  </td>  </tr>  </tbody>  </table>  <p><b>図 4: 定義要求パラメーターの作成</b></p>  <p><br><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6371.TM4.png" alt="" border="0"></p>  <p>プロファイルが作成されると、Create Definition API を使用して定義を作成し、その他の構成Windows Azure Traffic Managerできます。 <br> <br> 定義の構成は、見た目ほど複雑ではありません。 モニターの定義は、返された状態コードを介してアプリケーションの正常性を Traffic Manager に伝える HTTP/HTTPS リソースへの相対パスを指定することです。 ポート、プロトコル、相対パスを変更できますが、残りの設定は既定値に設定する必要があります。 <br> <br> 各エンドポイントは、Windows Azure Traffic Manager で管理する Windows Azure アプリケーションの URL と、現在有効になっているかどうかを示すフラグで構成されます。</p>  <p>Traffic Manager プロファイル (&lt;dnsprefix.trafficmanager.net&gt;) の作成時に指定された URL は、DNS 名が解決された際に、指定されたエンドポイントの 1 つにマップされます。 解決されるエンドポイントは、指定された負荷分散方法 (パフォーマンス、フェールオーバー、または RoundRobin) に基づいて行います。</p>  <p>たとえば次のようになります。 <br> WoodGroveUS.cloudapp.net 中央データ センターに存在する可能性があります。 <br> WoodGroveEU.cloudapp.net 北ヨーロッパ データ センターに存在する可能性があります。</p>  <p>WoodGrove.trafficmanager.net は、解決された場合にデータ センター エンドポイントの 1 つにマップされる親ドメイン名です。</p>  <p><a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758250.aspx">プロファイルの更新</a></p>  <table border="0" cellpadding="0">  <tbody>  <tr>  <td>  <p>PUT</p>  </td>  <td>  <p>https://management.core.windows.net/&lt;subscription-id&gt;/services/WATM/profiles/&lt;profile-name&gt;</p>  </td>  </tr>  </tbody>  </table>  <p><b>図 5: プロファイル要求パラメーターの更新</b></p>  <p><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2845.TM5.png" alt="" border="0"></p>  <p>プロファイルには複数の定義を関連付けできますが、一度にアクティブにできるのは 1 つのみです。 新しいTraffic Managerをアクティブにするには、プロファイルに関連付けられている定義の 1 つを有効にする必要があります。 定義を有効にするには、定義の作成 API を呼び出した際に返されたバージョンを渡して Update Profile API を呼び出します。</p>  <p><b>既存のプロファイルと定義の管理<br> </b>Traffic Manager REST API では、プロファイルの作成と関連付けられた定義のコア操作以外に、プロファイルの一覧表示、プロファイルの取得<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758251.aspx"></a>、リスト定義<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758252.aspx"></a>、定義の取得<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758248.aspx"></a>、プロファイルの削除も<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758256.aspx">サポートされています</a>。<a target="_blank" href="https://msdn.microsoft.com/en-us/library/windowsazure/hh758249.aspx"></a> これらの API は、アプリケーション構成を管理するアプリケーションを構築するためのWindows Azure Traffic Manager提供します。<br> <br> Windows Azure Traffic Manager プロファイルの管理を自動化したいが、REST API に対してコードを記述したくない場合は、回答も用意されています。 Windows Azure PowerShell コマンドレット (現在のバージョン <a target="_blank" href="https://wappowershell.codeplex.com/">2.2)</a> が更新され、このコマンドレットが完全にサポートWindows Azure Traffic Manager。<br> <br> Windows Azure Traffic Manager コマンドレット</p>  <ul>  <li>New-TrafficManagerProfile</li>  <li>Get-TrafficManagerProfile</li>  <li>Remove-TrafficManagerProfile</li>  <li>Set-TrafficManagerProfile</li>  <li>Get-TrafficManagerDefinition</li>  <li>New-TrafficManagerDefinition</li>  <li>Add-TrafficManagerEndpoint</li>  <li>New-TrafficManagerEndpoint</li>  <li>Set-TrafficManagerEndpoint</li>  <li>Remove-TrafficManagerEndpoint</li>  <li>New-TrafficManagerMonitor</li>  </ul>  <p>PowerShell を使用して新しいプロファイルと定義を作成する方法の例を次に示します。</p>  <p><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0842.Screen-Shot-2012_2D00_01_2D00_26-at-9.42.22-AM.png" alt="" border="0"><br> Windows Azure Traffic Managerは、グローバルで高可用性のアプリケーションを実現するための重要なテクノロジです。 新しい REST API を使用すると、アプリケーション開発者は、アプリケーションのネイティブな部分にTraffic Managerするアプリケーションを構築できます。&nbsp;また、Windows Azure PowerShell Cmdlets 2.2 の新しいリリースでこの機能を公開することで、Windows Azure のお客様へのデプロイを自動化するためのドアも開きます。 <br> <br> 幸せなコーディング</p>'
