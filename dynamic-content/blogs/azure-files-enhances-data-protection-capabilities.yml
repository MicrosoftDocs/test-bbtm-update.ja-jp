### YamlMime:Yaml
ms.openlocfilehash: 28f58c5fe955814f9a3242eb548e0e7de004c0ae
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139909328"
Slug: azure-files-enhances-data-protection-capabilities
Title: Azure Files はデータ保護機能を強化します
Summary: 運用データの保護は、あらゆるビジネスにとって重要です。 そのため、Azure Files には、データの高可用性、バックアップ、回復性を確保するための多層アプローチが用意されています。
Content: >-
  <p>運用データの保護は、あらゆるビジネスにとって重要です。 その &rsquo; ため Azure Files には、データの可用性、バックアップ、<i> </i>回復性を確保するための多層アプローチが用意されています。 &rsquo;ランサムウェア攻撃、データセンターの停止、または誤って削除されたファイル共有のいずれであっても、すべてのバックアップを取得して再度実行できるようにする必要が<em>あります。</em>Azure Files のデータを安心してご利用いただくために、新しい論理的な削除機能、共有スナップショット、冗長性オプション、データおよび管理機能へのアクセス制御などの機能を強化してい<em>ます。</em></p>


  <h2>論理的な削除: Azure ファイル共有のごみ箱</h2>


  <p><a href="https://docs.microsoft.com/azure/storage/files/storage-files-prevent-file-share-deletion" target="_blank">論理的な削除</a> では、Azure ファイル共有を誤って削除しないように保護します。 このため、Azure ファイル共有の論理的な削除のプレビューが発表されます。 ファイル共有のごみ箱のように、論理的な削除を考えてみてください。 ファイル共有が削除されると、論理的に削除されたスナップショットの形式で論理的に削除された状態に移行します。 論理的に削除されたデータが完全に消去されるまでの回復可能期間を構成できます。</p>


  <p>論理的に削除された共有が一覧表示されますが、それらをマウントしたり、内容を表示したりするには、削除を取り消す必要があります。 削除の取り消し時には、すべてのメタデータとスナップショット (以前のバージョン) を含め、共有が以前の状態に回復されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e81842d8-4a7f-42db-a673-e7de230559de.png"><img alt="Undelete soft-deleted file share in the Azure portal." border="0" height="360" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/58c78eec-5ed2-4255-824c-4bfce9809ba8.png" style="border: 0px currentcolor; margin-right: auto; margin-left: auto; display: block; background-image: none;" title="Azure portal で論理的に削除されたファイル共有の削除を取り消します。" width="1024"></a></p>


  <p>ほとんどの共有に対しては、 <a href="https://docs.microsoft.com/azure/storage/files/storage-files-enable-soft-delete" target="_blank">論理的な削除を有効に</a> することをお勧めします。 共有の削除が一般的かつ望まれているワークフローでは、保持期間を非常に短く設定するか、または論理的な削除をまったく有効にしないことを決定することができます。 論理的な削除はデータ保護戦略の一部であり、不注意によるデータの損失を防ぐことができます。</p>


  <p>論理的な削除は、新しいストレージアカウントと既存のストレージアカウントの両方で既定では無効になっていますが、ポータルと、2021年1月以降の API &nbsp; の両方で新しいストレージアカウントに対して既定で有効になります。 ストレージ アカウントの有効期間中であればいつでも、機能のオンとオフを切り替えることができます。 この設定は、ストレージアカウント内のすべてのファイル共有に適用されます。 <a href="https://docs.microsoft.com/en-us/azure/backup/soft-delete-azure-file-share" target="_blank">Azure Backup</a>を使用している場合は、すべての保護されるインスタンスに対して論理的な削除が自動的に有効になります。 論理的な削除では、これらのファイル &mdash; を個別に削除することはできません。スナップショットバックアップから復元する必要があります。 論理的な削除の詳細については、「 <a href="https://docs.microsoft.com/en-us/azure/storage/files/storage-files-prevent-file-share-deletion" target="_blank">Azure ファイル共有が誤って削除されないよう</a>にする」を参照してください。</p>


  <p>編集: 10/30/2020 のように、Azure ファイル共有の論理的な削除が一般公開されています。</p>


  <h2>復元できるスナップショットバックアップ</h2>


  <p>スナップショットは、Azure ファイル共有の読み取り専用の特定時点のコピーです。 これら &rsquo; は増分的に再利用されます。つまり &rsquo; 、スナップショットが非常に効率的 &mdash; に行われるのは、前回のスナップショット以降に変更されたデータだけです。 ファイル共有ごとに最大 200 のスナップショットを保持し、最大 10 年間保存できます。 これらのスナップショットは、Azure portal、PowerShell、またはコマンドラインインターフェイス (CLI) を使用して手動で取得することも、 <a href="https://azure.microsoft.com/blog/azure-files-share-snapshot-management-by-azure-backup-is-now-generally-available/" target="_blank">Azure Files のスナップショット管理サービス</a> の一般提供が開始された Azure Backup を使用することもできます。 スナップショットはファイル共有内に格納されます。つまり、ファイル共有を削除すると、スナップショットも削除されます。 スナップショット バックアップを誤削除から保護するために、共有に対して論理的な削除が有効になっていることを確認します。</p>


  <p>スナップショットのスケジュールとリテンション期間を処理 Azure Backup には、Recovery Services Vault を設定するときに必要なバックアップポリシーを定義し、その後でバックアップを行います。 新しい祖父 (GFS) 機能は、毎日、毎週、毎月、毎年の各スナップショットを取得できることを意味し、それぞれに個別の保有期間があります。 また Azure Backup は、 <a href="https://docs.microsoft.com/en-us/azure/backup/soft-delete-azure-file-share" target="_blank">論理的な削除の有効化</a> を調整し、ストレージアカウント内のいずれかのファイル共有がバックアップ用に構成されるとすぐに <a href="https://docs.microsoft.com/en-us/azure/backup/backup-afs#best-practices" target="_blank">削除ロックを取得</a> します。 最後に、顧客が自身のバックアップ資産の統合されたビューを利用できるように、Azure Backup には、特定の主な監視機能およびアラート機能が用意されています。</p>


  <p>Azure portal 上で、Azure Backup を使用して、項目レベルおよび共有レベルの両方の復元を実行できます。 必要な作業は、復元ポイント (特定のスナップショット)、特定のファイルまたはディレクトリ (該当する場合)、復元先の場所 (元の場所または別の場所) を選択することだけです。 バックアップ サービスによって、スナップショット データのコピーが処理され、ポータル上に復元の進行状況が表示されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2b51f1fc-06df-4b1f-866b-7266ca40bd97.png"><img alt="Restore file share using Azure Backup in the Azure portal." border="0" height="125" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/560b42ce-2953-4896-b001-91fdc5750565.png" style="border: 0px currentcolor; margin-right: auto; margin-left: auto; display: block; background-image: none;" title="Azure portal の Azure Backup を使用してファイル共有を復元します。" width="1024"></a></p>


  <p>&rsquo;Azure Backup を使用しない場合は、スナップショットから手動で復元を実行できます。 Windows を使用していて、Azure ファイル共有をマウントした場合は、エクスプローラーを使用して、以前のバージョン &rdquo; の API を使用して &ldquo; スナップショットの表示と復元を行うことができます (つまり、ユーザーは自分で項目レベルの復元を実行できます)。 1つのファイルから復元する場合は、以前のスナップショットとは異なるバージョンを選択します。 共有全体で使用すると、参照してコピーできるすべてのスナップショットが表示されます。</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/38238e44-7898-4458-9e84-48520f21a076.jpg"><img alt="Previous Versions experience in Windows Explorer." border="0" height="385" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d5580b73-cea7-41ca-ad86-20a5ba1ed636.jpg" style="border: 0px currentcolor; margin-right: auto; margin-left: auto; display: block; background-image: none;" title="Windows エクスプローラーでの以前のバージョンのエクスペリエンス。" width="1024"></a></p>


  <p>また、選択したコピーツールを使用して、スナップショットからデータをコピーすることで復元することもできます。 AzCopy を使用することをお勧めします (最新バージョンが必要です) または Robocopy (ポート445を開いておく必要があります)。 または、単純にスナップショットをマウントし、データを簡単にコピーして、プライマリに貼り付けることができます。</p>


  <p>Azure File Sync を使用している場合は、 <a href="https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service" target="_blank">サーバー側のボリュームシャドウコピーサービス (VSS) スナップショットを以前のバージョンと共</a> に使用して、ユーザーがセルフサービスによる復元を実行できるようにすることもできます。 これらは Azure ファイル共有のスナップショットとは異なることに注意してください。クラウド側のバックアップに &mdash; 代わるものではなく、同時 &mdash; に使用することができます。</p>


  <h2>データのレプリケーションと冗長性のオプション</h2>


  <p>Azure Files には、一時的なハードウェア障害、ネットワーク、停電から大規模な自然災害まで、計画済みおよび計画外のイベントからデータを保護するためのさまざまな <a href="https://docs.microsoft.com/azure/storage/common/storage-redundancy" target="_blank">冗長性オプション</a> が用意されています。 すべての Azure ファイル共有は、ローカル冗長 (LRS) またはゾーン冗長ストレージ (ZRS) を使用できます。 Geo 冗長 (GRS) と geo ゾーン冗長ストレージ (GZRS) は、5 TB の standard ファイル共有で利用できます。また、最大 100 TiB の標準ファイル共有に対しては、geo 冗長ストレージに対して積極的に取り組んでいます。</p>


  <p>Premium ファイル共有の地理的冗長性を実現するには、次の方法があります。 Azure File Sync シナリオでは、azure ファイル共有 (クラウドエンドポイント)、オンプレミスの Windows サーバー (エンドユーザーアクセス用の通常のサーバーエンドポイント) &nbsp; 、および別の Azure リージョンの仮想マシンで実行されているマウントされたファイル共有 (ディザスターリカバリーを目的としたサーバーエンドポイント) を同期できます。 すべてのデータがローカルに存在するようにするには、クラウドの階層化を無効にし、データセット全体を保持するのに十分なストレージを Azure ディスクにプロビジョニングする必要があります。 変更がセカンダリリージョンにすばやくレプリケートされるようにするには、Azure ではなくサーバーエンドポイントでのみファイルにアクセスして変更する必要があります。 AzCopy などのツールを使用して、セカンダリリージョンのストレージアカウントにデータをコピーする独自のスクリプトを作成することもできます (アクセス制御リスト (Acl) とタイムスタンプを保持するには、バージョン10.4 以降を使用します)。</p>


  <h2>データをセキュリティで保護するためのアクセス制御オプション</h2>


  <p>データ保護のもう1つの部分は、データを保護することです。 これにはいくつかの異なるオプションがあります。 Azure Files には、<a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage" target="_blank">ストレージアカウントキー</a>を使用して長期間サポートされているアクセス制御があります。これは、チャレンジ/レスポンス (NTLM) ベースの Windows であり、定期的にローテーションすることができます。 ストレージアカウントキーへのアクセス権を持つすべてのユーザーには、スーパーユーザーのアクセス許可があります。 また Azure Files は、<a href="https://docs.microsoft.com/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview" target="_blank">オンプレミスの Active Directory</a>または<a href="https://docs.microsoft.com/azure/active-directory-domain-services/overview" target="_blank">Azure Active Directory ドメインサービス (Azure AD DS)</a>を使用した、<a href="https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview" target="_blank">サーバーメッセージブロック (SMB) に対する id ベースの認証とアクセス制御</a>をサポートするようになりました。 Id ベースの認証は Kerberos ベースであり、Azure ファイル共有へのきめ細かいアクセス制御を適用できます。</p>


  <p>Azure AD またはオンプレミス Azure AD DS を構成すると、組み込みのロールベースの Access Control (RBAC) ロールを使用して共有レベルのアクセスを構成したり Azure AD id のカスタムアクセスロールを構成したり、標準の Windows ファイルのアクセス許可 (NTFS acl とも呼ばれます) を使用してディレクトリおよびファイルレベルのアクセス許可を構成したりできます</p>


  <h2>Azure Files のための複数のデータ保護戦略</h2>


  <p>Azure Files には、データを保護するためのツールが多数用意されています。 Azure ファイル共有の論理的な削除は誤って削除されないようにします。共有スナップショットは、Azure ファイル共有の特定の時点でのコピーであり、Azure Backup を通じて手動または自動で取得したり、から復元したりすることができます。 高可用性を確保するために、さまざまなレプリケーションオプションと冗長性オプションを選択できます。 また、id ベースのアクセス制御を使用して、Azure ファイル共有への適切なアクセスを確保することもできます。</p>


  <h2>意見の投稿</h2>


  <p>これらの機能についてのフィードバックと、今後の電子メール <a href="mailto:azurefiles@microsoft.com">azurefiles@microsoft.com</a> による改善の提案をお待ちしております。 <a href="https://feedback.azure.com/forums/217298-storage?category_id=180670" target="_blank">UserVoice</a>を使用して、Azure Files の新しい提案を追加することもできます。</p>
