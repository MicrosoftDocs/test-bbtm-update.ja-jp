### YamlMime:Yaml
ms.openlocfilehash: cf833fe65e242d6798a061e04ee9a7841288e17b
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905148"
Slug: powerpivot-for-the-dba-part-1
Title: 'DBA の PowerPivot: パート1'
Summary: '[この記事は SQL Azure チームによって提供されました。]この記事では、単純な用語と手法をビジネスインテリジェンスに関連付けて、SQL を PowerPivot します。'
Content: '<p>[この記事は SQL Azure チームによって提供されました。]</p><p>この記事では、簡単な用語と手法をビジネスインテリジェンスに結び付け、SQL を PowerPivot します。これは、DBA にとっては地球にダウンします。 PowerPivot を使用して優れたレポートを作成するために、SQL transact-sql を知っている必要はありません。ただし、これらの記事を既に実行している場合は、学習のギャップを埋めることになります。</p>  <h2>履歴</h2>  <p>私は、ビジネスインテリジェンス (BI) という用語がしばらくの間にスローされています。ほとんどの場合、企業がビジネスインテリジェンスを開始することを望んでいる経営陣からのものです。 また、ビジネスインテリジェンスについて、複雑な数学や新しい一連の用語が含まれていることを前提として、ビジネスインテリジェンスについての学習を回避しています。これは、時間がかかるまでの大きな学習曲線のようなものです。 既に知っていることを基に新しいテクノロジを学習したいと思います。実際には、ビジネスインテリジェンスを他の SQL Server スキル (SQL など) に関連付ける必要がありました。 最後に、ビジネスインテリジェンスの基本について学習し、transact-sql SQL スキルとの密接な連携があることを実感しました。</p>  <h2>PowerPivot</h2>  <p>PowerPivot、Excel 2010 の拡張機能は、ビジネスインテリジェンスを開始するための優れた方法です。 これにより、リレーションシップとレポートの作成を試すことができます。 これを使用すると、レポートのプロトタイプをすばやく簡単に作成し、データの問題を調査してから、ERD またはサーバーのセットアップをコミットすることができます。</p>  <p>簡単な例を見て、SQL Azure と Adventure works データベースに接続してみましょう。 その後、次のテーブルをインポートします。</p>  <ul>   <li>Sales.SalesOrderHeader </li>    <li>Sales.SalesOrderDetail </li>    <li>Production.Product </li>    <li>Production.ProductSubcategory </li>    <li>Production.ProductCategory </li> </ul>  <p>このブログの投稿で PowerPivot を使用して、SQL Azure に接続し、テーブルをインポートする方法について説明しました。 次の手順では、ピボットテーブルを作成します。 これを行うには、Excel の PowerPivot リボンバーにアクセスし、[ピボットテーブル] を選択します。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="絵" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1234.image_5F00_thumb_5F00_68E7E90E.png" width="642" height="294"></a> </p>  <p>ピボットテーブルが表示され、ドッキングされた<b>PowerPivot のフィールドリスト</b>ウィンドウで、フィールドの一覧の [値] セクションの<b>SalesOrderDetail</b>テーブルから<b>linetotal</b>列が追加されると、次のような、必要のないピボットテーブルが表示されます。</p>  <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="絵" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5875.image_5F00_thumb_5F00_70CF65A3.png" width="565" height="710"></a> </p>  <p>これは、次の SELECT ステートメントを Transact SQL で実行するのと同じです。</p>  <pre class="csharpcode"><span class="kwrd">SELECT</span>    <span class="kwrd">SUM</span>(LineTotal)  <span class="kwrd">FROM</span>    Sales.SalesOrderDetail</pre>      <p>    <p>これで、"Hello World" の例を取得できました。次は、PowerPivot の行ラベルに<b>ProductCategory.Name</b>列を追加します。これは、GROUP BY 句を使用して transact-sql SQL で select ステートメントを作成するのと同じです。</p>    <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="絵" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3771.image_5F00_thumb_5F00_54424DF6.png" width="645" height="710"></a> </p>    <p>このステートメントを実行すると、上記の PowerPivot サンプルでは、次の SQL transact-sql ステートメントを実行して (総計を除いて) 同じ出力が得られます。</p>    <pre class="csharpcode"><span class="kwrd">SELECT</span>    ProductCategory.Name, <span class="kwrd">SUM</span>(LineTotal)  <span class="kwrd">FROM</span>    Sales.SalesOrderDetail      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.Product <span class="kwrd">ON</span>           Product.ProductID = SalesOrderDetail.ProductID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductSubcategory <span class="kwrd">ON</span>           Product.ProductSubcategoryID =     ProductSubcategory.ProductSubcategoryID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductCategory <span class="kwrd">ON</span>           ProductSubcategory.ProductCategoryID =     ProductCategory.ProductCategoryID  <span class="kwrd">GROUP</span> <span class="kwrd">BY</span> ProductCategory.Name</pre>      <p>引き続き Adventure works データベースを使用して<b>ProductCategory.Name</b>列を列ラベルに移動し、 <b>SalesOrderHeader</b>を行ラベルに追加すると、PowerPivot は次のようになります。</p>    <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="絵" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7418.image_5F00_thumb_5F00_4F1FC4AD.png" width="776" height="577"></a> </p>    <p>これは、Order BY ステートメントと<b>Order</b><b>Date</b>と<b>ProductCategory.Name</b>の両方を含む、この transact-sql SQL ステートメントと同じデータです。</p>    <pre class="csharpcode"><span class="kwrd">SELECT</span>    ProductCategory.Name, SalesOrderHeader.OrderDate,    <span class="kwrd">SUM</span>(LineTotal)  <span class="kwrd">FROM</span>    Sales.SalesOrderHeader      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Sales.SalesOrderDetail <span class="kwrd">ON</span>           SalesOrderHeader.SalesOrderID = SalesOrderDetail.SalesOrderID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.Product <span class="kwrd">ON</span>           Product.ProductID = SalesOrderDetail.ProductID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductSubcategory <span class="kwrd">ON</span>           Product.ProductSubcategoryID =     ProductSubcategory.ProductSubcategoryID      <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductCategory <span class="kwrd">ON</span>           ProductSubcategory.ProductCategoryID =     ProductCategory.ProductCategoryID  <span class="kwrd">GROUP</span> <span class="kwrd">BY</span> ProductCategory.Name, SalesOrderHeader.OrderDate  <span class="kwrd">ORDER</span> <span class="kwrd">BY</span> SalesOrderHeader.OrderDate</pre>      <p>ただし、ここでは、行ラベルと列ラベルの両方を使用して、PowerPivot が表示されるようにしています。これは、カテゴリ名を列にピボットし、日付で自動的に並べ替え、行と列の総計を示す PowerPivot です。 SQL を使用する DBA は、SQL Server 2008 の PIVOT コマンドを使用してテーブルをピボットすることもできます。上記のサンプルでは、次のように transact SQL が表示されます。</p>    <pre class="csharpcode"><span class="kwrd">SELECT</span> OrderDate, [1] <span class="kwrd">AS</span> Bikes, [2] <span class="kwrd">AS</span> Components, [3] <span class="kwrd">AS</span> Clothing,   [4] <span class="kwrd">AS</span> Accessories  <span class="kwrd">FROM</span>   (<span class="kwrd">SELECT</span>    Sales.SalesOrderDetail.LineTotal,    ProductCategory.ProductCategoryID,    SalesOrderHeader.OrderDate      <span class="kwrd">FROM</span>    Sales.SalesOrderHeader          <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Sales.SalesOrderDetail <span class="kwrd">ON</span>               SalesOrderHeader.SalesOrderID = SalesOrderDetail.SalesOrderID          <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.Product <span class="kwrd">ON</span>               Product.ProductID = SalesOrderDetail.ProductID          <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductSubcategory <span class="kwrd">ON</span>               Product.ProductSubcategoryID =     ProductSubcategory.ProductSubcategoryID          <span class="kwrd">INNER</span> <span class="kwrd">JOIN</span> Production.ProductCategory <span class="kwrd">ON</span>               ProductSubcategory.ProductCategoryID =     ProductCategory.ProductCategoryID  ) p  PIVOT  (      <span class="kwrd">SUM</span>(LineTotal)      <span class="kwrd">FOR</span> ProductCategoryID <span class="kwrd">IN</span> ( [1], [2], [3], [4] )  ) <span class="kwrd">AS</span> pvt  <span class="kwrd">ORDER</span> <span class="kwrd">BY</span> pvt.OrderDate;</pre>      <h2>まとめ</h2>    <p>このブログ記事をお読みになると、ビジネスインテリジェンスを Mangers のために GROUP BY としてまとめることができます。これは、バンパーステッカーの優れたスローガンです。</p>    <p><a href=""><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="絵" border="0" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8883.image_5F00_thumb_5F00_7571822B.png" width="460" height="109"></a> </p>    <p>しかし、この投稿では、次のブログ記事では、ビジネスインテリジェンスのメジャーについて説明し、SQL 一致する Transact-sql の記述を続行します。 質問、懸念事項、コメントがありますか。 これらを下に投稿してください。</p>'
