### YamlMime:Yaml
ms.openlocfilehash: 6096b65cb5906cac96bd8b593cb5fac3149168ad
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/11/2022
ms.locfileid: "139910909"
Slug: breaking-change-for-windows-azure-drive-beta-in-guest-os-1-8-and-2-0
Title: ゲスト OS 1.8 Windows 2.0 での Azure ドライブ ベータ版の変更に関する変更点
Summary: Windows Azure ドライブでは、ローカル キャッシュを使用してドライブのパフォーマンスを向上させることができます。 今後のゲスト OS 1.8 および 2.0 リリースでは、このローカル キャッシュの方法に大きな変更があります。
Content: <p>Windows Azure ドライブでは、ローカル キャッシュを使用してドライブのパフォーマンスを向上させることができます。 今後のゲスト OS 1.8 および 2.0 リリースでは、このローカル キャッシュの割り当て方法に大きな変更があります。</p>  <p><b></b></p>  <h3>背景</h3>  <p>Azure Windowsでは、サービス定義 (.csdef) でローカル ストレージを要求できます&#160;例を次に示します。</p>  <pre><code>&lt;LocalResources&gt;      &lt;LocalStorage name=&quot;DriveCache&quot; cleanOnRoleRecycle=&quot;true&quot; sizeInMB=&quot;1000&quot; /&gt;  &lt;/LocalResources&gt;</code></pre>    <p>この例では、Azure Windowsロール インスタンスごとに "DriveCache" という名前のローカル ストレージ リソースに 1000 MB を割り当てる必要があります。 アプリケーションで Windows Azure ドライブを使用する場合、このようなローカル ストレージ リソースを使用して、マウントされているドライブすべてのキャッシュを割り当てできます。&#160; 次に示すのは、それを行うコードの一般的なスニペットです。</p>    <pre><code>LocalResource localCache = RoleEnvironment.GetLocalResource(&quot;DriveCache&quot;);  CloudDrive.InitializeCache(localCache.RootPath, localCache.MaximumSizeInMegabytes);</code></pre>    <p>最後に、Azure Drive Windowsマウントするときに、インスタンスは、そのドライブに割り当てる領域の量を次のように指定できます。</p>    <pre><cdoe>driveLetter = drive.Mount(driveCacheSize, DriveMountOptions.None);</cdoe></pre>    <h3>壊れ方の変更</h3>    <p>Windows Azure ゲスト OS 1.8 および 2.0 より前では、Windows Azure ドライブ キャッシュはドライブが使用されたのと同じ時間で割り当てがありました。&#160; これらの新しいゲスト OS <code>Mount()</code> <code>D000007F</code>リリースでは、キャッシュ全体が事前に割り当て済みであり、キャッシュのローカル リソースに十分な領域が存在しない場合、 の呼び出しはエラー で失敗します。</p>    <p>ローカル ストレージ リソースの割り当て方法に関する問題により、要求された領域の一部がキャッシュの使用に使用できません。 つまり、アプリケーションで <b>1000 MB </b><b> </b> のローカル リソースが宣言され、<b>Windows Azure Drive</b><b></b> キャッシュ全体に <b>1000 MB </b><b> </b> の完全な割り当てが試行された場合、割り当ては失敗する可能性があります<b>。</b></p>    <p>回避策は、アプリケーションで使用されるリソースよりも 20 MB 大きいローカル リソースを指定する方法です。 次に示すのは、1000 MB のキャッシュ領域を使用Windows Azure ドライブの領域を割り当てる例です。</p>    <pre><code>&lt;LocalResources&gt;      &lt;LocalStorage name=&quot;DriveCache&quot; cleanOnRoleRecycle=&quot;true&quot; sizeInMB=&quot;<b>1020</b>&quot; /&gt;  &lt;/LocalResources&gt;    LocalResource localCache = RoleEnvironment.GetLocalResource(&quot;DriveCache&quot;);  CloudDrive.InitializeCache(localCache.RootPath, localCache.MaximumSizeInMegabytes);  driveLetter = drive.Mount(<b>1000</b>, DriveMountOptions.None);</code></pre>    <p>以前のキャッシュ割り当て動作を保持するアプリケーションでは、以前のゲスト OS バージョンを指定できます。 ゲスト OS バージョン 1.7 を指定する例を次に示します。</p>    <pre><code>&lt;ServiceConfiguration serviceName=&quot;MyService&quot; osVersion=&quot; WA-GUEST-OS-1.7_201009-01 &quot;&gt;      &lt;Role name=&quot;MyRole&quot;&gt;          …      &lt;/Role&gt;  &lt;/ServiceConfiguration&gt;</code></pre>    <p>ローカル ストレージ リソースの割り当てによって常に要求された領域が完全に提供され、今後のゲスト OS リリースで修正される予定です。</p>    <p>&#160;</p>    <p>Windows Azure Storage チーム</p>
